var daojia_separate_tpl={"a":'<div class="about_box"><i></i>京东到家</div><div class="ctrlAreaZone h"><a href="agreement.html" class="a2"><span>京东到家 用户协议</span><var class="uf"></var></a></div><div class="copyright">京东到家 为你而来<br>copyright©2017 jingdongdaojia.All Rights Reserved</div>',"b":'{{if result.config && result.config.isCart}}<a class="rd" href="#shopCartList"><img src="//static-o2o.360buyimg.com/daojia/new/images/icon/activity_cart_2.0.png" /></a>{{/if}}<div class="preTitle"></div><article class="scrolling"><div class="scroller"><div class="activityDiv">{{include(\'c\',{result:result,isShare:isShare})}}</div><div class="ct"><i></i><span>继续滑动查看更多内容</span></div><div class=\'rf\'><p><i class="bb"></i>没有更多内容啦<i class="bc"></i></p></div></div></article>',
"c":'{{each result.data as v i}} {{if v.floorStyle== "floorBanner"}}<div class="rb" floor><div class="swipe7" swipe><div class="swipe7list">{{each v.data}}<div class="swipe7item" ><a {{if $value.to == "storeListByKey"}} skipByKeys="{{$value.to}}" keySkipData=\'{{$33($value.params)}}\'{{/if}} {{if $value.to != "storeListByKey"}}href="{{if isShare &&(($value.to == \'web\' && $value.params && $value.params.url && ($value.params.url.indexOf(\'reportActivity\')!=-1||$value.params.url.indexOf(\'activityPage\')!=-1))||$value.to == \'activityDetail\')}}{{$83($value)}}{{else}}{{$15($value.to,$value.params,result.address)}}{{/if}}"{{/if}}><img src="{{$value.imgUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/index_banner_default_2.0.png"\' /></a></div>{{/each}}</div></div></div>{{else if v.floorStyle=="act1" || v.floorStyle=="act2" || v.floorStyle=="act3" || v.floorStyle=="act4" ||v.floorStyle=="act5"}}<div class="show-activity2 {{v.floorStyle}}" floor {{if result.hideStoreTitle}}clstag="pageclick|keycount|active_store_item|1"{{/if}}>{{each v.data}}<a {{if $value.to == "storeListByKey"}} skipByKeys="{{$value.to}}" keySkipData=\'{{$33($value.params)}}\'{{/if}} {{if $value.to != "storeListByKey"}}href="{{if isShare &&(($value.to == \'web\' && $value.params && $value.params.url &&($value.params.url.indexOf(\'reportActivity\')!=-1||$value.params.url.indexOf(\'activityPage\')!=-1))||$value.to == \'activityDetail\')}}{{$83($value)}}{{else}}{{$15($value.to,$value.params,result.address)}}{{/if}}"{{/if}}><img class="rc" {{if $value.imgHeight}}style="min-height:{{$104(v.data)}}px" {{/if}} src="{{$value.imgUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'/>{{if v.floorStyle=="act1" && v.isCutOffFloor}}<span class="sn cleafix"><strong>{{v.floorTitle.floorName}}</strong></span>{{/if}}</a>{{/each}}</div>{{else if v.floorStyle=="addressFloor"}}<a class="activityAddressWrapper" floor href="#indexaddress/type:activityShare" clstag="pageclick|keycount|activity_down_location_20160908|1"><span class="activityAddressTitle">{{v.poi}}</span><span href="javascript:void 0;" class="activityAddressBut">手动定位</span></a>{{else if v.floorStyle=="feed" && v.data && v.data.length>0 && isShare}}<div class="activityPromptWrapper" floor><span class="activityPromptImg"></span><p class="activityPromptText">{{v.data[0].msg||\'抱歉，您附近没有参加此活动的商家~\'}}</p>{{if v.data[0].showBtn}}<a href="" class="goToIndex">去首页逛逛</a>{{/if}}</div>{{else if v.floorStyle=="product5" && v.styleTpl==\'tpl2\'}}<div class="sa" {{if v.busyAttrMaps && v.busyAttrMaps.pageBgc}}style="background-color:{{v.busyAttrMaps.pageBgc}}"{{/if}} floor>{{if !result.hideStoreTitle}} {{if v.data[0] && v.data[0].name}}<ul class="vo">{{include(\'j\',{result:v.data[0],isShare:isShare})}}</ul><a class="showMore" node-type="index-gotoStore" orgCode="{{v.data[0] && v.data[0].params.orgCode}}" storeId="{{v.data[0] && v.data[0].params.storeId}}">查看更多商品 ></a><div class="activity-border-1"><i class="left"></i><i class="center"></i><i class="right"></i></div>{{/if}} {{/if}}<ul class="rq" {{if v.busyAttrMaps && v.busyAttrMaps.pageBgc}}style="background-color:{{v.busyAttrMaps.pageBgc}}"{{/if}}>{{if v.data[0] && v.data[0].name}} {{each v.data[0].skus as valueV index}}<li {{if v.busyAttrMaps && v.busyAttrMaps.pdBgc}}style="background-color:{{v.busyAttrMaps.pdBgc}}"{{/if}} {{if result.hideStoreTitle}}class="ri"{{/if}} >{{include(\'e\',{twoGoods:true,valueV:valueV,v:v,isShare:isShare,skuToType:v.busyAttrMaps && v.busyAttrMaps.skuToType,actStoreGoods:result.hideStoreTitle,skuDate:result.skuDate,cartaddDate: result.cartaddDate, cartreduceDate: result.cartreduceDate, isCart: true,hideLink:result.hideLink})}}</li>{{/each}} {{else}} {{each v.data as valueV index}}<li {{if v.busyAttrMaps && v.busyAttrMaps.pdBgc}}style="background-color:{{v.busyAttrMaps.pdBgc}}"{{/if}} {{if result.hideStoreTitle}}class="ri"{{/if}}>{{include(\'e\',{twoGoods:true,valueV:valueV,v:v,isShare:isShare,skuToType:v.busyAttrMaps && v.busyAttrMaps.skuToType,actStoreGoods:result.hideStoreTitle,skuDate:result.skuDate,cartaddDate: result.cartaddDate, cartreduceDate: result.cartreduceDate, isCart: true,hideLink:result.hideLink,showType:\'oneLineTwoGoods\'})}}</li>{{/each}} {{/if}}</ul></div>{{else if v.floorStyle=="product5" && v.styleTpl==\'tpl3\'}}<div class="sa" {{if v.busyAttrMaps && v.busyAttrMaps.pageBgc}}style="background-color:{{v.busyAttrMaps.pageBgc}}"{{/if}} floor>{{if !result.hideStoreTitle}} {{if v.data[0] && v.data[0].name}}<ul class="vo">{{include(\'j\',{result:v.data[0],isShare:isShare})}}</ul><a class="showMore" node-type="index-gotoStore" orgCode="{{v.data[0] && v.data[0].params.orgCode}}" storeId="{{v.data[0] && v.data[0].params.storeId}}">查看更多商品 ></a><div class="activity-border-1"><i class="left"></i><i class="center"></i><i class="right"></i></div>{{/if}} {{/if}}<ul class="rp" {{if v.busyAttrMaps && v.busyAttrMaps.pageBgc}}style="background-color:{{v.busyAttrMaps.pageBgc}}"{{/if}}>{{if v.data[0] && v.data[0].name}} {{each v.data[0].skus as valueV index}}<li {{if v.busyAttrMaps && v.busyAttrMaps.pdBgc}}style="background-color:{{v.busyAttrMaps.pdBgc}}"{{/if}} {{if result.hideStoreTitle}}class="ri"{{/if}}>{{include(\'f\',{valueV:valueV,v:v,isShare:isShare,skuToType:v.busyAttrMaps.skuToType,actStoreGoods:result.hideStoreTitle,skuDate:result.skuDate,cartaddDate: result.cartaddDate, cartreduceDate: result.cartreduceDate, isCart: true,hideLink:result.hideLink})}}</li>{{/each}} {{else}} {{each v.data as valueV index}}<li {{if v.busyAttrMaps && v.busyAttrMaps.pdBgc}}style="background-color:{{v.busyAttrMaps.pdBgc}}"{{/if}} {{if result.hideStoreTitle}}class="ri"{{/if}}>{{include(\'f\',{valueV:valueV,v:v,isShare:isShare,skuToType:v.busyAttrMaps.skuToType,actStoreGoods:result.hideStoreTitle,skuDate:result.skuDate,cartaddDate: result.cartaddDate, cartreduceDate: result.cartreduceDate, isCart: true,hideLink:result.hideLink})}}</li>{{/each}} {{/if}}</ul></div>{{else if v.floorStyle=="product5" && v.styleTpl==\'tpl4\'}}<div class="sa" {{if v.busyAttrMaps && v.busyAttrMaps.pageBgc}}style="background-color:{{v.busyAttrMaps.pageBgc}}"{{/if}} floor>{{if !result.hideStoreTitle}} {{if v.data[0] && v.data[0].name}}<ul class="vo">{{include(\'j\',{result:v.data[0],isShare:isShare})}}</ul><a class="showMore" node-type="index-gotoStore" orgCode="{{v.data[0] && v.data[0].params.orgCode}}" storeId="{{v.data[0] && v.data[0].params.storeId}}">查看更多商品 ></a><div class="activity-border-1"><i class="left"></i><i class="center"></i><i class="right"></i></div>{{/if}} {{/if}}<ul class="rr" {{if v.busyAttrMaps && v.busyAttrMaps.pageBgc}}style="background-color:{{v.busyAttrMaps.pageBgc}}"{{/if}}>{{if v.data[0] && v.data[0].name}} {{each v.data[0].skus as valueV index}}<li {{if v.busyAttrMaps && v.busyAttrMaps.pdBgc}}style="background-color:{{v.busyAttrMaps.pdBgc}}"{{/if}} {{if result.hideStoreTitle}}class="ri"{{/if}} >{{include(\'e\',{valueV:valueV,v:v,isShare:isShare,skuToType:v.busyAttrMaps && v.busyAttrMaps.skuToType,actStoreGoods:result.hideStoreTitle,skuDate:result.skuDate,cartaddDate: result.cartaddDate, cartreduceDate: result.cartreduceDate, isCart: true,hideLink:result.hideLink})}}</li>{{/each}} {{else}} {{each v.data as valueV index}}<li {{if v.busyAttrMaps && v.busyAttrMaps.pdBgc}}style="background-color:{{v.busyAttrMaps.pdBgc}}"{{/if}} {{if result.hideStoreTitle}}class="ri"{{/if}}>{{include(\'e\',{valueV:valueV,v:v,isShare:isShare,skuToType:v.busyAttrMaps && v.busyAttrMaps.skuToType,actStoreGoods:result.hideStoreTitle,skuDate:result.skuDate,cartaddDate: result.cartaddDate, cartreduceDate: result.cartreduceDate, isCart: true,hideLink:result.hideLink,showType:\'oneLineThreeGoods\'})}}</li>{{/each}} {{/if}}</ul></div>{{else if v.floorStyle == "banner"}} {{if !result.hideStoreTitle}} {{if v.data && v.data.length>0}}<div class="s6"></div><div class="s7" floor>{{each v.data}}<a {{if $value.to == "storeListByKey"}} skipByKeys="{{$value.to}}" keySkipData=\'{{$33($value.params)}}\'{{/if}} {{if $value.to != "storeListByKey"}}href="{{if ($value.to == \'web\' && $value.params&&$value.params.url&&($value.params.url.indexOf(\'reportActivity\')!=-1||$value.params.url.indexOf(\'activityPage\')!=-1))||$value.to == \'activityDetail\'}}{{$83($value)}}{{else}}{{$15($value.to,$value.params,result.address)}}{{/if}}"{{/if}}><img src="{{$value.imgUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/index_banner_default_2.0.png"\' /></a>{{/each}}</div>{{/if}} {{/if}} {{else if v.floorStyle == "coupon"}}<div class="show-activity2 {{v.floorStyle}}" floor>{{each v.data}}<a couponCode="{{$value.params.id}}" data-status="{{$value.status}}" data-v=\'{{$33(v.data)}}\' style="width:{{100/v.data.length}}%" onclick=\'lg("user_action","1.0",{"clickid":"get_coupon",{{$41($value.userAction)}}})\'><img class="rc" {{if $value.imgHeight}}style="min-height:{{$104(v.data)}}px" {{/if}} src="{{$value.imgUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'/>{{if $104(v.data) >50}}<strong class="activity_coupon_icon_box">{{include(\'d\',{data:v.data,status:$value.status})}}</strong>{{/if}}</a>{{/each}}</div>{{/if}} {{/each}}',
"d":'<span class="{{if status}}activity_coupon_{{status }}{{/if}} activity_coupon_icon " style="{{if $104(data)>50 && $104(data)<65}}width:50px;height:50px;{{else if $104(data) >=65 }}width:65px;height:65px;{{/if}}"></span>',"e":'<a {{if isShare}}class="{{if skuToType == \'productDetail\'}}activityToDetails{{else}}activityToGoods{{/if}}" skuId="{{valueV.skuInfo.skuId}}" storeId="{{valueV.skuInfo.storeId}}" orgCode="{{valueV.skuInfo.venderId}}" promotionType="{{valueV.skuInfo.tags && valueV.skuInfo.tags[0] && valueV.skuInfo.tags[0].type}}"{{/if}} href="{{if skuToType == \'productDetail\' || actStoreGoods}}#goodsDetails/skuId:{{valueV.skuInfo.skuId}}/storeId:{{valueV.skuInfo.storeId}}/orgCode:{{valueV.skuInfo.venderId}}{{else}}#storeHome/skuId:{{valueV.skuInfo.skuId}}/storeId:{{valueV.skuInfo.storeId}}/orgCode:{{valueV.skuInfo.venderId}}/promotionType:{{valueV.skuInfo.tags && valueV.skuInfo.tags[0] && valueV.skuInfo.tags[0].type}}/fromAnchor:true{{/if}}" {{if actStoreGoods}} onclick=\'lg("user_action","1.0",{"clickid":"goodinfo_detail",{{$41(valueV.skuInfo.userAction)}}})\' {{else}} onclick=\'lg("user_action","1.0",{"clickid":"cl_hd_sku",{{$41(valueV.skuInfo.userAction)}}})\' {{/if}} >{{if valueV.skuInfo.tags && valueV.skuInfo.tags[0]}}<span class="e0" style="background: #{{valueV.skuInfo.tags[0].colorCode}}"><i>{{valueV.skuInfo.tags[0].iconText}}</i></span>{{/if}}<img src={{if valueV.skuInfo.imgUrl}}"{{valueV.skuInfo.imgUrl}}"{{else}}"//static-o2o.360buyimg.com/daojia/new/images/show_default.png"{{/if}} onload="this.style.backgroundImage=\'none\';"/><span class="rt {{if !actStoreGoods}}padding20{{/if}}" ><span class="ru">{{valueV.skuInfo.skuName}}</span>{{if !actStoreGoods}} {{if valueV.skuInfo.vipPrice}}<span class="rv"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em></span><div style="margin-top:5px;height:13px;line-height:13px">{{include("hc",{v:valueV.skuInfo})}}</div>{{else}}<span class="rv"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em></span><i class="rw">{{if valueV.skuInfo.basicPrice && valueV.skuInfo.basicPrice!=valueV.skuInfo.realTimePrice}}￥{{valueV.skuInfo.basicPrice}}{{/if}}</i>{{/if}} {{else}} {{if showType == \'oneLineThreeGoods\'}} {{if valueV.skuInfo.vipPrice}}<span class="rv"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em></span><div style="margin-top:5px;line-height:11px;">{{include("hc",{v:valueV.skuInfo,fontSize:11})}}</div>{{else}}<span class="rv"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em></span><i class="{{if twoGoods}}rx{{else}}rw{{/if}}">{{if valueV.skuInfo.basicPrice && valueV.skuInfo.basicPrice!=valueV.skuInfo.realTimePrice}}￥{{valueV.skuInfo.basicPrice}}{{/if}}</i>{{/if}} {{else if showType == \'oneLineTwoGoods\'}} {{if valueV.skuInfo.vipPrice}}<span class="rv" style="margin-top:20px"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em>{{include("hc",{v:valueV.skuInfo,paddingLeft:true})}}</span>{{else}}<span class="rv" style="margin-top:20px"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em>{{if valueV.skuInfo.basicPrice && valueV.skuInfo.basicPrice!=valueV.skuInfo.realTimePrice}}<i class="rw">￥{{valueV.skuInfo.basicPrice}}</i>{{/if}}</span>{{/if}} {{/if}} {{/if}}</span></a>{{if actStoreGoods}}<span class="Box">{{include("hb",{v:valueV.skuInfo,cartreduceDate:cartreduceDate,cartaddDate:cartaddDate,skuDate:skuDate,hideLink:true})}}</span>{{/if}}',
"f":'<a {{if isShare}}class="{{if skuToType==\'productDetail\'}}activityToDetails{{else}}activityToGoods{{/if}}" skuId="{{valueV.skuInfo.skuId}}" storeId="{{valueV.skuInfo.storeId}}" orgCode="{{valueV.skuInfo.venderId}}" promotionType="{{valueV.skuInfo.tags && valueV.skuInfo.tags[0] && valueV.skuInfo.tags[0].type}}"{{/if}} href="{{if skuToType==\'productDetail\' || actStoreGoods}}#goodsDetails/skuId:{{valueV.skuInfo.skuId}}/storeId:{{valueV.skuInfo.storeId}}/orgCode:{{valueV.skuInfo.venderId}}{{else}}#storeHome/skuId:{{valueV.skuInfo.skuId}}/storeId:{{valueV.skuInfo.storeId}}/orgCode:{{valueV.skuInfo.venderId}}/promotionType:{{valueV.skuInfo.tags && valueV.skuInfo.tags[0] && valueV.skuInfo.tags[0].type}}/fromAnchor:true{{/if}}" {{if actStoreGoods}} onclick=\'lg("user_action","1.0",{"clickid":"goodinfo_detail",{{$41(valueV.skuInfo.userAction)}}})\' {{else}} onclick=\'lg("user_action","1.0",{"clickid":"cl_hd_sku",{{$41(valueV.skuInfo.userAction)}}})\'{{/if}}>{{if valueV.skuInfo.tags && valueV.skuInfo.tags[0]}}<span class="e0" style="background:#{{valueV.skuInfo.tags[0].colorCode}}"><i>{{valueV.skuInfo.tags[0].iconText}}</i></span>{{/if}}<img src={{if valueV.skuInfo.imgUrl}}"{{valueV.skuInfo.imgUrl}}"{{else}}"//static-o2o.360buyimg.com/daojia/new/images/show_default.png"{{/if}} onload="this.style.backgroundImage=\'none\';"/><span class="ry" ><span class="s0">{{valueV.skuInfo.skuName}}</span>{{if !actStoreGoods}}<div class = "rz {{if !v.busyAttrMaps || v.busyAttrMaps.storeShow != 1}}s4{{/if}}">{{if valueV.skuInfo.vipPrice}}<i class="s1" style="display:block"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em></i>{{include("hc",{v:valueV.skuInfo})}} {{else}}<i class="s1"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em></i>{{if valueV.skuInfo.basicPrice && valueV.skuInfo.basicPrice!=valueV.skuInfo.realTimePrice}}<i class="s2">￥{{valueV.skuInfo.basicPrice}}</i>{{/if}} {{/if}}</div>{{else}}<div class="rz"><i class="s1"><em class="fuhao">￥</em><em class="yuanjia">{{valueV.skuInfo.realTimePrice}}</em></i></div>{{/if}}</span></a><a href="{{if skuToType==\'productDetail\' || actStoreGoods}}#goodsDetails/skuId:{{valueV.skuInfo.skuId}}/storeId:{{valueV.skuInfo.storeId}}/orgCode:{{valueV.skuInfo.venderId}}{{else}}#storeHome/skuId:{{valueV.skuInfo.skuId}}/storeId:{{valueV.skuInfo.storeId}}/orgCode:{{valueV.skuInfo.venderId}}/promotionType:{{valueV.skuInfo.tags && valueV.skuInfo.tags[0] && valueV.skuInfo.tags[0].type}}/fromAnchor:true/needAddCart:true{{/if}}" class="s3">立即购买</a>{{if actStoreGoods}}<span class="Box">{{include("hb",{v:valueV.skuInfo,cartreduceDate:cartreduceDate,cartaddDate:cartaddDate,skuDate:skuDate,hideLink:hideLink})}}</span>{{/if}}',
"g":'{{if data.data && data.data.length}} {{if data.floorTitle && data.floorTitle.floorName}}<h2 class="re">{{data.floorTitle.floorName}}</h2>{{/if}}<div class="rj"><div class="rk" node-type="stores-title"><div class="store_title"><div class="left_store_title" storeId="{{data.data[0].storeId}}" orgCode="{{data.data[0].orgCode || data.data[0].venderId}}"><a {{if isShare}}storeId="{{data.data[0].storeId}}" orgCode="{{data.data[0].orgCode || data.data[0].venderId}}"{{/if}} class="left-store-name wrap-left-store-name {{if isShare}}{{if result.busyAttrMaps&&result.busyAttrMaps.skuToType==\'productDetail\'}}activityToDetails{{else}}activityToGoods{{/if}}{{/if}}" href="#storeHome/storeId:{{data.data[0].storeId}}/orgCode:{{data.data[0].orgCode || data.data[0].venderId}}" onclick=\'lg("user_action","1.0",{"clickid":"cl_hd_store",{{$41(data.data[0].userAction)}}})\'><h2 class="selected_store">{{data.data[0].storeName}}</h2><i></i></a></div><div class="right_store_title a4"><p>共<span>{{data.data.length}}</span>个商家</p><i></i></div></div><ul class="store_list">{{each data.data}}<li class="specify_store" storeId="{{$value.storeId}}" orgCode="{{$value.orgCode || $value.venderId}}" skuIdList="{{$33($value.skuIdList)}}"><h2 class="store_name"><span class="store-name-span">{{$value.storeName}}</span></h2></li>{{/each}}</ul></div><div class="ri">{{include(\'h\',{data:data.data,isShare:isShare})}}</div><div class="rg" tap></div></div>{{else}}<div class="oi failure"><p>很抱歉，附近暂无活动[0001]</p></div>{{/if}}',
"h":'{{each data}}<div class="store-goods" storeId="{{$value.storeId}}" orgCode="{{$value.orgCode}}" hasLoad="false">{{if $index!=0}}<div class="store_title"><div class="left_store_title" storeId="{{$value.storeId}}" orgCode="{{$value.orgCode}}"><a {{if isShare}}storeId="{{$value.storeId}}" orgCode="{{$value.orgCode || $value.venderId}}"{{/if}} class="left-store-name {{if isShare}}activityToStore{{/if}}" href="#storeHome/storeId:{{$value.storeId}}/orgCode:{{$value.orgCode || $value.venderId}}" onclick=\'lg("user_action","1.0",{"clickid":"cl_hd_store",{{$41($value.userAction)}}})\'><h2 class="selected_store">{{$value.storeName}}</h2><i></i></a></div></div>{{/if}}<div class="activty-goods-content"><div class="activty-goods-list"><ul class="g9 c7 c5" storeId="{{$value.storeId}}">{{$46($value,isShare)}}</ul></div></div></div>{{/each}}',
"i":'<div class="rj"><div class="rk rm rl" node-type="rm"><div class="store_title"><div class="left_store_title" storeId="{{data.data[0].storeId}}" orgCode="{{data.data[0].orgCode || data.data[0].venderId}}"><a class="left-store-name wrap-left-store-name" href="#storeHome/storeId:{{data.data[0].storeId}}/orgCode:{{data.data[0].orgCode || data.data[0].venderId}}" onclick=\'lg("user_action","1.0",{"clickid":"cl_hd_store",{{$41(data.data[0].userAction)}}})\'><h2 class="selected_store">{{data.data[0].storeName}}</h2><i></i></a></div><div class="right_store_title a4"><p>共<span>{{data.data.length}}</span>个商家</p><i></i></div></div><ul class="store_list">{{each data.data}}<li class="specify_store" storeId="{{$value.storeId}}" orgCode="{{$value.orgCode || $value.venderId}}" skuIdList="{{$33($value.skuIdList)}}"><h2 class="store_name"><span class="store-name-span">{{$value.storeName}}</span></h2></li>{{/each}}</ul></div><div class="rg" tap></div></div>',
"t":'<table class="c qd"><tr><td><div class="i3"><h2>{{title}}</h2><div class="i4" {{if !title}}style="padding:20px;"{{/if}}><p class="content">{{=desc}}</p></div><div class="{{className}} ib h" {{if className}}clstag="pageclick|keycount|verification_get_voice|1"{{/if}}>{{btn || "知道了"}}</div></div></div></td></tr></table>',"u":'<table class="c qd"><tr><td><div class="i3"><h2>{{title}}</h2><div class="i4"><p class="content">{{=desc}}：<span class="i7">{{fromPhone}}</span></p><p class="i5"><input class="i6" type="number" maxLength="6" placeholder="请输入验证码"/><span class="i8"><i class="i9" style="display:none;"></i><label class="ia" clstag="pageclick|keycount|verification_get_voice|1">获取验证码</label></span><p></div><div class="ib h disabled" clstag="pageclick|keycount|verification_submit|1">提交验证码</div></div></div></td></tr></table>',
"v":'<div class="c qd"><div class="i3 q6"><h2>{{title}}</h2><i class="iconfont mt"></i><div class="i4"><ul class="q7"><li {{if !childMoneyList.length}}style="border: none; margin:0;"{{/if}}>总计<span class="q8 q9"><i>￥</i>{{totalMoney}}</span></li>{{each childMoneyList}}<li>{{$value.name}}<span class="q8">{{$value.value}}</span></li>{{/each}}</ul>{{if desc}}<h3 class="qa">说明</h3><p class="content">{{=desc}}</p>{{/if}}</div></div></div></div>',
"w":'<div class="c qd"><div class="qj"><div class="i3 qk" style="width: {{$105(102)}}px;max-height: {{$29(-180)}}px">{{each desc}} {{if $value.type == 1}}<p class="header">{{$value.text.title}}{{$value.text.content}}</p>{{else if $value.type == 2}}<p class="title" {{if ($105(0)<= 320)}}style="font-size: 11px"{{/if}}>{{$value.text.title}}{{$value.text.content}}</p>{{else if $value.type == 3}}<p class="content"><span class="qm" {{if ($105(0)<= 320)}}style="font-size: 10px"{{/if}}>{{$value.text.title}}</span><span class="ql" style="{{if ($105(0)<= 320)}}font-size: 10px{{/if}}">{{$value.text.content}}</span></p>{{else if $value.type == 4}}<p class="content">{{$value.text.title}}{{$value.text.content}}</p>{{else}}<p class="content">{{$value.text}}</p>{{/if}} {{/each}}</div><i class="iconfont mt"></i></div></div>',
"x":'{{if form == "gooddetail"}}<div class="zk clearfix"><div class="zl"><i _href="#shopCartList/firstStore:{{goodDate.storeId}}" class="dw goShopCart"></i>{{if count}} {{if count>0 && count<100}}<b class="zo">{{count}}</b>{{else}}<b class="zo">99+</b>{{/if}} {{/if}}</div><div class="zm">{{if count && count>0}}<span class="zp {{if freightTip}}hasfreightTip{{/if}}"><i>￥</i>{{$2(price)}}</span>{{/if}} {{if freightTip}}<span class="zq {{if count==0}}detail-cart-tip2{{/if}}">{{freightTip}}</span>{{/if}}</div><div class="zn ge {{if goodDate.skuState == 1}}sure{{/if}}" _skuId="{{goodDate.skuId}}" _orgCode="{{goodDate.orgCode}}" _storeId="{{goodDate.storeId}}" onclick="lg(\'daojiaclick\',\'1.0\',{\'skucl\':\'{{goodDate.skuId}}\',\'cartcl\':\'v2\'})">{{goodDate.showStateName}}</div></div>{{else if form == "tuan"}} {{if goodDate.productType == 6}}<div class="zv zw"><div class="zy ge {{if goodDate.isDjPriceBuy}}sure{{/if}} {{if goodDate.from}}select-tuan-buy {{/if}}" _skuId="{{goodDate.skuId}}" _orgCode="{{goodDate.orgCode}}" _storeId="{{goodDate.storeId}}" onclick="lg(\'daojiaclick\',\'1.0\',{\'skucl\':\'{{goodDate.skuId}}\',\'cartcl\':\'v2\'})"><p class="zz"><i>￥</i>{{goodDate.djPrice}}</p><p class="a00">{{goodDate.djPriceBuyButton}}</p></div><div class="zx {{if goodDate.isGroupPriceBuy}}sure{{/if}} {{if goodDate.from}}select-tuan-buy {{/if}}"><p class="zz"><i>￥</i>{{goodDate.groupPrice}}</p><p class="a00">{{goodDate.groupPriceBuyButton}}</p></div></div>{{else if goodDate.productType == 7}}<div class="zv zw"><div class="zy tuan-goto-single {{if goodDate.isDjPriceBuy}}sure{{/if}} {{if goodDate.from}}select-tuan-buy {{/if}}"><p class="zz"><i>￥</i>{{goodDate.djPrice}}</p><p class="a00">{{goodDate.djPriceBuyButton}}</p></div><div class="zx {{if goodDate.isGroupPriceBuy}}sure{{/if}} {{if goodDate.from}}select-tuan-buy {{/if}}"><p class="zz"><i>￥</i>{{goodDate.groupPrice}}</p><p class="a00">{{goodDate.groupPriceBuyButton}}</p></div></div>{{/if}} {{else if form == "detailselect"}}<div class="g6"><span class="g7 ge {{if goodDate.skuState == 1}}sure{{/if}}" _skuId="{{goodDate.skuId}}" _orgCode="{{goodDate.orgCode}}" _storeId="{{goodDate.storeId}}" onclick="lg(\'daojiaclick\',\'1.0\',{\'skucl\':\'{{goodDate.skuId}}\',\'cartcl\':\'v2\'})">{{goodDate.settlementModeName}}</span></div>{{else if form == "storehome"}}<div class="zk zr clearfix"><div class="zl"><i _href="#shopCartList/firstStore:{{goodDate.storeId}}" class="dw goShopCart"></i>{{if count }} {{if count>0 && count<100}}<b class="zo">{{count}}</b>{{else}}<b class="zo">99+</b>{{/if}} {{/if}}</div><div class="zm">{{if count && count>0}}<span class="zp {{if freightTip}}hasfreightTip{{/if}}"><i>￥</i>{{$2(price)}}</span>{{/if}} {{if freightTip}}<span class="zq {{if count==0}}detail-cart-tip2{{/if}}">{{freightTip}}</span>{{/if}}</div></div>{{else if form == "activty"}}<div class="zk zs clearfix"><div class="zl"><i _href="#shopCartList/firstStore:{{goodDate.storeId}}" class="dw goShopCart"></i>{{if count }} {{if count>0 && count<100}}<b class="zo">{{count}}</b>{{else}}<b class="zo">99+</b>{{/if}} {{/if}}</div><div class="zm">{{if count && count>0}}<span class="zt"><i>￥</i>{{$2(price)}}</span>{{/if}}</div></div>{{/if}}',
"z":'<div class="my-one-card" style="height:{{winheight}}px;" >{{if memberCardPackVOList }} {{each memberCardPackVOList}}<a href="{{$value.membersUrl}}"><div class="adc"><div class="cardshadow"><div class="mycard"><img src="{{$value.memberCardPhoto}}" alt=""></div><div class="ade" ><p>{{$value.endTime}}</p></div></div></div></a>{{/each}} {{/if}}</div>',"a0":"<div class=\"cashierContainer {{otherChannel}}\">{{if countDownTime && countDownTime != -1}} {{include('a1',{initTime:initTime,stationName:stationName,amount:amount})}} {{/if}} {{include('a2',{payType:payWays,isJDApp:isJDApp})}} {{if sharePacket}} {{include('a3')}} {{/if}} {{include('a4',{prescriptionTag:prescriptionTag,amount:amount})}} {{include('a5')}} {{include('a6')}}</div>",
"a1":'<div class="payHeadContainer"><div class="payTime"><i>剩余支付时间</i><em>{{initTime}}</em></div>{{if stationName}}<div class="payStation"><i>{{stationName}}</i><em>¥{{amount}}</em></div>{{/if}}</div>',"a2":'<div class="payTypeContainer"><p class="acw">请选择支付方式</p><div class="ad3"><ul class="acx">{{each payType as item}} {{if item.payWay == 10}}<li class="wx" index={{$index}} payType="wx" freeTag={{item.freeTag}}><div class="payNameContainer"><p class="payName">{{item.payName}} {{if item.freeTag == 1 && $89() && item.extParam && $35(item.extParam).freeTagTrue}}<span class="acy">{{$35(item.extParam).freeTagTrue}}</span>{{/if}}</p></div>{{if item.freeTag == 0 &&　$89()}}<p class="ad1 {{if $index != 0}}none{{/if}}" onclick=\'lg("user_action","1.0",{"clickid":"to_wx_pay"})\'>{{(item.extParam && $35(item.extParam).freeTagFalse) || \'开通小额免密，小额消费可免输支付密码\'}}<em></em></p>{{/if}}<i {{if $index == 0}}class="ad4"{{/if}}></i></li>{{else if item.payWay == 20}}<li class="jd" index={{$index}} payType="jd" freeTag={{item.freeTag}}><div class="payNameContainer"><p class="payName">{{item.payName}} {{if item.freeTag == 1 && $90() && item.extParam && $35(item.extParam).freeTagTrue}}<span class="acy">{{$35(item.extParam).freeTagTrue}}</span>{{/if}}</p>{{if item.extCopy || (item.extParam && $35(item.extParam).discountTag)}}<p class="acz">{{if item.extParam && $35(item.extParam).discountTag}}<span>{{$35(item.extParam).discountTag}}</span>{{/if}} {{if item.extCopy}}<span>{{item.extCopy}}</span>{{/if}}</p>{{/if}} {{if item.activityCopy}}<p class="ad0 activity">{{item.activityCopy}}</p>{{else if item.defaultCopy}}<p class="ad0">{{item.defaultCopy}}</p>{{/if}} {{if item.freeTag == 0 && isJDApp}}<p class="ad2"><span></span></p>{{/if}}</div><i {{if $index == 0}}class="ad4"{{/if}}></i></li>{{else if item.payWay == 40}}<li class="zfb" index={{$index}} payType="zfb" freeTag={{item.freeTag}}><div class="payNameContainer"><p class="payName">{{item.payName}}</p></div><i {{if $index == 0}}class="ad4"{{/if}}></i></li>{{else if item.payWay == 70}}<li class="dai" style="display:{{$88()}}" index={{$index}} payType="dai" freeTag={{item.freeTag}} title={{item.defaultCopy}} desc={{item.extCopy}} link={{item.extParam}}><div class="payNameContainer"><p class="payName">{{item.payName}}</p></div><a class="ad5"></a></li>{{/if}} {{/each}}</ul></div></div>',
"a3":'<p class="sharePacketContainer"><span>马上支付 ，可领取分享红包</span></p>',"a4":'<div class="paySubmitContainer"><div class="paySubmit"><a class="btnSubmit">{{if prescriptionTag}}提交定金{{else}}确认支付{{/if}}<i>￥</i><em>{{amount}}</em></a></div><div class="payConfirm none"><a class="btnFinish">已完成支付</a><a class="btnRefresh">重新支付</a></div></div>',"a5":'<div class="ad6"><span class="tips"></span><a href="javascript:;" class="ad7">我知道了</a></div>',"a6":'<div class="ad8"><p class="ad9"></p></div>',
"a7":"{{if (channelId == 1118 || channelId == 1953 || channelId == 43 || channelId == 6) && result.config && result.config.isFlowerCake}}<div class=\"cy\" clstag=\"pageclick|keycount|channel_tip_20160908|1\"><span class=\"markCircle\">!</span><span class=\"addressFont\">{{result.config.isFlowerCake}}</span><span class=\"arrowRight\"></span></div>{{/if}}<div class='bf {{if (channelId == 1118 || channelId == 1953 || channelId == 43 || channelId == 6) && result.config && result.config.isFlowerCake}}cx{{/if}}'>{{each result.data}} {{if $value.floorStyle=='banner' || $value.floorStyle=='floorBanner'}} {{if $value.floorTitle && $value.floorTitle.floorName}}<div class=\"bd\"><a href=\"javascript:0;\">{{$value.floorTitle.floorName}}</a></div>{{/if}}<div class=\"swipe7 {{if $value.floorStyle=='floorBanner'}}c1{{/if}} {{if !$20($data)}}b2{{/if}} {{if $value.edge== true}}aa{{/if}}\" swipe floorStyle=\"{{$value.floorStyle}}\">{{include('ba',{data:$value,address:address,isChannel:\"isChannel\"})}}</div>{{else if $value.floorStyle=='ball' && $value.styleTpl=='tpl1'}} {{=include('bf',$117($value,address))}} {{else if $value.styleTpl=='tpl1' && $value.floorStyle.indexOf('act')==0}} {{include('be',{data:$value,edge:$value.edge,address:address})}} {{else if $value.floorStyle=='miaoSha'}}<div class='an'>{{include('bo',{data:$value.data || $value.dataObj,edge:$value.edge,address:userAddress || lbsAddress || address,grab:\"\"})}}</div>{{else if $value.styleTpl=='tpl2' && $value.floorStyle.indexOf('act')==0}} {{include('bb',{data:$value,address:address})}} {{else if $value.styleTpl=='tpl2' && $value.floorStyle=='ball'}} {{include('bc',{data:$value,address:address})}} {{else if $value.styleTpl=='tpl5' && $value.floorStyle.indexOf('act')==0}} {{include('bd',{data:$value,address:address})}} {{else if $value.styleTpl=='tpl4'}}<div class=\"bi\">{{=include('bi',{data:$value,actNineData:$87($value.data),address:address})}}</div>{{else if $value.styleTpl=='tpl1' && $value.floorStyle.indexOf('product6')==0 && result.config.storeConfig && !result.config.storeConfig.recommendStore}} {{include('bl',$value)}} {{else if $value.styleTpl=='tpl1' && $value.floorStyle.indexOf('product7')==0 && result.config.storeConfig && !result.config.storeConfig.recommendStore}} {{include('bl',$value)}} {{else if $value.floorStyle.indexOf('product2')==0}} {{include('bj',$value)}} {{else if $value.floorStyle.indexOf('product3')==0}}{{else if $value.styleTpl=='tpl6' && $value.floorStyle.indexOf('act')==0}} {{if $value.edge}}<div class={{$116($value.borderStyle)}}></div>{{/if}} {{if $value.data.length}}<div class=\"by\"><div class=\"bz entrance-total{{$value.data.length}}\">{{each $value.data}}<a class=\"c0 entrance-num{{$index}}\" {{if $value.floorCellData.to==\"storeListByKey\" }} skipByKeys='{{$value.floorCellData.to}}' keySkipData='{{$33($value.floorCellData.params)}}' userAction='{{$value.floorCellData.userAction}}'{{/if}} {{if $value.floorCellData.to!=\"storeListByKey\" }}href=\"{{$15($value.floorCellData.to,$value.floorCellData.params,address,\"\",\"\",$value.floorCellData.userAction)}}\"{{/if}} onclick=\"lg('user_action','1.0',{{$value.floorCellData.userAction || '{}'}})\"><strong class=\"as\">{{if $value.floorCellData.title}}<span class=\"captionTitle\">{{$value.floorCellData.title}}</span>{{/if}} {{if $value.floorCellData.words}}<span class=\"subtitle\">{{$value.floorCellData.words}}</span>{{/if}}</strong><img class=\"at\" src=\"{{$value.floorCellData.imgUrl}}\" onerror='this.src=\"//static-o2o.360buyimg.com/daojia/new/images/show_default.png\"' /></a>{{/each}}</div></div>{{/if}} {{else if $value.styleTpl=='tpl7' && $value.floorStyle.indexOf('act')==0}} {{if $value.edge}}<div class={{$116($value.borderStyle)}}></div>{{/if}} {{include('bn',{data:$value,address:address})}} {{/if}} {{/each}}</div><div class=\"loading\"></div><div class=\"hw brand aa\" style=\"display:none\"></div><div class=\"hw tabkeout aa\" style=\"display:none\"></div><div noresult></div>",
"a8":'<div class="gt"><div class="gu {{if !productComment.hasMore}}no-comment-more{{/if}}"><span class="comment-title">商品评价{{if productComment && productComment.commentNum >0}}<span class="h0">(共{{productComment.commentNum}}人评价){{/if}}</span></span>{{if productComment.commentNum< 1}}<em class="gv">暂无评价</em>{{else}}<div class="h2"><div class="h3"><span class="h4" style="width: {{productComment.goodRate}}%"><span class="h5"></span><span class="h6"></span></span></div><span class="h7">好评{{productComment.goodRate}}%</span></div>{{/if}}</div></div>',
"a9":'<div class="kk scrolling">{{if state==1}}<p class="kl" clstag="pageclick|keycount|my_coupons_exchange_20160713|1"><i>＋</i>使用兑换码</p>{{else}}<div class="ie tap-current-{{state}}"><span class="dis-current-past coupon-tap-ele" _state="3" clstag="pageclick|keycount|coupons_expired|1">已过期</span><span class="if coupon-tap-ele"_state="2" clstag="pageclick|keycount|coupons_used|1">已使用</span></div>{{/if}}<div class="coupon">{{if error}}<div class="noCoupon"><p>暂无优惠券</p></div>{{else}} {{if result && result.length}}<div class="hx"><ul class="coupons">{{include(\'e5\',{youhuiquanList: result,state:state})}}</ul></div>{{else}}<div class="noCoupon"><p>暂无优惠券</p></div>{{/if}} {{/if}}</div>{{if state==1}}<div class="ic"><a href="#disabledCoupons" clstag="pageclick|keycount|coupons_unavailable|1">查看不可用优惠券<i class="id"></i></a></div><div class="a8q"><a class="a8r" href="/activity/invite/index.html?channel=h5_fxyl_coupon">邀请好友获得优惠券</a></div>{{/if}}</div>',
"aa":'{{if data && data.length >0}} {{each data}}<li class="list_li"><div class="headerPic"><img src="{{if $value.img}}{{$value.img}}{{/if}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/store/evaluateHeader.jpg"\' class="pic"></div><dl class="evaluateList"><dt>{{if $value.nickName}}<div class="pName">{{$value.nickName}}</div>{{/if}} {{if $value.time}}<span class="DateTime">{{$value.time}}</span>{{/if}}</dt><dd>{{if $value.score >= 0}}<div class="a9q">{{$40($value.score)}}</div>{{/if}} {{if $value.content}}<p class="userComment">{{$value.content}}</p>{{/if}} {{if $value.venderTags && $value.venderTags.length >0}}<div class="a9d"><i class="peisongMark"></i><div class="serviceWrap">{{each $value.venderTags}}<span class="pieceFont">{{$value}}</span>{{/each}}</div></div>{{/if}} {{if $value.orderText}}<div class="merchantReply"><u class="markBtn"></u><p class="content">商家回复：{{$value.orderText}}</p></div>{{/if}} {{if $value.prds && $value.prds.length >0}}<div class="productWrap" {{if $value.prds.length<= 1 && !$value.prds[0].skuName}}style="display: none"{{/if}}><i class="fingerMark"></i><div class="singleProWrap">{{each $value.prds}} {{if $value.skuName && $value.params}}<a href="#goodsDetails/skuId:{{$value.params.skuId}}/storeId:{{$value.params.storeId}}/orgCode:{{$value.params.orgCode}}" class="singlePro" data-skuid="{{if $value.skuId}}{{$value.skuId}}{{/if}}" >{{$value.skuName}}</a>{{/if}} {{/each}}</div></div>{{/if}}</dd></dl></li>{{/each}} {{/if}}',
"ab":'{{if result}}<div class="evaluateStoreHome">{{if result.sta}}<div class="scoreNumberWrap">{{if result.sta.avg >0}}<dl class="scoreWrap"><dt>{{result.sta.avg}}</dt><dd>综合评分</dd></dl>{{/if}}<dl class="numberWrap" style="{{if result.sta.avg<= 0}}width:100%;{{/if}}">{{if result.sta.tc || result.sta.tc == \'0\'}}<dt>{{$92(result.sta.tc)}}</dt>{{/if}}<dd>评论数</dd></dl></div>{{/if}}<div class="contentWrap">{{if result.sta}}<div class="tabWrap"><ul class="tabNav">{{if result.sta.tc >= 0}}<li class="selected" data-type="1" onclick=\'lg("user_action","1.0",{"clickid":"evaluate_all","store_id":"{{storeid}}"})\' style="{{if result.sta.tcFtC}}color: {{result.sta.tcFtC}};{{/if}}{{if result.sta.tcBgC}}background-color: {{result.sta.tcBgC}};{{/if}}">全部 ({{result.sta.tc}})</li>{{/if}} {{if result.sta.lc1 >= 0}}<li data-type="2" onclick=\'lg("user_action","1.0",{"clickid":"evaluate_good","store_id":"{{storeid}}"})\' style="{{if result.sta.lc1FtC}}color: {{result.sta.lc1FtC}};{{/if}}{{if result.sta.lc1BgC}}background-color: {{result.sta.lc1BgC}};{{/if}}">好评 ({{result.sta.lc1}})</li>{{/if}} {{if result.sta.lc2 >= 0}}<li data-type="3" onclick=\'lg("user_action","1.0",{"clickid":"evaluate_general","store_id":"{{storeid}}"})\' style="{{if result.sta.lc2FtC}}color: {{result.sta.lc2FtC}};{{/if}}{{if result.sta.lc2BgC}}background-color: {{result.sta.lc2BgC}};{{/if}}">中评 ({{result.sta.lc2}})</li>{{/if}} {{if result.sta.lc3 >= 0}}<li data-type="4" onclick=\'lg("user_action","1.0",{"clickid":"evaluate_bad","store_id":"{{storeid}}"})\' style="{{if result.sta.lc3FtC}}color: {{result.sta.lc3FtC}};{{/if}}{{if result.sta.lc3BgC}}background-color: {{result.sta.lc3BgC}};{{/if}}">差评 ({{result.sta.lc3}})</li>{{/if}}</ul></div>{{/if}} {{if (result.sta.bdTag && result.sta.bdTag.length >0) || (result.sta.gdTag && result.sta.gdTag.length >0)}}<div class="cuteWrap">{{if (result.sta.gdTag && result.sta.gdTag.length >0)}} {{each result.sta.gdTag}} {{if $value.tagName}}<span class="cute" data-type="{{$value.tagKey}}" data-tagname="{{$value.tagName}}" data-storeid="{{storeid}}" style="{{if $value.ftC}}color: {{$value.ftC}};{{/if}}{{if $value.bgC}}background-color: {{$value.bgC}};{{/if}}">{{$value.tagName}} ({{$value.tagCt}})</span>{{/if}} {{/each}} {{/if}} {{if (result.sta.bdTag && result.sta.bdTag.length >0)}} {{each result.sta.bdTag}} {{if $value.tagName}}<span class="cute" data-type="{{$value.tagKey}}" data-tagname="{{$value.tagName}}" data-storeid="{{storeid}}" style="{{if $value.ftC}}color: {{$value.ftC}};{{/if}}{{if $value.bgC}}background-color: {{$value.bgC}};{{/if}}">{{$value.tagName}} ({{$value.tagCt}})</span>{{/if}} {{/each}} {{/if}}</div>{{/if}}<div class="filterEvaluate"><span class="RadioWrap"><i class="inputRadio{{if result.showGual}} RadioSelected{{/if}}"></i></span><label>只看有内容的评价</label></div><div class="switchLoading"></div><ul class="evaluateListWrap">{{include(\'aa\',{data: result.evaluateList || \'\'})}}</ul><p class="ct">努力加载中<i></i></p></div></div>{{/if}}',
"ac":'{{if data && data.length}}<div class="a77 coupons">{{each data}}<div class="a79" faxianItem="{{config.careType}}"><a class="a7a" {{if ($value.storeInfo&&$value.storeInfo.storeId)}} href="#storeHome/storeId:{{$value.storeInfo.storeId}}/orgCode:{{$value.storeInfo.venderId}}" {{else if ($value.feedInfo.to)}} href="{{$19($value.feedInfo.to,$value.feedInfo.params)}}" {{/if}} ><img src="{{$value.storeInfo.imgUrl}}" onclick=\'lg("user_action","1.0",{"click_name":"focus_detail","store_id":"{{$value.storeInfo.storeId}}","index":"{{2-config.careType}}","focus_ways":"1","type":"{{$value.feedInfo.feedType}}"})\'><h3 onclick=\'lg("user_action","1.0",{"click_name":"focus_detail","store_id":"{{$value.storeInfo.storeId}}","index":"{{2-config.careType}}","focus_ways":"1","type":"{{$value.feedInfo.feedType}}"})\'>{{$value.storeInfo.storeName}}</h3><i>{{$value.feedInfo.time}}</i></a>{{if $value.storeInfo.followed}}<span class="a7b followed" storeId="{{$value.storeInfo.storeId}}">已关注</span>{{else}}<span class="a7b" storeId="{{$value.storeInfo.storeId}}" _follow onclick=\'lg("user_action", "1.0", {"click_name":"myfocus_storelist_20160815","store_id":"{{$value.storeInfo.storeId}}"})\'>+ 关注</span>{{/if}}<a class="a7d" {{if ($value.storeInfo&&$value.storeInfo.storeId)}} href="#storeHome/storeId:{{$value.storeInfo.storeId}}/orgCode:{{$value.storeInfo.venderId}}" {{else if ($value.feedInfo.to)}} href="{{$19($value.feedInfo.to,$value.feedInfo.params)}}" {{/if}} onclick=\'lg("user_action","1.0",{"click_name":"focus_detail","store_id":"{{$value.storeInfo.storeId}}","activityId":"{{$value.feedInfo.params.activityId}}","index":"{{2-config.careType}}","focus_ways":"3","type":"{{$value.feedInfo.feedType}}"})\' >{{$value.feedInfo.feedText}}</a>{{if $value.feedInfo.counponParams && $value.feedInfo.counponParams.promotionId}} {{=include(\'h7\', { coupons:$81($value.feedInfo), storeInfo:$value.storeInfo, logType:\'fuli\', gotoStore: true } )}} {{else if $value.feedInfo.feedType!=1 && $value.feedInfo.details && $value.feedInfo.details.length}}<div class="a7e faxian-list-item-imgs-len-{{$value.feedInfo.details.length}}">{{each $value.feedInfo.details as $v $i}}{{if $v.imgUrl}}<a href="{{$19($value.feedInfo.to,$value.feedInfo.params,$v.objectId,$value.storeInfo.venderId)}}" {{if $value.feedInfo.details.length==1}} style="display:block;width:{{$69($v.imgWidth,$v.imgHeight)}};height:{{$69($v.imgWidth,$v.imgHeight)}};" {{else if ($value.feedInfo.details.length==2)}} style="height:{{($34()-76)*0.4}}px" {{else if ($value.feedInfo.details.length>=5)||($value.feedInfo.details.length==3)}} style="height:{{($34()-76)*0.315}}px" {{/if}} {{if ($i+1)%3==0}}class="a7f"{{/if}}><img src="{{$4($v.imgUrl)}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\' onclick=\'lg("user_action","1.0",{"click_name":"focus_detail","store_id":"{{$value.storeInfo.storeId}}","activityId":"{{$value.feedInfo.params.activityId}}","imgurl":"{{$v.imgUrl}}","index":"{{2-config.careType}}","focus_ways":"4","type":"{{$value.feedInfo.feedType}}","pic_type":"{{$v.detailType}}"})\' >{{if $28($v.basicePrice) && $28($v.realPrice) && ($v.diffValue >0)}}<span class="a7g {{$6($v)}}">￥{{$3($1($v.realPrice/100))}} {{if $v.vipLogo}}<img src="{{$v.vipLogo}}" class="a7l"/>{{else}}<del>￥{{$3($1($v.basicePrice/100))}}</del>{{/if}}</span>{{else if $v.vipLogo && $28($v.realPrice)}}<span class="a7g {{$6($v)}}">￥{{$3($1($v.realPrice/100))}}<img src="{{$v.vipLogo}}" class="a7l"/></span>{{/if}} {{if $7($value.feedInfo.feedType,$v.status)}}<span class="a7i">{{$7($value.feedInfo.feedType,$v.status)}}</span>{{/if}}</a>{{/if}}{{/each}}</div>{{else if $value.feedInfo.feedType==1 && $value.feedInfo.details && $value.feedInfo.details.length }} {{if $value.feedInfo.details[0].detailType && $value.feedInfo.details[0].detailType==1}} {{each $value.feedInfo.details as $v $i}} {{if $i == 0}}<div class="a7e faxian-list-item-imgs-len-1">{{if $v.imgUrl}}<a href="{{$19($value.feedInfo.to,$value.feedInfo.params,$v.objectId,$value.storeInfo.venderId)}}" style="display:block;width:{{$69($v.imgWidth,$v.imgHeight)}};height:{{$69($v.imgWidth,$v.imgHeight)}};" ><img src="{{$4($v.imgUrl)}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\' onclick=\'lg("user_action","1.0",{"click_name":"focus_detail","store_id":"{{$value.storeInfo.storeId}}","activityId":"{{$value.feedInfo.params.activityId}}","imgurl":"{{$v.imgUrl}}","index":"{{2-config.careType}}","focus_ways":"4","type":"{{$value.feedInfo.feedType}}","pic_type":"{{$v.detailType}}"})\' ></a>{{/if}}</div>{{/if}} {{/each}} {{/if}}<div class="a7e faxian-list-item-imgs-len-9">{{each $value.feedInfo.details as $v $i}}{{if $v.detailType && $v.detailType==2 && $v.imgUrl }}<a href="{{$19($value.feedInfo.to,$value.feedInfo.params,$v.objectId,$value.storeInfo.venderId)}}"style="height:{{($34()-76)*0.315}}px" {{if ($i)%3==0}}class="a7f"{{/if}}><img src="{{$4($v.imgUrl)}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\' onclick=\'lg("user_action","1.0",{"click_name":"focus_detail","store_id":"{{$value.storeInfo.storeId}}","activityId":"{{$value.feedInfo.params.activityId}}","imgurl":"{{$v.imgUrl}}","index":"{{2-config.careType}}","focus_ways":"4","type":"{{$value.feedInfo.feedType}}","pic_type":"{{$v.detailType}}"})\'>{{if $28($v.basicePrice) && $28($v.realPrice) && ($v.diffValue >0)}}<span class="a7g {{$6($v)}}">￥{{$3($1($v.realPrice/100))}} {{if $v.vipLogo}}<img src="{{$v.vipLogo}}" class="a7l"/>{{else}}<del>￥{{$3($1($v.basicePrice/100))}}</del>{{/if}}</span>{{else if $v.vipLogo && $28($v.realPrice)}}<span class="a7g {{$6($v)}}">￥{{$3($1($v.realPrice/100))}}<img src="{{$v.vipLogo}}" class="a7l"/></span>{{/if}} {{if $7($value.feedInfo.feedType,$v.status)}}<span class="a7i">{{$7($value.feedInfo.feedType,$v.status)}}</span>{{/if}}</a>{{/if}}{{/each}}</div>{{/if}}</div>{{/each}}</div>{{else}} {{if config && config.currentpage==0 && (!config.isHasNonCare)}} {{include("fs",{msg:\'关注的门店近期没有更新福利动态\',other_tip_bg:\'yu\'})}} {{/if}} {{/if}}',
"ad":'<h3 class="a7k"><span></span><em>附近的热门动态</em><span></span></h3>',"ae":'<div class="uo"><p class="opinion_box">{{content}}</p><div class="ctrlArea"><textarea placeholder="请输入您的反馈意见" id="userFeedBack" maxlength="300"></textarea><input type="text" id="feedBackMobile" maxlength="11" placeholder="请输入您的手机号（选填）"/></div><footer class="btn_pay_style"><button id="codButton" class="fyh">发送</button></footer></div>',"af":'<div class="dx"><div class="dy"><div class="dz swipe7"></div>{{if logoTag}}<span class="e0 promotion-tag-{{logoTag.type}}"><i>{{logoTag.iconText}}</i></span>{{/if}}<div class="hr_shadow"></div></div>{{if detailInfo && detailInfo.h5HtmlText && detailInfo.h5HtmlText != null && detailInfo.h5HtmlText.length != 0}}<div class="e3"><div class="e2"><h1 class="e4">{{name}}</h1></div>{{if adword}}<h3 class="e5">{{adword}}</h3>{{/if}}</div>{{else}}<div class="e3"><h1 class="e4">{{name}}</h1>{{if adword}}<h3 class="e5">{{adword}}</h3>{{/if}}</div>{{/if}} {{if groupSkuVO}}<div class="e7"><div class="e8">{{if groupSkuVO.groupPriceDisplay}}<span class="e9 tuan-title-1">{{groupSkuVO.groupPriceDisplay}}</span>{{/if}}<p class="promotionprice promotionprice-1"><span>￥</span>{{groupSkuVO.groupPrice}}</p></div><div class="e8">{{if groupSkuVO.djPriceDisplay}}<span class="e9 tuan-title-2">{{groupSkuVO.djPriceDisplay}}</span>{{/if}}<p class="promotionprice promotionprice-2"><span>￥</span>{{groupSkuVO.djPrice}}</p></div><div class="ea"><span class="delivery-msg-1">{{groupSkuVO.deliveryDisplay}}</span><span class="delivery-msg-2">{{groupSkuVO.groupLinkDisplay}}</span></div></div><div class="eb"><div class="ec"><div class="ed"><span>拼</span><em>轻松3步，开始拼团</em><a href="{{groupSkuVO.groupRuleUrl}}"><em>了解详情</em><i class="dw arrow eu"></i></a></div><div class="ee"><div class="ef tuan-rule-step-1"><span class="eg">1.</span><p><span class="eh">选择商品</span><span class="eh">支付开团</span></p></div><i class="dw rule-arrow-1 eu"></i><div class="ef tuan-rule-step-2"><span class="eg">2.</span><p><span class="eh">邀请好友</span><span class="eh">参团享惠</span></p></div><i class="dw rule-arrow-2 eu"></i><div class="ef tuan-rule-step-3"><span class="eg">3.</span><p><span class="eh">凑齐人数</span><span class="eh">开团成功</span></p></div></div></div></div>{{else}} {{if productType == 3 || productType == 4 || productType == 5}} {{if miaoshaInfo && miaoshaInfo.miaoShaSate == 1}}<div class="gs">秒杀<em node-type="sy"><i>{{hour}}</i>:<i>{{minute}}</i>:<i>{{second}}</i></em>结束</div>{{else}} {{/if}} {{/if}}<div class="ei {{if inCartCount >0 && buttonEnable}}switchHide{{/if}}"><div class="ej {{if hasSaleAttr || (tags && tags.length)}}e1{{/if}}"><p class="promotionprice"><span>￥</span>{{skuPriceVO.realTimePrice||暂无报价}}</p>{{if skuPriceVO.promotion==0}} {{if !memberConfigInfo || (memberConfigInfo && (!memberConfigInfo.vipPrice || memberConfigInfo.vipPrice===\'暂无报价\'))}}<p class="marketprice"><span>￥</span>{{skuPriceVO.basicPrice}}</p>{{/if}} {{/if}} {{if !$110() && memberConfigInfo}} {{include("hc",{v:memberConfigInfo})}} {{/if}} {{if productType == 1 || productType == 4}}<span class="ek {{if !$110() && memberConfigInfo}}Tcenter{{/if}} {{if buttonEnable}}{{if miaoshaInfo && miaoshaInfo.miaoShaSate != 2}}sure{{else}}sure{{/if}}{{/if}} {{if inCartCount >0 && buttonEnable}}hideAddCart{{/if}}" _skuId="{{skuPriceVO.skuId}}" _orgCode="{{orgCode}}" _storeId="{{storeInfo.storeId}}" onclick=\'lg("user_action","1.0",{"clickid":"add_cart","sku_id":"{{skuPriceVO.skuId}}"})\'>{{showStateName}}</span><div class="Box {{if !$110() && memberConfigInfo}}Tcenter{{/if}}"><span class="reduce" _skuId="{{skuPriceVO.skuId}}" _storeId="{{storeInfo.storeId}}" _orgCode="{{orgCode}}" onclick=\'lg("user_action","1.0",{"clickid":"reduce_cart","sku_id":"{{skuPriceVO.skuId}}"})\'>减</span><label class="show">{{inCartCount}}</label><span class="add" _skuId="{{skuPriceVO.skuId}}" _storeId="{{storeInfo.storeId}}" _orgCode="{{orgCode}}" onclick=\'lg("user_action","1.0",{"clickid":"add_cart","sku_id":"{{skuPriceVO.skuId}}"})\'>加</span></div>{{/if}}</div></div>{{/if}} {{if memberConfigInfo && memberConfigInfo.membersUrl && memberConfigInfo.vipPrice && memberConfigInfo.vipPrice !== \'暂无报价\'}}<div class="member"><div class="ep"><a href="{{memberConfigInfo.membersUrl}}" style="display:block"><span class="eq">会员</span><img src="//static-o2o.360buyimg.com/daojia/new/images/store/memberCard.png" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'/><span class="er">开通店铺会员，立享优惠</span><i class="dw arrow eu"></i></a></div></div>{{/if}} {{if tags && tags.length>0}}<div class="el"><div class="em {{if hasSaleAttr}}e1{{/if}}">{{if tags.length>2}}<span class="en" >促销</span>{{/if}}<div class="eo">{{if tags.length>2}}<p class="promotion-title">可享受以下促销<i class="dw arrow es"></i></p>{{/if}}<ul class="promotion-list {{if tags.length>2}}promotion-list-2{{else}}promotion-list-1{{/if}}">{{include(\'hd\',{storetags:tags,type:\'goods\',storeInfo:storeInfo,classname:"ev",orignskuId:skuId})}}</ul>{{if tags.length>2}}<p class="ey">{{each tags}}<span class="ex {{if $index == 0}}first-active-type{{/if}}" style="background: #{{$value.colorCode}}">{{$value.iconText}}</span>{{/each}}</p>{{/if}}</div></div></div>{{/if}} {{if hasSaleAttr}}<div class="ez"><div class="f0"><span class="f1">已选</span><div class="f2"><p class="property-title">{{mainAttrValueName}} {{if subAttrValueName}}{{subAttrValueName}}{{/if}}<i class="dw arrow eu"></i></p></div></div></div>{{/if}} {{if prescription}}<div class="f6"><p class="f7">处方药购买须知</p><div class="f8">{{=prescriptionInstructions}}</div><i class="dw fa es" tap></i></div>{{/if}} {{if funcIndicatins}}<div class="f3"><p class="f4">功能主治</p><p class="f5">{{funcIndicatins}}</p></div>{{/if}} {{if storeInfo.venderPhone}}<div class="fb clearfix"><div class="fc"><a href="#storeHome/storeId:{{storeInfo.storeId}}/orgCode:{{storeInfo.venderId}}"><i class="dw fe"></i><span class="eq">{{storeInfo.storeName}}</span></a></div><div class="fd"><a href="tel:{{storeInfo.venderPhone}}" clstag="pageclick|keycount|item_connect_20160623_1|1"><i class="dw ff"></i><span class="fg">联系商家</span></a></div></div>{{else}}<div class="fb"><div class="fh"><a href="#storeHome/storeId:{{storeInfo.storeId}}/orgCode:{{storeInfo.venderId}}"><i class="dw fe"></i><span class="eq">{{storeInfo.storeName}}</span><i class="dw arrow eu"></i></a></div></div>{{/if}} {{if productComment}} {{include(\'a8\')}} {{/if}} {{if isRemind}}<div class="fk"></div>{{/if}} {{if detailInfo && detailInfo.h5HtmlText && detailInfo.h5HtmlText != null && detailInfo.h5HtmlText.length != 0}}<div class="gq" clstag="pageclick|keycount|goodinfo_detail_20161013|1"><span class="fontColor">查看图文详情</span><span class="circle"><i></i></span></div>{{/if}}</div>{{if detailInfo && detailInfo.h5HtmlText && detailInfo.h5HtmlText != null && detailInfo.h5HtmlText.length != 0}}<div class="fi clearfix"></div>{{/if}}<div style="padding-bottom:30px;"></div>',
"ag":'<div class="fj">{{=html}}</div>',"ah":'<div class="fp skill-order-button {{if buttonEnable}}sure{{/if}}" clstag="pageclick|keycount|item_immediately_buy_20160623_1|1">{{showStateName}}</div>',"ai":'{{if productType == 2 || productType == 5}}<div class="fp danpin-order-button {{if buttonEnable}}sure{{/if}}" clstag="pageclick|keycount|item_immediately_buy_20160623_1|1">{{showStateName}}</div>{{/if}}',
"aj":'{{if $data && $data.length>0}}<div class="swipe7list">{{each}}<div class="swipe7item"><img src="{{$91($value.big)}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'></div>{{/each}}</div>{{if $data.length >1}}<span class="gr"><span class="bigFont">1</span>/<span class="smallFont">{{$data.length}}</span></span>{{/if}} {{else}}<div class="a" style="height:320px"></div>{{/if}}',"ak":'{{if result && result.length>0}}<p class="fn">{{title}}</p><div class="swipe7 fm"><div class="swipe7list">{{each result}}<div class="swipe7item"><ul class="g9 fo">{{each $value.data}}<li><a class="ga" href="#goodsDetails/skuId:{{$value.skuId}}/storeId:{{$value.storeId}}/orgCode:{{$value.orgCode}}" onclick=\'lg("user_action","1.0",{"clickid":"{{skuDate}}",{{$41($value.userActionSku)}}})\'><img src="{{$value.imgUrl}}" class="big-item-three" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'><span class="gb">{{$value.skuName}}</span>{{if $value.realTimePrice == \'暂无报价\' }}<span class="gd"><i>￥</i>暂无报价</span>{{else}}<span class="gc"><i>￥</i>{{$value.realTimePrice}}</span>{{/if}} {{if $value.memberConfigInfo}}<div class="newadd">{{include("hc",{v:$value.memberConfigInfo})}}</div>{{/if}}</a>{{if showCart && $value.showCartButton}}<span class="ge sure tuijian {{if $value.memberConfigInfo && $value.memberConfigInfo.vipPrice && $value.memberConfigInfo.vipPrice!==\'暂无报价\' && $value.memberConfigInfo.vipPriceColorCode && $value.memberConfigInfo.vipPriceIcon}}ismember{{/if}}" _skuId="{{$value.skuId}}" _orgCode="{{$value.orgCode}}" _storeId="{{$value.storeId}}" onclick=\'lg("user_action","1.0",{"clickid":"{{cartDate}}",{{$41($value.userActionSku)}}})\'></span>{{/if}}</li>{{/each}}</ul></div>{{/each}}</div>{{/if}}',
"al":'<div class="fq"><div class="fs" tap></div><div class="ft"><div class="fu"><img src="{{imgUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'>{{if groupSkuVO}}<p class="fy"><span class="fz">{{groupSkuVO.groupPriceDisplay}}</span><span class="fx"><i>￥</i>{{groupSkuVO.groupPrice}}</span></p><p class="fw"><span class="fz">{{groupSkuVO.djPriceDisplay}}</span><span class="fx"><i>￥</i>{{groupSkuVO.djPrice}}</span></p>{{else}}<p class="fv"><span class="fx"><i>￥</i>{{price}}</span></p>{{/if}}<span class="g0">{{mainAttrValueName}} {{subAttrValueName}}</span><i class="dw g1" tap></i></div>{{if saleAttrList && saleAttrList.length}}<div class="g2">{{each saleAttrList}}<div class="g3 select-property-content-{{$value.sort}} clearfix"><span class="g4">{{$value.attrName}}：</span>{{if saleAttrList && saleAttrList.length}}<div class="g5"><ul class="clearfix">{{each $value.saleAttrValueList}}<li _saleId="{{$value.saleId}}" _skuId="{{$value.skuId}}" _otherkey="{{$48($value.otherAttrValueSkuMap)}}" _otherProperty="{{$47($value.otherAttrValueSkuMap)}}" class="{{if $value.status==1}}status-1{{else}}status-3{{/if}} {{if $value.selectAttr}}selected{{/if}}">{{$value.name}}</li>{{/each}}</ul></div>{{/if}}</div>{{/each}}</div>{{/if}} {{if productType == 3}}<div class="zu skill-order-button {{if buttonEnable}}sure{{/if}}">{{settlementModeName}}</div>{{else if productType == 2 || productType == 5}}<div class="zu danpin-order-button {{if buttonEnable}}sure{{/if}}">{{settlementModeName}}</div>{{/if}}</div>',
"am":'<div class="wm" style="min-height:{{$29() - 44}}px;"><div class="search-show-wrap"><div class="search-hot-wrap"></div><div class="w8"></div></div><div class="key-suggest-wrap"></div></div>',"an":'{{if result.hotWordVOList && result.hotWordVOList.length >0}}<div class="w6 wn">热门搜索</div><div class="w7">{{each result.hotWordVOList}} {{if $value.hotWords.length >0}}<a class="js-hot-search" onclick=\'lg("user_action","1.0",{"clickid":"click_rm_search","key":"{{$value.hotWords}}"})\'>{{$value.hotWords}}</a>{{/if}} {{/each}}</div>{{/if}}',
"ao":'<div class="w9 wn a2">搜索历史</div>',"ap":'{{include("ao")}}<div class="search-history-box">{{if list && list.length >0}}<ul class="wa">{{each list}} {{if $value.length >0}}<li class="a2"><a class="js-hot-search" onclick=\'lg("user_action","1.0",{"clickid":"click_ls_search","key":"{{$value}}"})\'>{{$value}}</a></li>{{/if}} {{/each}}</ul><a class="wc" clstag="pageclick|keycount|allsearch_clean_history_20160623_1|1">清除搜索历史</a>{{/if}}</div>',
"aq":'<ul class="wb">{{if list && list.length >0}} {{each list}} {{if $value.type == 0 && $value.name.length >0}}<li class="a2"><a class="js-hot-search" onclick=\'lg("user_action","1.0",{"clickid":"click_lx_search","key":"{{$value.name}}","sugindex":"{{$index+1}}","isstore": "0"})\'>{{$value.name}}</a></li>{{else if $value.type == 1 && $value.store && $value.store.storeName}}<li class="a2 y0"><a href="#storeHome/storeId:{{$value.store.storeId}}/orgCode:{{$value.store.orgCode}}" onclick=\'lg("user_action","1.0",{"clickid":"click_lx_search","key":"{{$value.name}}","sugindex":"{{$index+1}}","isstore": "1","storeId":{{$value.store.storeId}},"input": "{{inputVal}}" })\'><img src="{{if $value.store.logo}}{{$value.store.logo}}{{else}}//static-o2o.360buyimg.com/daojia/new/images/notfound.png{{/if}}" class="storePic" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/notfound.png"\'><div class="y1"><h3 class="y2">{{$value.store.storeName}}</h3><div class="y3"><p class="y4">{{include("h6",{score: $value.store.starGrade})}}</p>{{include("gy",{monthSale: $value.store.monthSale })}}</div></div></a></li>{{/if}} {{/each}} {{/if}}</ul>',
"as":'{{each skuList}}<li data-pagetype="{{storePageType}}" class="x8" onclick=\'{{if isRecommend}}lg("user_action","1.0",{"clickid":"click_nosearch_result_recommend","store_id":"{{$value.storeId}}","sku_id":"{{$value.skuId}}","type":"click_sku"}){{else}}lg("user_action","1.0",{"clickid":"allsearch_result_item_20160713","sku_id":"{{$value.skuId}}","store_id":"{{$value.storeId}}","isfocus":"{{if attentionStatus == 1}}1{{else}}0{{/if}}"}){{/if}}\'><a href="#storeHome/skuId:{{$value.skuId}}/storeId:{{$value.storeId}}/orgCode:{{$value.orgCode}}/fromAnchor:true/promotionType:{{if $value.tags && $value.tags.length >0}}{{$value.tags[0].type}}{{/if}}/activityId:{{if $value.tags && $value.tags.length >0}}{{$value.tags[0].activityId}}{{/if}}"><img src="{{if !$value.imgUrl}}//static-o2o.360buyimg.com/daojia/new/images/notfound.png{{else}}{{$value.imgUrl}}{{/if}}" class="pic" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/notfound.png"\'><div class="proBox">{{if !isRecommend}} {{if $value.skuName}}<p class="h1">{{$value.skuName}}</p>{{/if}} {{if $value.monthSales || $value.highOpinion}}<p class="monthChild">{{if $value.monthSales}}月售{{$value.monthSales}}单{{/if}} &nbsp; {{if $value.highOpinion}}{{$value.highOpinion}}{{/if}}</p>{{/if}} {{/if}}<div class="priceBox">{{if isRecommend}} {{if $value.vipPrice}}<label class="realPrice"><em>￥</em>{{$value.vipPrice}}</label>{{else if !$value.vipPrice && $value.realTimePrice}}<label class="realPrice"><em>￥</em>{{$value.realTimePrice}}</label>{{else if !$value.vipPrice || $value.vipPrice === \'暂无报价\'}} {{if $value.basicPrice}}<label class="basicPrice"><em>￥</em>{{$value.basicPrice}}</label>{{/if}} {{/if}} {{else}} {{if $value.realTimePrice}}<label class="realPrice"><em>￥</em>{{$value.realTimePrice}}</label>{{/if}} {{if !$value.vipPrice || $value.vipPrice === \'暂无报价\'}} {{if $value.basicPrice}}<label class="basicPrice"><em>￥</em>{{$value.basicPrice}}</label>{{/if}} {{/if}} {{include("hc",{v:$value})}} {{/if}}</div></div></a></li>{{/each}}',
"at":'{{each storeSkuList}}<div class="storeBox singleStore hideThreeLi {{if isRecommend}}x7{{/if}}">{{include("au",{$value:$value,store:$value.store || $value,skuList : $value.skuList || $value.skus,isRecommend:isRecommend})}} {{include("h1",{$value:$value.store || $value})}} {{if $value.store && $value.count && $value.count >2}}<div class="moreAll" data-storeid="{{$value.store.storeId}}" data-orgcode="{{$value.store.orgCode}}" data-pagetype="{{$value.store.storePageType}}" onclick=\'lg("user_action","1.0",{"clickid":"allsearch_result_more_20160713"})\'><span class="slideUpFont" data-lg="allsearch_result__packup_20160713">收起</span><span class="moreFont" data-lg="allsearch_result_more_20160713">查看更多<var>{{if $value.count >23}}21{{else}}{{$value.count -2}}{{/if}}</var>件商品</span><i></i></div>{{/if}}</div>{{/each}}',
"au":'<div class="ae0"><a href="#storeHome/storeId:{{store.storeId }}/orgCode:{{ store.orgCode }}" class="adz" data-storeid="{{store.storeId}}" data-orgcode="{{store.orgCode }}" data-pagetype="{{store.storePageType}}" onclick=\'{{if isRecommend}}lg("user_action","1.0",{"clickid":"click_nosearch_result_recommend","store_id":"{{store.storeId}}","type":"click_store"}){{else}}lg("user_action","1.0",{"clickid":"allsearch_result_store_20160713","store_id":"{{store.storeId}}","isfocus":"{{if store.attentionStatus == 1}}1{{else}}0{{/if}}"}){{/if}}\'>{{include(\'gw\',{$value:store})}}</a><div class="d7"><a class="ado" {{if store.to}} href="{{$15(store.to,store.params)}}" {{else}} href="#storeHome/storeId:{{store.storeId}}/orgCode:{{store.venderId || store.orgCode }}"{{/if}} onclick=\'{{if isRecommend}}lg("user_action","1.0",{"clickid":"click_nosearch_result_recommend","store_id":"{{store.storeId}}","type":"click_store"}){{else}}lg("user_action","1.0",{"clickid":"allsearch_result_store_20160713","store_id":"{{store.storeId}}","isfocus":"{{if store.attentionStatus == 1}}1{{else}}0{{/if}}"}){{/if}}\'>{{include("gx",{$value:store})}}</a><div>{{if (store.tag && store.tag.length>0) || (skuList && skuList.length>0)}}<div class="adv {{if fromHash && fromHash == \'newMember\'}}ds{{/if}}">{{include(\'gz\',{tags:store.tag,fromHash:"indexSearchToStore",$value:store})}} {{if skuList.length >0}}<ul class="List">{{include(\'as\',{skuList: skuList, storePageType: store.storePageType,attentionStatus: store.attentionStatus,isRecommend:isRecommend})}}</ul>{{/if}}</div>{{/if}}</div></div></div>',
"av":'<div class="x4">{{if result.storeList.length==0 && result.storeSkuList.length == 0 && result.recStoreSkuList.length == 0}} {{include(\'fw\',{msg:\'抱歉，未能找到您搜索的门店或商品\',subMsg:\'换个关键词试试吧\',height:false})}} {{else if result.storeList.length==0 && result.recStoreSkuList.length>0}} {{include(\'fw\',{msg:\'抱歉，未能找到您搜索的门店或商品\',subMsg:\'换个关键词试试吧\',height:true})}}<div class="wrapRepeat"><div class="vo x5"><h3 class="x6"><span><b>为你推荐</b></span></h3>{{include(\'at\',{storeSkuList:result.recStoreSkuList,isRecommend:\'true\'})}}</div></div><div class="ct">努力加载中<i></i></div>{{else}} {{if result.promptWord}}<div class="noSearch">抱歉，没有找到商品，为你推荐<span class="keywd">“{{result.promptWord}}”</span>下搜索结果</div>{{/if}} {{if result.cmsSearchKeyBannerResult && result.cmsSearchKeyBannerResult.floors && result.cmsSearchKeyBannerResult.floors.length >0 && result.cmsSearchKeyBannerResult.floors[0].data && result.cmsSearchKeyBannerResult.floors[0].data.length >0}}<div class="searchResultBanner"><a {{if result.cmsSearchKeyBannerResult.floors[0].data[0].to =="storeListByKey" }} skipByKeys="{{result.cmsSearchKeyBannerResult.floors[0].data[0].to}}" keySkipData=\'{{$33(result.cmsSearchKeyBannerResult.floors[0].data[0].params)}}\'{{/if}} href="{{$39($15(result.cmsSearchKeyBannerResult.floors[0].data[0].to,result.cmsSearchKeyBannerResult.floors[0].data[0].params,address))}}" onclick=\'lg("user_action","1.0",{"clickid":"seebanner","storeid":"{{result.cmsSearchKeyBannerResult.floors[0].data[0].params.storeId}}",searchword":"{{key}}"})\'><img src="{{result.cmsSearchKeyBannerResult.floors[0].data[0].prefixImgUrl}}" onerror="this.src=\'//static-o2o.360buyimg.com/daojia/new/images/index_banner_default_2.0.png\'"></a></div>{{/if}} {{if result.storeSkuList && result.storeSkuList.length >0}}<div class="wrapRepeat"><div class="vo">{{include(\'at\',{storeSkuList:result.storeSkuList})}}</div></div><div class="ct">努力加载中<i></i></div>{{/if}} {{/if}}</div>',
"ax":"<div class=\"xb\">{{if result.searchResultVOList.length == 0}} {{if purTickets}} {{include('fw',{msg:'无优惠券适用商品'})}} {{else}} {{include('fw',{msg:'没有找到您要的商品[0001]'})}} {{/if}} {{/if}} {{if result.searchResultVOList && result.searchResultVOList.length >0}} {{if result.promptWord}}<div class=\"noSearch\">抱歉，没有找到商品，为你推荐<span class=\"keywd\">“{{result.promptWord}}”</span>下搜索结果</div>{{/if}}<ul class=\"ri {{if pagetype == 2}}a1q{{/if}}\">{{include('aw',{List: result.searchResultVOList,skuDate: skuDate,cartaddDate: cartaddDate,cartreduceDate: cartreduceDate, isCart: result.showCart||true, pagetype: pagetype})}}</ul><div class=\"ct\">努力加载中<i></i></div>{{/if}}</div>",
"ay":'{{if result.couponList && result.couponList.length >0}}<div class="xp">{{if result.redirectType != 0}}<a href="{{if result.redirectType == 1}}{{result.redirectToUrl}}{{else if result.redirectType == 2}}{{$15(result.couponList[0].to,result.couponList[0].params,"","",result.couponList[0].params.limitId)}}{{else}}javascript:;{{/if}}" clstag="pageclick|keycount|jump">{{/if}}<div class="xq"><img src="{{if result.upRedirectUrl}}{{result.upRedirectUrl}}{{else}}//static-o2o.360buyimg.com/daojia/new/images/searchGift/gift_top.png{{/if}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/searchGift/gift_top.png"\' width="100%"/><div class="xr" {{if result.couponList[0].couponPicColor}}style="color:{{result.couponList[0].couponPicColor}}"{{/if}}><img src="{{if result.downRedirectUrl}}{{result.downRedirectUrl}}{{else}}//static-o2o.360buyimg.com/daojia/new/images/searchGift/gift_bottom.png{{/if}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/searchGift/gift_bottom.png"\' width="100%"/><div class="xs"><p class="xt"><span class="xv">{{result.couponList[0].amount}}</span><span class="xw">{{result.couponList[0].amountUnit}}</span></p><p class="xu"><span class="xx">{{result.couponList[0].couponPicText || \'优惠券\'}}</span><span class="xy">{{result.couponList[0].couponPicDesc || \'已放入您的账户\'}}</span></p></div></div><a href="javascript:;" class="xz" clstag="pageclick|keycount|close"></a></div>{{if result.redirectType != 0}}</a>{{/if}}</div>{{/if}}',
"az":'<div class="uq">{{if list && list.length>0}} {{each list}}<dl neirong><dt biaoti>{{$value.title}}</dt><dd>{{=$value.content}}</dd></dl>{{/each}} {{/if}}</div>',"b0":'<div class="loading" style="min-height:{{$29(-90)}}px"></div><div class="x3"><div class="wt" style="min-height:{{$29(-140)}}px"></div></div>',"b1":'<ul class="ws">{{each}}<li class="wu {{if $index == 0}}wv{{/if}}" homecateId={{$value.catId}} clstag="pageclick|keycount|category_tab_20160623_{{$index+1}}|4" >{{$value.name}}</li>{{/each}}</ul>',
"b2":'{{each}}<dl class="ww"><dt class="wy">{{$value.name}}</dt><dd class="wz">{{include("b3",$value.tabCateList)}}</dd></dl>{{/each}}',"b3":'{{each}}<a class="x0" href=\'#indexSearchToStore/catIds:{{$45($value.catIds)}}/cateName:{{$32($value.name)}}\' ><img class="x1" src="{{if $value.imgUrl}}{{$value.imgUrl}}{{else}}//static-o2o.360buyimg.com/daojia/new/images/show_default.png{{/if}}" {{if !$value.imgUrl}}style="backgroundColor:#f4f4f4"{{/if}} onerror="this.src=\'//static-o2o.360buyimg.com/daojia/new/images/show_default.png\'"/><span class="x2">{{$value.name}}</span></a>{{/each}}',
"br":'<div class="ac5"><dl class="ac6"><dt class="ac7">当前鲜豆<a href="{{data.readmeUrl || \'/activity/vip/m_integration.html\'}}" onclick="lg(\'user_action\', \'1.0\', {\'page_name\':\'pointdesc\'});">鲜豆说明</a></dt><dd class="ac8"><span>{{(data && data.points) || 0}}</span>个</dd></dl></div><div class="ac9"><h6 class="acb">最近30条鲜豆明细</h6>{{if data && data.evaluateList}}<ul class="acc">{{each data.evaluateList as item}}<li class="acd"><span class="ace {{item.points>0 || \'add\'}}">{{item.points >0 ? \'+\'+item.points : item.points}}</span><p class="acf">{{item.typeName}}<b class="acg">{{item.createTime}}</b></p></li>{{/each}}</ul>{{if data.evaluateList.length >0}}<div class="ach"><a href="#integralList" class="aci" onclick="lg(\'user_action\', \'1.0\', {\'page_name\':\'pointdetail\'});">查看全部明细</a></div>{{/if}} {{else}}<div class="yr">没有鲜豆记录</div>{{/if}}</div>',
"bt":'{{each data.evaluateList as item}}<li class="acd"><span class="ace {{item.points>0 || \'add\'}}">{{item.points >0 ? \'+\'+item.points : item.points}}</span><p class="acf">{{item.typeName}}<b class="acg">{{item.createTime}}</b></p></li>{{/each}}',"bu":'<div class="acp"><h5>鲜豆任务</h5>{{each data}}<dl class="acq"><dt class="acr"><img src="{{$value.icon}}"></dt><dd class="acs"><a href="{{$value.skipUrl}}" class="act">{{$value.buttonText}}</a><p class="acu"><span class="acv">{{$value.title}}</span><span class="integral-sign-txt-msg">{{$value.instruction}}</span></p></dd></dl>{{/each}}</div>',
"bv":'<div class="invoice" style="min-height: {{$29(-30)}}px;"><p class="aby">抬头：<span invoiceType="1" class="abw {{if titleType == 1}}checked{{/if}}">企业</span><span invoiceType="0" class="abw {{if titleType == 0}}checked{{/if}}" >个人</span></p><p class="abz a2"><textarea class="ac1 enterprise" {{if titleType == 0}}style="display: none;"{{/if}} placeholder="请填写抬头名称" rows="1" maxlength="30">{{if titleType == 1 && titleContent}}{{titleContent}}{{/if}}</textarea><a style="opacity: 0;{{if titleType == 0}}display: none;{{/if}}" class="ac2 enterprise-clear" href="javascript:void(0)"></a><textarea class="ac1 person" {{if titleType == 1}}style="display: none;"{{/if}} placeholder="请填写抬头名称" rows="1" maxlength="30">{{if titleType == 0 && titleContent}}{{titleContent}}{{else}}个人{{/if}}</textarea><a style="opacity: 0;{{if titleType == 1}}display: none;{{/if}}" class="ac2 person-clear" href="javascript:void(0)"></a></p><p class="ac0 a2" {{if titleType == 0}}style="display: none;"{{/if}}>税号：<input class="ac1 invoice-duty-no" type="text" placeholder="请填写纳税人识别号" {{if taxNum}}value="{{taxNum}}"{{/if}}><a style="opacity: 0;" class="ac2 duty-no-clear" href="javascript:void(0)"></a><a class="io" taxNumTip=\'{{$33(taxNumTip)}}\' href="javascript:void(0)"></a></p><p class="abx a2">邮箱：<input class="ac1 invoice-email-input" type="text" placeholder="用来接收电子发票邮件" {{if userEmail}}value="{{userEmail}}"{{/if}}><a style="opacity: 0;" class="ac2 email-clear" href="javascript:void(0)"></a></p><a class="ac3" href="javascript:void(0)">保存</a>{{if invoiceId}}<a class="delete" href="javascript:void(0)"></a>{{/if}}</div>',
"bw":'<div class="kf" style="min-height: {{$getWindowMinHeight -75}}px;"><div class="abp"><p class="abq">{{invoiceTile}}</p><p class="abr"><i>¥</i>{{$36(invoiceMoney)}}<a class="iconfont ms" invoiceMoneyTip="{{invoiceMoneyTip}}" clstag="pageclick|keycount|seeinvoiceamoutcomment|1" href="javascript:void(0)"></a></p><p class="abs">{{invoiceETip}}</p><p class="abt">{{invoiceStoreRemark}}</p></div><ul class="abu">{{include(\'bx\')}}</ul><div class="m3"><a class="m5" href="javascript:void(0)">新增发票抬头</a></div></div>',
"bx":'<li class="abv a2"><i class="ka {{if !invoiceId}}checked{{/if}}"></i>{{noNeedInvoiceTip || \'不需要发票\'}}</li>{{if invoiceInfoVOList}} {{each invoiceInfoVOList}}<li class="abv a2"><i class="ka {{if invoiceId == $value.invoiceId}}checked{{/if}}" invoiceId="{{$value.invoiceId}}"></i><p><span class="abw"><i style="background: {{$value.titleFlagColor}}">{{$value.titleFlagContent}}</i>{{$value.titleContent}}</span>{{if $value.taxNum}}<span class="abx">税号： {{$value.taxNum}}</span><br>{{/if}}<span class="abx">邮箱： {{$value.userEmail}}</span></p><a class="edit" invoiceId="{{$value.invoiceId}}" href="javascript:void(0)"></a></li>{{/each}} {{else}} {{=include(\'fs\', {btnHref: "javascript:void(0)", msg: msg, cutHeight: 300})}} {{/if}}',
"by":'<ul class="a46">{{if $43(type)}}<li class="a2"><a href=\'openApp.jdMobile://virtual?params={"category":"jump","des":"im","entry":"jd_phone_jddaojia"}\'><i class="a47 a48"></i><span class="a4e"><h2>在线客服</h2><p>点击查看您与客服的沟通记录</p></span></a></li>{{/if}} {{each msgList}}<li class="a2"><a href="#msgDetail/msgType:{{$value.msgType}}" msgType="{{$value.msgType}}" message><i class="a47 {{$59($value.msgType)}}"></i><span class="a4e"><h2>{{$58($value.msgType)}}<em>{{$value.startReplayTimeStr}}</em></h2><p>{{$value.msgContent}}</p></span></a><i class="redPoint"></i></li>{{/each}}</ul>',
"bz":"<ul class=\"a4g\">{{include('c0',{list:list})}}</ul>","c0":'{{each list}}<li><p class="promotion-date">{{$value.startReplayTimeStr}}</p>{{if $value.isEnd == 0}}<a href="{{$value.url}}">{{/if}}<span class="a4j"><h2>{{$value.msgTitle}}</h2><div class="a4m"><img src="{{$value.imgUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/index_banner_default_2.0.png"\'/>{{if $value.isEnd == 1}}<div class="a4p"><em><i><br/>活动<br/>结束</i></em></div>{{/if}}</div><span>{{$value.msgContent}}</span><p class="h">查看详情<i class="a4o"></i></p></span>{{if $value.isEnd == 0}}</a>{{/if}}</li>{{/each}}',
"c1":"<ul class=\"a4h\">{{include('c2',{list:list})}}</ul>","c2":'{{each list}}<li><p class="order-date">{{$value.startReplayTimeStr}}</p><a href="{{if $value.msgType == 3}}#couponsList{{else}}#orderdetail/orderId:{{$value.orderId}}{{/if}}"><span class="a4k">{{if $value.msgType == 3}}<h2>{{$value.msgTitle}}<i class="a4o"></i></h2><p class="h a4n"></p>{{else}}<h2>订单：{{$value.orderId}}<i class="a4o"></i></h2><p class="h">{{$value.msgTitle}}</p>{{/if}}<span>{{$value.msgContent}}</span></span></a></li>{{/each}}',
"c3":"<ul class=\"a4f\">{{include('c4',{list:list})}}</ul>","c4":'{{each list}}<li><p class="a4i">{{$value.startReplayTimeStr}}</p>{{if $value.isEnd == 0}}<a href="{{$value.url}}">{{/if}}<span class="a4l"><h2>{{$value.msgTitle}}</h2><span>{{$value.msgContent}}</span><i class="a4o"></i></span>{{if $value.isEnd == 0}}</a>{{/if}}</li>{{/each}}',"c5":'<div class="swipe7 ta" style="min-height: inherit;"></div><div node-type="seckillListWrap"></div>',
"c6":'{{if $data && $data.length>0}}<div class="swipe7list">{{each}}<div class="swipe7item"><a {{if $value.params && $value.params.url}}href="{{$value.params.url}}" {{/if}}><img src="{{$value.imgUrl}}"></a></div>{{/each}}</div>{{else}}<div class="a" style="height:160px"></div>{{/if}}',"c7":'{{each list}}<li class="t3 {{if $value.miaoShaSate==2}}ts{{/if}}" ><a class="t2" href="#storeHome/skuId:{{$value.skuId}}/storeId:{{$value.storeId}}/orgCode:{{$value.orgCode}}/fromAnchor:true" onclick=\'lg("user_action","1.0",{"clickid":"skill_sku_20161013","sku_id":"{{$value.skuId}}"})\'>{{if $value.miaoShaSate==2}}<div class="t8 t9">已抢光</div>{{/if}}<img src="{{$value.imageurl}}" class="t4" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'><span class="tj"><span class="t5">{{$value.name}}</span>{{if $value.newMiaoSha}} {{if $value.isfollow == 1}}<span class="ti tk">来自我关注的{{$value.storeName}}</span>{{else}}<span class="ti">来自{{$value.storeName}}</span>{{/if}} {{/if}}<strong class="st">{{if $value.miaoShaSate == 2}}<i><em class="t1">￥</em>{{$value.miaoShaPrice}}</i><i class="su"><em class="t1">￥</em>{{$value.price}}</i>{{else}}<i><em class="t1">￥</em>{{$value.miaoShaPrice}}</i><i class="su"><em class="t1">￥</em>{{$value.price}}</i>{{/if}}</strong>{{if $value.miaoShaSate == 1}}<span class="tm to"><span class="tp $value.progressStrip" style="width:{{$value.progressStrip || 0}}%"></span><span class="tq" {{if $value.progressStrip}}style="left:{{$value.progressStrip}}%"{{/if}}></span><em class="tn">已抢购<var>{{$value.progressStrip || 0}}%</var></em></span>{{else}}<span class="tm"></span>{{/if}}</span></a>{{if $value.miaoShaSate == 1 }}<a class="sv {{if $value.newMiaoSha}}tl{{/if}}" href="#storeHome/skuId:{{$value.skuId}}/storeId:{{$value.storeId}}/orgCode:{{$value.orgCode}}/fromAnchor:true/needAddCart:true" onclick=\'lg("user_action","1.0",{"clickid":"skill_sku_20161013","sku_id":"{{$value.skuId}}"})\'><i class="t0">马上抢</i></a>{{/if}}</li>{{/each}}',
"c8":'{{if miaoShaList.length}}<ul class="tr">{{include(\'c7\',{"list":miaoShaList})}}</ul><footer class="sz" node-type="seckillGoodsEnd"><span class="t6" ></span><span class="t7">没有更多秒杀商品啦</span><span class="t6" ></span></footer>{{else}} {{include(\'fw\')}} {{/if}}',"c9":'<div class="te loading" style="min-height:{{$29(-50)}}px"><div class="grabWrap" ></div></div>',
"cl":'{{each evaluateList}}<div class="a9p"><div class="storeTitle" data-orgcode="{{if $value.orgCode}}{{$value.orgCode}}{{/if}}" data-storeid="{{if $value.storeId}}{{$value.storeId}}{{/if}}" onclick=\'lg("user_action","1.0",{"clickid":"evaluate_click_store","store_id":"{{$value.storeId}}"})\'><div class="headerPic"><img src="{{if $value.storeImgUrl}}{{$value.storeImgUrl}}{{/if}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/store/evaluateHeader.jpg"\' class="pic"></div><div class="storeWrap">{{if $value.storeName}}<div class="nameBox"><span class="Name">{{$value.storeName}}</span><u class="arrowBtn"></u></div>{{/if}}<span class="DateTime">{{$value.createTime}}</span></div></div>{{if $value.delivery && $value.delivery.titleName}}<ul class="serviceList"><li class="hh">{{if $value.delivery.titleName}}<span class="fontTitle">{{$value.delivery.titleName}}</span>{{/if}} {{if $value.delivery.score}}<span class="a9q">{{$40($value.delivery.score)}}</span>{{/if}} {{if $value.delivery.deliveryDifTimeStr}}<span class="hi">{{$value.delivery.deliveryDifTimeStr}}</span>{{/if}}</li>{{if $value.delivery.content}}<li class="contents">{{$value.delivery.content}}</li>{{/if}} {{if $value.delivery.tags && $value.delivery.tags.length >0}}<li class="hj"><i class="peisongMark"></i><div class="singleProWrap">{{each $value.delivery.tags}}<span class="singlePro">{{$value}}</span>{{/each}}</div></li>{{/if}}</ul>{{/if}} {{if $value.vendor}}<ul class="serviceList"><li class="hh">{{if $value.vendor.titleName}}<span class="fontTitle">{{$value.vendor.titleName}}</span>{{/if}} {{if $value.vendor.score}}<span class="a9q">{{$40($value.vendor.score)}}</span>{{/if}} {{if $value.vendor.deliveryDifTimeStr}}<span class="hi">{{$value.vendor.deliveryDifTimeStr}}</span>{{/if}}</li>{{if $value.vendor.content}}<li class="contents">{{$value.vendor.content}}</li>{{/if}} {{if $value.vendor.venderTags && $value.vendor.venderTags.length >0}}<li class="hj"><i class="peisongMark"></i><div class="singleProWrap">{{each $value.vendor.venderTags}}<span class="singlePro">{{$value}}</span>{{/each}}</div></li>{{/if}} {{if $value.vendor.prds && $value.vendor.prds.length >0}}<li class="hj" {{if $value.vendor.prds.length<= 1 && !$value.vendor.prds[0].skuName}}style="display: none"{{/if}}><i class="fingerMark"></i><div class="singleProWrap">{{each $value.vendor.prds}} {{if $value.skuName}}<span class="singlePro">{{$value.skuName}}</span>{{/if}} {{/each}}</div></li>{{/if}} {{if $value.vendor.prds_negate && $value.vendor.prds_negate.length >0}}<li class="hj" {{if $value.vendor.prds_negate.length<= 1 && !$value.vendor.prds_negate[0].skuName}}style="display: none"{{/if}}><i class="fingerMark fingerMarkDislike"></i><div class="singleProWrap">{{each $value.vendor.prds_negate}} {{if $value.skuName}}<span class="singlePro">{{$value.skuName}}</span>{{/if}} {{/each}}</div></li>{{/if}} {{if $value.vendor.orderText}}<li class="replyBox"><div class="titleBox">商家回复：<span class="DateTime">{{if $value.vendor.orgTime}}{{$value.vendor.orgTime}}{{/if}}</span></div><p class="replyContent">{{$value.vendor.orderText}}</p></li>{{/if}}</ul>{{/if}} {{if $value.vendor.littleImg && $value.vendor.littleImg.length}}<ul class="serviceList"><li class="hh">{{each $value.vendor.littleImg as $i index}}<img src="{{$120($i)}}" _src="{{$120($119($value.vendor.bigCommentImg,index))}}" class="pingjiaShowBigImg" width="65"/>{{/each}}</li></ul>{{/if}}</div>{{if $value.showUpdateBtn}}<div class="a9r"><div class="a9s">如本订单差评问题已解决</div><a href="#pingjia/orderId:{{$value.orderId}}/storeId:{{$value.storeId}}/editComment:true" class="a9t">修改评价</a></div>{{/if}} {{/each}}',
"cm":'{{if result && result.evaluateList && result.evaluateList.length >0 && result.config && result.config.totalCount != 0}}<div class="a9o">{{include(\'cl\',{evaluateList: result.evaluateList})}}</div>{{else}}<div class="gx gy" style="min-height:{{$29()}}px;background-color:#fff;"><div class="gz"><h5>{{\'您还未对订单进行过评价哦～\'}}</h5></div></div>{{/if}}',"cn":'<div class="newMember" style="min-height:{{$29()}}px"><div class="bannerWrap"><img src="//static-o2o.360buyimg.com/daojia/new/images/index/newMember2.jpg"></div><div class="article"><ul class="vo dq">{{include(\'gv\',{data:data,fromHash:\'newMember\'})}}</ul></div><div class="ct"><i></i><span>继续滑动查看更多内容</span></div></div>',
"co":'<div class="iu {{if isDada}}je{{/if}} {{if channel == "dadajdmall"}}jf{{/if}}"><div class="pay-header">{{if result.countDownTime && result.countDownTime!=-1}}<div class="iv {{if isDada||!result.stationName}}dadaBg{{/if}} a4 k"><span class="iw">剩余支付时间</span><span class="ix">{{if initTime}}{{initTime}}{{/if}}</span></div>{{/if}} {{if !isDada && result.stationName}}<div class="iy {{if !result.countDownTime}}dadaBg a4 k{{/if}}">{{if result.countDownTime}}<i class="j2"></i><i class="j0"></i><i class="j1"></i><i class="j3"></i>{{/if}}<span class="c6">{{result.stationName||\'\'}}</span><span class="iz">￥<i>{{result.amount}}</i></span></div>{{/if}}</div><p class="j4 a2">请选择支付方式</p><ul>{{each result.payWays}} {{if $value.payWay == "10"}}<li class="wx a2 {{if $value.freeTag == \'0\' && $index == 0 && $89()}}noFreePay{{/if}}" payType="wx" freeTag={{$value.freeTag}} index={{$index}}><p class="j5">{{$value.payName}}{{if $value.freeTag == \'1\' && $89() && $value.extParam && $35($value.extParam).freeTagTrue}}<em class="k6">{{$35($value.extParam).freeTagTrue}}</em>{{/if}}</p>{{if $value.freeTag == \'0\' && $89()}}<p class="k5" onclick=\'lg("user_action","1.0",{"clickid":"to_wx_pay"})\' {{if $index !=0 }}style="display:none;"{{/if}}>{{($value.extParam && $35($value.extParam).freeTagFalse) || \'开通小额免密，小额消费可免输支付密码\'}}<a></a></p>{{/if}}<i {{if $index==0}}class="checked"{{/if}}></i></li>{{else if $value.payWay == "20"}}<li class="jd a2" payType="jd" freeTag={{$value.freeTag}} index={{$index}}><p class="j5">{{$value.payName}}{{if $value.freeTag == \'1\' && $90() && ($value.extParam && $35($value.extParam).freeTagTrue)}}<em class="k6">{{$35($value.extParam).freeTagTrue}}</em>{{/if}}</p>{{if $value.extCopy || ($value.extParam && $35($value.extParam).discountTag)}}<p class="jb">{{if $value.extParam && $35($value.extParam).discountTag}}<span>{{$35($value.extParam).discountTag}}</span>{{/if}} {{if $value.extCopy}}<span>{{$value.extCopy}}</span>{{/if}}</p>{{/if}} {{if $value.activityCopy}}<p class="j6 jk">{{$value.activityCopy}}</p>{{else if $value.defaultCopy}}<p class="j6">{{$value.defaultCopy}}</p>{{/if}}<p class="k9"></p><i {{if $index==0}}class="checked"{{/if}}></i></li>{{else if $value.payWay == "30"}}<li class="bt a2" payType="bt" index={{$index}}><p class="j5">{{$value.payName}}</p><p class="j6">{{$value.defaultCopy}}{{if $value.extCopy}}，{{$value.extCopy}}{{/if}}</p><i></i></li>{{else if $value.payWay == "31"}}<li class="nbt a2" payType="nbt" index={{$index}}><p class="j5">{{$value.payName}}</p><p class="j6">{{$value.defaultCopy}}{{if $value.extCopy}}，{{$value.extCopy}}{{/if}}</p></li>{{else if $value.payWay == "40"}}<li class="zfb a2" payType="zfb" index={{$index}}><p class="j5">{{$value.payName}}</p><p class="j6">{{$value.defaultCopy}}</p><i></i></li>{{else if $value.payWay == "70"}}<li class="dai a2" payType="dai" style="display:{{$88()}}" index={{$index}} title={{$value.defaultCopy}} desc={{$value.extCopy}} link={{$value.extParam}}><p class="j5">{{$value.payName}}</p><em class="jn"></em></li>{{/if}} {{/each}}</ul>{{if !isDada && channel!="dashang" && channel!="container" && result.cashierType!="vip"}}<p class="j7"><span>马上支付，可领取分享红包。</span></p>{{/if}}<p class="j9"><button {{if result.color}}style="color:{{result.color}}"{{/if}} isSending="no" class="{{if result.countDownTime!=""&&result.countDownTime==0 }}disable{{/if}}">{{if result.prescriptionTag}}提交定金{{else}}确认支付{{/if}}<i>￥</i><em>{{result.amount}}</em></button></p><p class="j8 none"><button class="finish">已完成支付</button><span></span><button class="refresh" isSending="no">重新支付</button></p></div><div class="jo"><img src="//static-o2o.360buyimg.com/daojia/new/images/pay/share_guide.png" class="jp"/><img src="//static-o2o.360buyimg.com/daojia/new/images/pay/btn_know.png" class="jq"/></div><div class="k7"><p class="k8"></p></div>',
"cp":'<div class="jr"><div><p class="js">帮收货人<em>{{customerName}}</em>代付</p><p class="jt">￥<em>{{amount}}</em></p><p class="ju">支付剩余时间：<em>{{initTime}}<em></p></div><ul><li>说明：</li><li>1. 付款前请先电话或当面核实好友身份再付款，代付商品或服务不归你所有。</li><li>2. 如果发生退款，钱将退还到你付款时选择的支付账户里。</li></ul></div>{{if productList && productList.length >0}} {{include("cs",{productList:productList})}} {{/if}}<p class="j9 daiPay"><button isSending="no">{{if prescriptionTag}}提交定金{{else}}确认支付{{/if}}<i>￥</i><em>{{amount}}</em></button></p>',
"cq":'<div class="daiPaySuccess"><div class="jz"><h3>支付成功</h3><div class="daiPayInfo"><p>你已为好友成功支付了￥{{amount}}<br/>赶快微信通知他吧！</p></div></div></div>',"cr":'<div class="k0"><h3 class="{{if payState == 2}}success{{else}}fail{{/if}}">{{if payState == 2}}代付订单已完成付款！ {{else if payState == 3}}代付订单已取消！ {{else if payState == 4}}代付订单已失效！ {{/if}}</h3><p>如遇退款，将退款到付款人支付账户中。</p></div>{{if productList && productList.length >0}} {{include("cs",{productList:productList})}} {{/if}}',
"cs":'<div class="jw"><p class="jv">代付订单信息</p><ul>{{each productList}}<li><img src="{{$value.imgPath}}" class="jx" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/notfound.png"\'/>{{if $value.promotionType == 1203 || $value.promotionType == 6}}<i class="gift">赠品</i>{{else if $value.promotionType == 1202}}<i class="change">换购</i>{{/if}}<div class="jy"><p>{{$value.name}}</p>{{if $value.promotionPriceStr}}<p><em class="promotion">{{$value.promotionPriceStr}}</em><em class="promotion num">x{{$value.promotionNum}}</em></p>{{else}}<br/>{{/if}}<p><em>{{$value.priceStr}}</em><em>x{{$value.num}}</em><span>{{$value.totalPriceStr}}</span></p></div></li>{{/each}}</ul></div>',
"ct":'<div class="newStore"><div class="bannerWrap"><img src="//static-o2o.360buyimg.com/daojia/new/images/index/newStore.jpg"></div><div class="article"><ul class="vo">{{include(\'gv\',{data:data,fromHash:\'newStore\'})}}</ul></div><div class="ct"><i></i><span>继续滑动查看更多内容</span></div></div>',"cy":'<div class="a3p"><div class="a3q"><div class="a0j clearfix"><img class="sd" src= \'{{result.storeInfo.logoUrl || "//static-o2o.360buyimg.com/daojia/new/images/icon/notfound-2.png"}}\'/><div class="se"><div class="a3r clearfix"><h2 class="sf" id="sf">{{result.storeInfo.storeName}}</h2><div class="a1v {{if result.storeInfo.isFollow == true}}a1y{{/if}}" {{if result.storeInfo.isFollow == true}}data-focus=1 clstag="pageclick|keycount|store_focus_20160815_2" {{else}}data-focus=0 clstag="pageclick|keycount|store_focus_20160815_1" {{/if}} ><i class="a1x "></i></div></div>{{if result.storeInfo.deliveryFirst}} {{include(\'fh\')}} {{/if}} {{if result.storeInfo.freightTag}} {{include(\'fi\')}} {{/if}}</div></div>{{include(\'fk\',{result:result,from:\'storeDetail\'})}}</div>{{if result.storeInfo && result.storeInfo.tags && result.storeInfo.tags.length >0}}<div class="a3s"><h3>促销活动</h3><ul class="a3t">{{include("hd",{storetags:result.storeInfo.tags,classname:"a38"})}}</ul></div>{{/if}} {{if result.storeCommentVO}}<div class="a3u a0n">{{include(\'fj\',{result:result,from:\'storeDetail\'})}}</div>{{/if}}<div class="a3w">{{include(\'fg\',{"storeInfo":result.storeInfo,"tagList":result.tagList||[],"type":"new",hasLogin:hasLogin,isJb:result.isJb,appVersion:appVersion,from:\'storeDetail\'})}}</div></div>',
"d0":'<form method="post" action="https://m.wangyin.com/wepay/web/pay" id="payForm" style="display:none"><input name="version" value="{{version}}"><input name="token" value="{{token}}"><input name="merchantSign" value="{{merchantSign}}"><input name="merchantNum" value="{{merchantNum}}"><input name="merchantRemark" value="{{merchantRemark}}"><input name="tradeNum" value="{{tradeNum}}"><input name="tradeName" value="{{tradeName}}"><input name="tradeDescription" value="{{tradeDescription}}"><input name="tradeTime" value="{{tradeTime}}"><input name="tradeAmount" value="{{tradeAmount}}"><input name="currency" value="{{currency}}"><input name="notifyUrl" value="{{notifyUrl}}"><input name="successCallbackUrl" value="{{successCallbackUrl}}"><input name="failCallbackUrl" value="{{failCallbackUrl}}"><input name="jdPin" value="{{jdPin}}"><input name="merchantOrderNum" value="{{merchantOrderNum}}"><input name="merchantUserId" value="{{merchantUserId}}"></form>',
"d1":'<form action="{{payUrl}}" method="post" id="batchForm" ><input type="hidden" name="version" value="{{version || \'\'}}"><br/><input type="hidden" name="merchant" value="{{merchant || \'\'}}"><br/><input type="hidden" name="device" value="{{device || \'\'}}"><br/><input type="hidden" name="tradeNum" value="{{tradeNum || \'\'}}"><br/><input type="hidden" name="tradeName" value="{{tradeName || \'\'}}"><br/><input type="hidden" name="tradeDesc" value="{{tradeDesc || \'\'}}"><br/><input type="hidden" name="tradeTime" value="{{tradeTime || \'\'}}"><br/><input type="hidden" name="amount" value="{{amount || \'\'}}"><br/><input type="hidden" name="currency" value="{{currency || \'\'}}"><br/><input type="hidden" name="note" value="{{note || \'\'}}"><br/><input type="hidden" name="callbackUrl" value="{{callbackUrl || \'\'}}"><br/><input type="hidden" name="notifyUrl" value="{{notifyUrl || \'\'}}"><br/><input type="hidden" name="ip" value="{{ip || \'\'}}"><br/><input type="hidden" name="userType" value="{{userType || \'\'}}"><br/><input type="hidden" name="userId" value="{{userId || \'\'}}"><br/><input type="hidden" name="expireTime" value="{{expireTime || \'\'}}"><br/><input type="hidden" name="orderType" value="{{orderType || \'\'}}"><br/><input type="hidden" name="industryCategoryCode" value="{{industryCategoryCode || \'\'}}"><br/><input type="hidden" name="specCardNo" value="{{specCardNo || \'\'}}"><br/><input type="hidden" name="specId" value="{{specId || \'\'}}"><br/><input type="hidden" name="specName" value="{{specName || \'\'}}"><br/><input type="hidden" name="sign" value="{{sign || \'\'}}"><br/><input type="hidden" name="orderGoodsNum" value="{{orderGoodsNum || \'\'}}"><br/><input type="hidden" name="vendorId" value="{{vendorId || \'\'}}"><br/><input type="hidden" name="goodsInfo" value="{{goodsInfo || \'\'}}"><br/><input type="hidden" name="receiverInfo" value="{{receiverInfo || \'\'}}"><br/><input type="hidden" name="termInfo" value="{{termInfo || \'\'}}"><br/></form>',
"d2":'<form id="zfbForm" action="{{action||\'\'}}" method="{{method||\'\'}}"><input type="hidden" name="sign" value="{{sign||\'\'}}"/><input type="hidden" name="body" value="{{body||\'\'}}"/><input type="hidden" name="_input_charset" value="{{_input_charset || \'\'}}"/><input type="hidden" name="subject" value="{{subject || \'\'}}"/><input type="hidden" name="total_fee" value="{{total_fee || \'\'}}"/><input type="hidden" name="sign_type" value="{{sign_type || \'\'}}"/><input type="hidden" name="service" value="{{service || \'\'}}"/><input type="hidden" name="notify_url" value="{{notify_url || \'\'}}"/><input type="hidden" name="partner" value="{{partner || \'\'}}"/><input type="hidden" name="seller_id" value="{{seller_id || \'\'}}"/><input type="hidden" name="out_trade_no" value="{{out_trade_no || \'\'}}"/><input type="hidden" name="payment_type" value="{{payment_type || \'\'}}"/><input type="hidden" name="return_url" value="{{return_url || \'\'}}"/><input type="hidden" name="show_url" value="{{show_url || \'\'}}"/><input type="hidden" name="app_pay" value="{{app_pay || \'\'}}"/><input type="hidden" name="rn_check" value="{{rn_check || \'\'}}"/><input type="hidden" name="goods_type" value="{{goods_type || \'\'}}"/><input type="hidden" name="it_b_pay" value="{{it_b_pay || \'\'}}"/></form>',
"d3":'{{if startIndex==0}}<a class="pv h a2" noCommentOrderCount href="javascript:void(0)" {{if hasComment}}style="display: block;"{{/if}}><i>还有未评价的订单哦，点击去评价</i><i class="n5 nj"></i></a>{{/if}}<ul class="mv list">{{include(\'d4\')}}</ul>',"d4":'{{if list}} {{if list.length >0}} {{each list}} {{include("d5", {orderItem: $value})}} {{/each}} {{if list.length< 10}}<li class="n" style="margin-bottom: 60px;">已显示全部</li>{{/if}} {{else}} {{if error}} {{if type=="unlogin"}} {{include(\'fr\',{"msg":"登录后才能查看订单哦"})}} {{/if}} {{else}} {{if startIndex==0}}<div class="ya oj" style="min-height:667px"><div class="yb"><p>没有未评价的订单哦，赶紧去购物吧</p><a class="y5" href="#index">去逛逛</a></div></div>{{else}}<li class="n" style="margin-bottom: 60px;">已显示全部</li>{{/if}} {{/if}} {{/if}} {{/if}}',
"d5":'<li class="mx" orderId="{{orderItem.orderId}}" orderState="{{orderItem.orderState}}" orderDetailStyle="{{orderItem.orderDetailStyle}}" storeId="{{orderItem.storeId}}" orgCode = "{{orderItem.orgCode}}" storeName="{{orderItem.storeName}}">{{include(\'d6\', orderItem)}}<div class="n1">{{if orderItem.orderListShowTrack == 1 && orderItem.orderStateMap}} {{include(\'d7\')}} {{/if}}<div class="n3 {{if orderItem.orderListShowTrack == 1 && orderItem.orderStateMap}} n4{{/if}}">{{if orderItem.orderListShowTrack == 1 && orderItem.orderStateMap}} {{include(\'d8\', orderItem)}} {{/if}} {{include(\'da\', {$value: orderItem, productList: orderItem.productList || orderItem.orderProductList || []})}} {{include(\'d9\', orderItem)}}</div></div></li>',
"d6":'<h2 class="my a2 {{if isWaimaiOrder == 0}}goToShop{{/if}}"><span class="mz {{if isWaimaiOrder == 0 && storeName}}goToShop{{/if}}">{{storeName}}</span>{{if isWaimaiOrder != 1 && storeName}}<i class="iconfont kt"></i>{{/if}} {{if mainOrderStateMap}}<span class="n0" style="color:{{mainOrderStateMap.orderColor}}">{{mainOrderStateMap.orderStateName}}</span>{{/if}}</h2>',"d7":'<div class="n2"></div>',
"d8":'<div class="np"><div class="nq"><h4 class="nr">{{orderStateMap.stateTitle}}<em class="nu">{{orderStateMap.stateTime || "14:54"}}</em></h4><p class="ns">{{orderStateMap.stateDesc}} {{if orderStateMap.specialFlag == 10}}<a class="ou" href="#refundDetail/orderId:{{orderId}}" onclick=\'lg("user_action","1.0",{"clickid":"refund_detail", "order_id": {{orderId}}})\'>{{orderStateMap.hrefContent || \'查看退款详情\'}}</a>{{/if}} {{if orderStateMap.functionNumber}}<a class="n5 nm" clstag="pageclick|keycount|orderlist_call__20160908|1" href="tel:{{orderStateMap.functionNumber}}"></a>{{/if}}</p><i class="n5 n6 iconState{{orderStateMap.stateIcon}}"></i></div>{{if isSowMap == 1}}<div class="q1"><img class="q2" clstag="pageclick|keycount|order_list_map_click_20160713|1"></img></div>{{/if}}</div>',
"d9":'<div class="nw h"><div class="order-shouldpay">{{dateSubmitStr}}</div><div class="order-pay-link">{{if showPay == 1}}<a class="o2 pay" venderId="{{venderId || orgCode}}" tradeName="{{(productList || orderProductList)[0].name}}" isGroup="{{isGroup}}" clstag="pageclick|keycount|order_detail_pay_20160623_1|1">{{payButtonName || "去支付"}}<span class="pay-time-left" orderId="{{orderId}}"></span></a>{{/if}} {{if isShowRefundInfo == 1}}<a class="order-pingjia-list-button" href="#refundDetail/orderId:{{orderId}}" onclick=\'lg("user_action","1.0",{"clickid":"refund_detail_btn", "order_id": {{orderId}}})\'>查看退款</a>{{/if}} {{if commentStatus == 2}}<a class="order-pingjia-list-button" href="#pingjia/orderId:{{orderId}}/storeId:{{storeId}}">去评价</a>{{else if commentStatus == 4}}<a class="order-pingjia-list-button" href="#pingjia/orderId:{{orderId}}/storeId:{{storeId}}/editComment:true">修改评价</a>{{/if}} {{if rePurchaseSwitch == 1 && !(rePurchaseSwitch == 1 && commentStatus == 2 && isShowRefundInfo == 1 && $14())}}<a href=\'javascript:void(0)\' class="py J_order_fugou" onclick=\'lg("user_action","1.0",{"clickid":"again_buy", "order_id": {{orderId}}})\'>再次购买</a>{{/if}}</div></div>',
"da":'<div class="nv {{if isDetail}}h a2{{/if}}">{{if $value && $value.isWaimaiOrder == "1"}}<div class="nx"><img class="ny" src="{{img || \'//static-o2o.360buyimg.com/daojia/new/images/show_default.png\'}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'></div><div class="nx o1"></div>{{else}} {{each productList}} {{if $index< 4 && !($index == 3 && $14())}}<div class="nx"><img class="ny" src="{{$value.imgPath || \'//static-o2o.360buyimg.com/daojia/new/images/notfound.png\'}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'></div>{{else if ($index == 4 && !$14()) || ($index == 3 && $14())}}<div class="nx o1"></div>{{/if}} {{/each}} {{/if}} {{if $value}}<span class="o0" {{if $value.deliveryType == 1}}style="top:16px;"{{/if}}>{{$value.productTotalPrice}}</span>{{if $value.deliveryType == 0}} {{include("h5",{text:$value.deliveryTypeDesc})}} {{else if $value.deliveryType == 2}}<span class="kh ki"><span class="da">{{$value.deliveryTypeDesc}}</span></span>{{else if $value.deliveryType == 4}}<span class="kh kj"><span class="da">{{$value.deliveryTypeDesc}}</span></span>{{/if}} {{/if}}<span class="nz" {{if $value && $value.deliveryType == 1}}style="bottom:25px;" {{else if isGroup}}style="bottom: initial;"{{/if}}>{{productTotalNumStr || $value.productTotalNumStr}} {{if !$value}}<i class="iconfont kt oa"></i>{{/if}}</span>{{if isGroup}}<a class="pu" href="#tuanDetails/groupId:{{groupId}}">查看拼团详情&nbsp;<i class="iconfont kt oa"></i></a>{{/if}}</div>',
"db":'<div class="scrolling order-scrolling mw">{{include("dc")}} {{if orderStateMap}} {{include("dd")}} {{/if}} {{if storeName}}<h2 class="og {{if isWaimaiOrder == 0 && storeName}}goToShop{{/if}}" storeId="{{storeId}}" orgCode="{{orgCode}}" storeName="{{storeName}}" tap>{{storeName}} {{if isWaimaiOrder == 0}}<i class="iconfont kt oa"></i>{{else if isWaimaiOrder == 1}}<span class="nz">{{productTotalNumStr}}</span>{{/if}}</h2>{{/if}}<div class="o8">{{if isWaimaiOrder == 1}} {{include("account-productInfo-tpl", {isWaimai: true, productList: orderProductList})}} {{else}} {{include("da", {productList: orderProductList || [],isDetail: true, isGroup: isGroup, groupId: groupId, productTotalNumStr: productTotalNumStr})}} {{/if}} {{include("de")}}</div>{{if servicePromiseList}} {{include("dg", {infoList: servicePromiseList, orderId: orderId})}} {{/if}} {{if myCommentList}}<a class="ob" href="#pingjia/orderId:{{orderId}}/storeId:{{storeId}}">{{myCommentList[0] && myCommentList[0].title || "我的评价"}}<i class="iconfont kt oa"></i></a>{{/if}} {{if deliveryInfoList}} {{include("dh", {infoList: deliveryInfoList, orderId: orderId})}} {{/if}} {{if orderInfoList}} {{include("dh", {infoList: orderInfoList, orderId: orderId})}} {{/if}} {{include("dl")}}',
"dc":'{{if preDeliveryTimeStr}}<p class="nc a2"><i class="n5 ne"></i>{{preDeliveryTimeStr}}</p>{{/if}}',"dd":'<div class="nt"><div class="nr"><i class="n5 iconState{{orderStateMap.stateIcon}}"></i>{{orderStateMap.stateTitle}}&nbsp; {{if orderStateMap.functionNumber}}<a class="n5 nm" clstag="pageclick|keycount|orderdetail_call__20160908|1" href="tel:{{orderStateMap.functionNumber}}"></a>{{/if}}<span class="nu">{{orderStateMap.stateTime}}</span></div><div class="o3">{{if orderStateMap.specialFlag == 20 && !$95()}} 感谢您使用京东到家 {{else}} {{orderStateMap.stateDesc}}{{/if}} {{if orderStateMap.specialFlag == 10}}<a class="ou" href="#refundDetail/orderId:{{orderId}}" onclick=\'lg("user_action","1.0",{"clickid":"refund_detail", "order_id": {{orderId}}})\'>{{orderStateMap.hrefContent || \'查看退款详情\'}}</a>{{else if orderStateMap.specialFlag == 20 && $95()}}<br><a class="ov" href="{{$93(orderStateMap.hrefUrlOfH5)}}" onclick=\'lg("user_action","1.0",{"clickid":"encourage_dada", "order_id": {{orderId}}, "store_id": {{storeId}}})\'>{{orderStateMap.hrefContent}}</a>{{/if}}</div><span class="o4 iconfont kt">更多状态</span>{{if isSowMap == 1}}<div class="q1"><img class="q2" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\' clstag="pageclick|keycount|order_detail_map_click_20160713|1"></div>{{/if}}</div>',
"de":'<div class="pq">{{if priceInfoList}} {{include("df", {moneyInfoList: priceInfoList, shouldPay: shouldPay})}} {{/if}} {{if promotionInfoList}} {{include("df", {moneyInfoList: promotionInfoList, discountPrice: discountPrice})}} {{/if}}</div><p class="o5 a2"><em class="order-detail-count-detail">{{orderShowTitles.shouldPayTitle}}&nbsp;<i>{{shouldPay}}</i>{{if discountPrice}} &nbsp;{{orderShowTitles.discountPriceTitle}}&nbsp;<i>{{discountPrice}}</i>{{/if}}</em><span class="o6">{{orderShowTitles.realPayTitle}}<i>{{realPay}}</i></span></p><p class="o7">查看更多&nbsp;<i class="iconfont kt oa"></i></p>',
"df":'<div class="ij pp a2">{{each moneyInfoList}}<p class="dv "><em>{{if $value.flagTitle}}<i class="tag ik" style="background:{{$value.flagColor}}">{{$value.flagTitle}}</i>{{/if}}<strong class="du">{{$value.title}}</strong>{{if ($value.childMoneyList && $value.childMoneyList.length >0) || $value.titleTipValue}} {{if $value.titleFlag == 0}}<a href="{{$value.titleTip}}" class="io"></a>{{else}}<i class="io" freightRule="{{$value.titleTipValue}}" totalMoney="{{$value.value}}" titleTipTitle="{{$value.titleTipTitle}}" childMoneyList=\'{{$33($value.childMoneyList)}}\' clstag="pageclick|keycount|click_freight_fee_20160623_1|1"></i>{{/if}} {{/if}}</em><span {{if $value.color}} style="color:{{$value.color}}" {{/if}}>{{$value.value}}</span></p>{{/each}}</div>',
"dg":'<h2 class="oc">{{infoList[0].title}}</h2><div class="od">{{each infoList}} {{if $index >0}}<a href="{{$value.activityUrl}}" onclick=\'lg("user_action","1.0",{"clickid":"medal_store","order_id": {{orderId}}, "type": "3"})\' class="qf"><img class="qg" src="{{$value.iconUrl}}"><span class="qh">{{$value.value}}</span><label class="qi" style="color: {{$value.activityColor}}">{{$value.activityDesc}}</label><i class="iconfont kt oa"></i></a>{{/if}} {{/each}}</div>',
"dh":'<h2 class="oc">{{infoList[0].title}}</h2><div class="od">{{each infoList}} {{if $index >0}}<p {{if $index >1}}class="h"{{/if}} {{if $value.activityUrl && $value.activityDesc}} payForDelay="{{$value.activityUrl}}" {{else if $value.activityUrl && $95()}} payForDelay="{{$93($value.activityUrl)}}" {{/if}} {{if $value.activityDesc}} clstag="pageclick|keycount|order_overtime_payment_20160908|1" {{else if $value.activityUrl && $95()}} onclick=\'lg("user_action","1.0",{"clickid":"click_deliver","order_id": {{orderId}}, "type": "2"})\' {{/if}} ><label>{{$value.title}}</label>{{if orderId == $value.value}}<input class="copy-orderid-input" type="text" value="{{$value.value}}" readonly /><span class="of" clstag="pageclick|keycount|orderdetail_copy_20161013|1">复制</span>{{else}} {{if $value.iconUrl}}<img class="pb" src="{{$value.iconUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'>{{/if}} {{if $value.valueFlag == 1}} {{include("h5",{text:$value.value})}} {{if $value.activityDesc}} &nbsp;&nbsp;<span style="color: {{$value.activityColor}}">{{$value.activityDesc || "时效保证, 超时赔付"}}</span>{{/if}} {{else}}<span style="{{if $value.iconUrl}}vertical-align: middle;{{/if}}{{if $value.valueOperate}}padding-right: 40px;white-space: nowrap;text-overflow: ellipsis;overflow: hidden;{{/if}}">{{=$value.value}}{{if $value.mobile}}&nbsp&nbsp{{$value.mobile}}{{/if}}</span>{{/if}} {{/if}} {{if $value.valueOperate}}<span class="oe" titleNodeList=\'{{$33($value.titleNodeList)}}\' clstag="pageclick|keycount|seeinvoice|1" >{{$value.valueOperate}}</span>{{/if}} {{if ($value.activityUrl && $value.activityDesc) || ($value.activityUrl && $95())}}<i class="iconfont kt oa"></i>{{/if}}</p>{{/if}} {{/each}}</div>',
"di":'<div id=\'order-detialNew-status-content\'><div class="oo"><div class=\'p1\'><span class="p2"></span><span class="p3"></span><span class="p3"></span>{{each orderStateList}}<div class="op"><i class="n5 n7 {{if $index != 0}}order-state-grey-icon{{else}}iconState{{/if}}{{$value.stateIcon}}"></i><span class="firstLine"></span><div class="or"><span class="oq">{{$value.stateTitle}}</span><span class=\'os\'>{{$value.stateTime}}</span></div><div class="ot">{{if $value.specialFlag == 20 && !$95()}} 感谢您使用京东到家 {{else}} {{$value.stateDesc}}{{/if}} {{if $value.specialFlag == 10}}<a class="ou" href="#refundDetail/orderId:{{orderId}}" onclick=\'lg("user_action","1.0",{"clickid":"refund_detail", "order_id": {{orderId}}})\'>{{$value.hrefContent || \'查看退款详情\'}}</a>{{else if $value.specialFlag == 20 && $95()}}<br><a class="ov" href="{{$93($value.hrefUrlOfH5)}}" onclick=\'lg("user_action","1.0",{"clickid":"encourage_dada", "order_id": {{orderId}}, "store_id": {{storeId}}})\'>{{$value.hrefContent}}</a>{{/if}}</div>{{if $value.functionNumber}}<a class="n5 nm" href="tel:{{$value.functionNumber}}"></a>{{/if}} {{if $value.isShowStaticMap == 1}}<div class="q1"><img class="q2" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\' clstag="pageclick|keycount|order_status_map_click_20160713|1" src="{{$value.imgUrl}}"></div>{{/if}} {{if $value.imgUrl}}<div class="q3">{{if $value.hrefUrlOfH5}}<a href="{{$value.hrefUrlOfH5}}" onclick=\'lg("user_action","1.0",{"click_id":"invite_bonus_201605163","order_id":{{orderId}}})\' ><img class="q4" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\' src="{{$value.imgUrl}}"></a>{{else}}<img class="q4" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\' src="{{$value.imgUrl}}">{{/if}}</div>{{/if}}</div>{{/each}}</div></div>{{if preDeliveryTimeStr}}<p class="nd a2"><i class="n5 ne"></i>{{preDeliveryTimeStr}}</p>{{/if}} {{include("dl")}}</div>',
"dj":'{{if contactList}}<a href=\'javascript:void(0)\' class="ox phone-service" orderService clstag="pageclick|keycount|order_detail_connect_20160623_1|1"><i class="n5 ng"></i>电话</a>{{/if}}',"dk":'{{if afsSwitch == 1}}<a href=\'javascript:void(0)\' class="ox phone-service oy" afterSales><i class="n5 order-service"></i>售后</a>{{/if}}',"dl":'<div class=\'ow\'>{{if deleteSwitch == 1 && complaintSwitch == 1}}<div class="no"><p orderService><i class="nf"></i>电话</p><p complaint><i class="nf nk"></i>投诉</p>{{if afsSwitch == 1}}<p afterSales><i class="nf nl"></i>售后</p>{{/if}}</div><a href=\'javascript:void(0)\' class="ox order-btn-more" btnMore><i class="nn"></i>更多</a><button class="ox J_order_delete oy" orderRemove><i class="n5 nh"></i>删除</button>{{else if complaintSwitch == 1}} {{include("dj")}}<button class="ox oy" complaint orgCode="{{orgCode}}" storeName="{{storeName}}" storeId="{{storeId}}"><i class="n5 ni"></i>投诉</button>{{include("dk")}} {{else if deleteSwitch == 1}} {{include("dj")}}<button class="ox J_order_delete oy" orderRemove><i class="n5 nh"></i>删除</button>{{include("dk")}} {{else}} {{include("dj")}} {{include("dk")}} {{/if}} {{if cancelSwitchNew != 0}}<button class="oz cancel {{if orderState == 20030}}disabled{{/if}}" clstag="pageclick|keycount|order_detail_cancel_20160623_1|1" tap>{{cancelButtonName || \'取消订单\'}}</button>{{/if}} {{if showPay == 1}}<button class="oz pay" clstag="pageclick|keycount|order_detail_pay_20160623_1|1" tap>{{payButtonName || "去支付"}}<span class="pay-time-left" orderId="{{orderId}}"></button>{{/if}} {{if isShowRefundInfo == 1}}<a class="oz" href="#refundDetail/orderId:{{orderId}}" onclick=\'lg("user_action","1.0",{"clickid":"refund_detail_btn", "order_id": {{orderId}}})\'>查看退款</a>{{/if}} {{if commentStatus == 2}}<a class="oz" href="#pingjia/orderId:{{orderId}}/storeId:{{storeId}}">去评价</a>{{else if commentStatus == 4}}<a class="oz" href="#pingjia/orderId:{{orderId}}/storeId:{{storeId}}/editComment:true">修改评价</a>{{/if}} {{if rePurchaseSwitch == 1 && !(rePurchaseSwitch == 1 && commentStatus == 2 && isShowRefundInfo == 1 && receiveConfirm == 1 && isWaimaiOrder == 0)}}<a href=\'javascript:void(0)\' class="oz order-detail-fugou-button J_order_fugou" orgCode="{{orgCode}}" orderId="{{orderId}}" storeId="{{storeId}}" onclick=\'lg("user_action","1.0",{"clickid":"again_buy", "order_id": {{orderId}}})\'>再次购买</a>{{/if}} {{if receiveConfirm == 1 && isWaimaiOrder == 0}}<button class="oz" receiveConfirm clstag="pageclick|keycount|order_unreceived_click_20160713|1">货未收到</button>{{/if}} {{if urgeOrder && urgeOrder.show == 1}}<button class="oz" urgeOrder style="color:{{urgeOrder.color}}" clstag="pageclick|keycount|order_urgeorder_click_20160713|1">{{urgeOrder.content || \'催单\'}}</button>{{/if}}</div>',
"dm":'<div class="cancelOrderWrapper"><div class="cancelOrderDesc"><p class="cancelOrderTitle">{{title}}</p><p class="cancelOrderTel" tap>{{=tel}}</p><p class="q0" tap>取消</p></div></div>',"dn":'<div class="cancelOrderWrapper"><div class="cancelOrderDesc">{{each contactList}} {{if $value.code == \'100\'}} {{if $65(isJDAPP).kefu != "javascript:void(0)"}}<p class="pz"><a href=\'{{$65(isJDAPP).kefu}}\' onclick=\'lg("user_action","1.0",{"clickid":"click_call","type":"{{$index+1}}"})\' >{{$value.text}}</a></p>{{/if}} {{else}}<p class="pz"><a href="tel:{{$value.phoneNum}}" onclick=\'lg("user_action","1.0",{"clickid":"click_call","type":"{{$index+1}}"})\'>{{$value.text}}</a></p>{{/if}} {{/each}}<p class="q0" tap>取消</p></div></div>',
"do":'<a class="pc" clstag="pageclick|keycount|share_hb_201604261|1"><img src="//static-o2o.360buyimg.com/daojia/new/images/shareHongbao/faHongbao_0129.png" /></a>',"dp":'<div class="pn"><div class="po"></div></div>',"dq":'{{if result==\'failure\'}}<div class="oj" style="min-height:{{$29()}}px"><div class="oi failure"><p>{{if failtype==\'pay\'}}支付{{else}}下单{{/if}}失败了！</p><a href="#index" class="toindex"><i>回首页</i></a>{{if failtype==\'pay\'}}<a href="#orderlist"><i>{{if settleType == 1}}查看需求单{{else}}查看订单{{/if}}</i></a>{{/if}}</div></div>{{else}}<div class="oj orderSuccess" style="min-height:{{$29()}}px"><div class="oi success"><div class="orderDes"><h3>{{if settleType == 1}}需求单提交成功！{{else}}订单支付成功！{{/if}}</h3><div class="orderInfo"><p>支付方式：{{$25(data.paymentType)}}</p><p>支付金额：{{data.realPay}}</p><p class="ol" style="display: none;"><em class="om"></em>关注&nbsp;&nbsp;<label>{{data.storeName}}</label></p><p class="qn" style="display: none;"></p></div></div><div class="orderLink"><a href="#index" class="toindex"><i>逛逛首页</i></a><a href="#orderlist"><i>{{if settleType == 1}}查看需求单{{else}}查看订单{{/if}}</i></a></div><div class="jdCoupon"><p class="qo">恭喜您已获得</p><p class="qp"><span></span>元京东支付券</p></div></div>{{if isJDApp}}<img class="p6" src="//static-o2o.360buyimg.com/daojia/new/images/order/jdapp_guide.png" />{{else}}<ul class="p5"></ul>{{/if}}</div>{{/if}}',
"dr":'<div class="pd"><div class="pg"><div class="pi"><p class="pj">{{activityPeriodLimitTimes}}&nbsp;个<p><h3 class="pk">拼手气红包</h3><p class="pl">最高可得15元，可抵扣在线支付金额<p><a class="pm" clstag="pageclick|keycount|share_hb_201604261|2"></a></div><a class="ph"></a></div></div>',"ds":'<div class="q5"></div><i class="n5 n8 n9" clstag="pageclick|keycount|back_map_click_20160713|1"></i><i class="n5 n8 na" clstag="pageclick|keycount|refresh_map_click_20160713|1"></i><i class="n5 n8 nb" clstag="pageclick|keycount|instruction_map_click_20160713|1"></i>',
"dt":'{{each $data}} {{if $index!=0}}<div class="a9n"></div>{{/if}}<div class="a9e" style="padding-bottom:0;position:relative;">{{$value.refundAmountText}}：<span style="position:absolute;right:24px;top:22px;"><i style="color:red">￥</i><em style="color:red">{{$36($value.refundAmountDes)}}</em></span></div>{{if $value.refundDetailList&&$value.refundDetailList.length}}<ul class="" style="position:relative;font-size:12px;color:#999;margin: 0px 25px 0px 25px; padding:7px 0; border-radius:4px;background-color:#f4f4f4;">{{each $value.refundDetailList}}<li style="position:relative;line-height:28px;padding-left:10px;{{if !$value.text}}padding-right:0;{{/if}}">{{$value.name}} {{if $value.text}}<span style="position:absolute;right:10px;top:0;">{{$value.text}}</span>{{/if}}</li>{{/each}}<span style="width:0;height:0;overflow:hidden;position:absolute;right:30px; top:-5px; border-left: 5px solid transparent; border-right: 5px solid transparent;border-bottom: 6px solid transparent;border-bottom-color: #f4f4f4;"></span></ul>{{/if}}<ul class="a9e" style="padding-top:0;"><li>退回账户：<span class="a9f">{{$value.payModeName}}</span></li><li>退款进度：<span class="a9f">{{$value.refundSchedule}}</span></li></ul><ul class="a9g">{{each $value.refundNodeList as $v $i}}<li class="a9h {{$71($v.refundNodeExecuteStatus)}}"><h4 class="a9i">{{$v.refundNodeName}}</h4><p class="a9j">{{$v.refundNodeTime}}</p>{{if $v.refundNodeDes}}<p class="a9k">{{$v.refundNodeDes}}<p>{{/if}}<i class="a9l"></i>{{if $i<($value.refundNodeList.length-1)}}<i class="a9m"></i>{{/if}}</li>{{/each}}</ul>{{/each}}',
"du":'<div class="mm" style="height: {{$29()}}px;"><textarea class="mo" placeholder="请填写备注信息，最多30字" maxLength=\'150\'>{{remark}}</textarea><a class="mp" href="javascript:void(0)">保存</a></div>',"dv":'<div class="k2"><div class="k1"><img src="//static-o2o.360buyimg.com/daojia/new/images/pay/icon-pay-succ.png" /><span class="title">支付成功</span><span class="desc">VIP会员有效期内，您将享受京东到家VIP会员尊贵特权。</span></div><a href="{{$13(\'/html/index.html#vip\')}}">查看我的会员</a></div>',
"dw":'<div class="h8">{{if result && result.commentOrderType}} {{if result.commentOrderType == \'1\'}}<div class="h9">{{if result.deliveryModifyFlag == \'0\' && editComment}}<div class="ha"></div>{{/if}}<ul class="hb"><li class="hc"><div class="hd"><img src="{{if result.carrier == \'9966\'}}//static-o2o.360buyimg.com/daojia/new/images/comment/dada-header.png{{else}}//static-o2o.360buyimg.com/daojia/new/images/comment/shangjia-header.png{{/if}}" class="pic" /></div><dl>{{if result.deliveryTypeDesc}}<dt>{{result.deliveryTypeDesc}}</dt>{{/if}}<dd><div class="times">{{if result.preDeliveryTimeDesc}}{{result.preDeliveryTimeDesc}}{{/if}}<span class="he">{{if result.preDeliveryTimeStr}}{{result.preDeliveryTimeStr}}{{/if}}</span></div>{{if result.dates && result.dates.length >0}}<span class="hf" onclick=\'lg("user_action","1.0",{"clickid":"evaluate_time_20161013","order_id":"{{result.orderId}}"})\'>时间不对？</span>{{/if}}</dd></dl></li>{{if result.shopDeliveryScoreName}}<li class="hg"><div class="hh"><span class="fontTitle" data-type="peisong">{{result.shopDeliveryScoreName}}</span><i class="star"></i><i class="star"></i><i class="star"></i><i class="star"></i><i class="star"></i><span class="hi"></span></div>{{if result.tagContentMap}}<div class="hj"></div>{{/if}}</li><li class="hl"><textarea class="ho" placeholder="写下对配送员的评价吧～" data-type="写下对配送员的评价吧～" data-value="peisongArea" maxlength="100"></textarea></li>{{/if}}</ul></div><div class="h9">{{if result.productModifyFlag == \'0\' && editComment}}<div class="ha"></div>{{/if}}<ul class="hb"><li class="hc"><div class="hd"><img src="{{result.storeImgUrl || \'//static-o2o.360buyimg.com/daojia/new/images/comment/shangjia-header.png\'}}" class="pic"></div>{{if result.storeName}}<dl><dt class="shangjia">{{result.storeName}}</dt></dl>{{/if}}</li>{{if result.productCommentContent && result.oldCommentContentTip && editComment && result.productServiceScore< 3}}<li class="commentContent">{{result.oldCommentContentTip}}<br />{{result.productCommentContent}}</li>{{/if}} {{if result.productScoreName}}<li class="hg"><div class="hh"><span class="fontTitle" data-type="shangpin">{{result.productScoreName}}</span><i class="star"></i><i class="star"></i><i class="star"></i><i class="star"></i><i class="star"></i><span class="hi"></span></div>{{if result.productServiceTagContentMap}}<div class="hj"></div>{{/if}}</li><li class="hl"><textarea class="ho" placeholder="写下您对商家的评价吧～" data-type="写下您对商家的评价吧～" data-value="shangpinArea" maxlength="100"></textarea></li>{{if result.orderProductList && result.orderProductList.length >0}}<li class="hp">{{each result.orderProductList}} {{if $value.name}}<div class="list" data-sku="{{$value.sku}}" data-orderId="{{$value.orderId}}"><div class="hq">{{$value.name}}</div><span class="hr haoPing {{if $value.upVote == 1 && editComment}}haoPingActive{{/if}}"></span><span class="hr chaPing {{if $value.upVote == 0 && editComment}}chaPingActive{{/if}}"></span></div>{{/if}} {{/each}}</li>{{/if}} {{/if}}</ul></div>{{if editComment}}<div class="hv">{{if result.modifyCommentTip1}}{{result.modifyCommentTip1}}{{/if}}<br>{{if result.modifyCommentTip2}}{{result.modifyCommentTip2}}{{/if}}</div>{{/if}} {{else if result.commentOrderType == \'2\'}}<div class="h9">{{if result.productModifyFlag == \'0\' && editComment}}<div class="ha"></div>{{/if}}<ul class="hb"><li class="hc"><div class="hd"><img src="{{result.storeImgUrl || \'//static-o2o.360buyimg.com/daojia/new/images/comment/shangjia-header.png\'}}" class="pic"></div>{{if result.storeName}}<dl><dt class="shangjia">{{result.storeName}}</dt><dd><div class="times">{{result.preDeliveryTimeDesc}}<span class="he">{{result.preDeliveryTimeStr}}</span></div><span class="hf" onclick=\'lg("user_action","1.0",{"clickid":"evaluate_time_20161013","order_id":"{{result.orderId}}"})\'>时间不对？</span></dd></dl>{{/if}}</li>{{if result.productCommentContent && result.oldCommentContentTip && editComment && result.productServiceScore< 3}}<li class="commentContent">{{result.oldCommentContentTip}}<br />{{result.productCommentContent}}</li>{{/if}} {{if result.productScoreName}}<li class="hg"><div class="hh"><span class="fontTitle" data-type="shangpin">{{result.productScoreName}}</span><i class="star"></i><i class="star"></i><i class="star"></i><i class="star"></i><i class="star"></i><span class="hi"></span></div>{{if result.productServiceTagContentMap}}<div class="hj"></div>{{/if}}</li><li class="hl"><textarea class="ho" placeholder="写下您对商家的评价吧～" data-type="写下您对商家的评价吧～" data-value="shangpinArea" maxlength="100"></textarea></li>{{if result.orderProductList && result.orderProductList.length >0}}<li class="hp">{{each result.orderProductList}} {{if $value.name}}<div class="list" data-sku="{{$value.sku}}" data-orderId="{{$value.orderId}}"><div class="hq">{{$value.name}}</div><span class="hr haoPing {{if editComment && $value.upVote == 1}}haoPingActive{{/if}}"></span><span class="hr chaPing {{if editComment && $value.upVote == 0}}chaPingActive{{/if}}"></span></div>{{/if}} {{/each}}</li>{{/if}} {{/if}}</ul></div>{{if editComment}}<div class="hv">{{if result.modifyCommentTip1}}{{result.modifyCommentTip1}}{{/if}}<br>{{if result.modifyCommentTip2}}{{result.modifyCommentTip2}}{{/if}}</div>{{/if}} {{/if}} {{/if}}<div class="commentListUploadImage"></div></div><div class="hs">{{if editComment}}确认修改{{else}}提交评价{{/if}}</div>',
"e4":'<div class="a7u"><div class="a7v"><div class="a7w"><img src="{{if his}}//static-o2o.360buyimg.com/daojia/new/images/redPacket/coupons_banner_get.png{{else}}//static-o2o.360buyimg.com/daojia/new/images/redPacket/coupons_banner.png{{/if}}" alt="优惠券已领取" width="100%"><ul class="a7x">{{if couponList && couponList.length}} {{each couponList as coupon}}<li class="hy bg {{if coupon.to == \'none\'}}quanchang{{/if}} {{if coupon.state==2}}coupon-item-used2{{/if}}" {{if coupon.to != \'none\'}}href="{{$15(coupon.to,coupon.params,"","",coupon.params&&coupon.params.limitId)}}"{{/if}}><div class="a8o"><div class="a80"><span>{{coupon.amount}}</span><em>{{coupon.amountUnit}}</em></div><div class="a8p"><p class="a81">{{coupon.couponTitle}}</p><p class="a82"><span>{{coupon.couponTypeDesc}}</span><em>{{coupon.limitRule}}</em></p><p class="a83">{{coupon.avilableDate}}</p></div><div class="a84 {{if coupon.to == \'none\'}}quanchang{{/if}}">{{if coupon.state !=2}}<a>使用</a>{{else}}<a>已使用</a>{{/if}}</div></div>{{if coupon.state==2}}<span class="a85"></span>{{/if}}</li>{{/each}} {{/if}}</ul><a href="javascript:;" class="a7y"></a></div><a href="javascript:;" class="a7z"></a></div></div>',
"e5":'{{each $data.youhuiquanList}}<li class="a86 {{$27($value.state)}} {{$26($value.use)}}" couponCode="{{$value.couponCode}}" quandata=\'{{$33($value)}}\'><a class="a87" {{if $value.to && $value.params && $value.state == 1}}href="{{$15($value.to,$value.params,"","",$value.params.limitId)}}" onclick="lg(\'user_action\', \'1.0\', {\'click_name\':\'use_coupons\',\'coupon_id\':\'{{$value.couponCode}}\'});"{{/if}}><div class="a89"><span>{{$value.amount}}</span><em>{{$value.amountUnit}}</em></div><div class="a8a"><p class="a8b">{{$value.couponTitle}}</p><p class="a8c"><span>{{$value.couponTypeDesc}}</span><em>{{$value.limitRule}}</em></p><p class="a8d">{{$value.avilableDate}}</p></div><i class="couponSelect {{if $data.currentValue && $value.couponCode == $data.currentValue.couponCode}}a8e{{/if}}"></i>{{if $value.expireTag == \'0\'}}<i class="a8f">即将过期</i>{{/if}} {{if $value.to && $value.params && $value.state == 1}}<i class="a8g"></i>{{/if}}<i class="i2"></i>{{if $value.couponCode == addItemVoucherCode && addItemNoticeTwo}}<i class="a88">{{addItemNoticeTwo}}</i>{{/if}}</a>{{if $value.unavailableReason}}<div class="a8h"><div class="a8i"><p class="a8j" couponId="{{$value.couponCode}}">不可用原因</p><div class="a8m"><p class="a8k">{{=$value.unavailableReason}}</p><p class="a8l">{{=$value.unavailableReason}}</p><i class="a8n"></i></div></div></div>{{else if $value.couponDetail}}<div class="a8h"><div class="a8i"><p class="a8k">{{=$value.couponDetail}}</p><p class="a8l">{{=$value.couponDetail}}</p><i class="a8n"></i></div></div>{{/if}}</li>{{/each}}',
"eb":'<div class="wk {{if storeIndex}}hasCancel{{/if}}{{if cateIndex || searchResult}}noCancel{{/if}}"><i id="iconToSearch" class="wl wn"></i><input clstag="pageclick|keycount|home_search_20160623_1|1" type="search" style="max-width:90%" class="wr" id="store-keyword" placeholder="{{placeHolder}}" required="required"/><i id="iconToClear" class="a0d wn"></i></div>{{if storeIndex}}<a class="wh a0e">分类</a>{{/if}}<div class="wi" style="min-height:{{$29() - 44}}px;"></div>',
"ec":'<div class="wf a2"><div class="wk hasCancel"><i id="iconToSearch" class="wl wn"></i><input type="search" style="max-width:90%" class="wj" id="search-keyword" placeholder="{{placeHolder}}" required="required"/><i id="iconToClear" class="a0d wn"></i></div><a class="wg block" clstag="pageclick|keycount|allsearch_click_cancel_20160623_1|1"><i class="cancelBtn"></i></a><span class="wo">搜索</span></div>',
"ee":'<p class="xl">{{storeName}}</p><a class="ce cd" clstag="pageclick|keycount|store_searchbar_click_20160623_1|2"></a>',"eg":'<ul class="ve"><li><p class="vf"><i></i>请优先确认您的配送信息：订单详情页中查看配送方式；配送方式目前有：达达配送、商家自送（含第三方配送）。</p></li><li><p class="vf"><i></i>达达配送订单</p><p class="vg">1、如配送员已抢单则请您优先联系配送员（订单页可以找到配送员电话）；</p><p class="vg">2、如长时间没有配送抢单，为了减少您的等待时间，您可自行取消并改时间重新下单，或联系在线客服进行协调；</p></li><li><p class="vf"><i></i>商家自送订单</p><p class="vg">1、请联系商家或者第三方配送（订单页或者单品页可以找到商家电话）；</p></li></ul>',
"eh":'<ul class="ve"><li><p class="vf"><i></i>外卖、美食、鲜花、蛋糕订单</p><p class="vg">1、配送员取货前请联系商家协商；</p><p class="vg">2、定制类商品，配送员取货后不支持取消订单，请您理解；</p></li><li><p class="vf"><i></i>商家自送订单</p><p class="vg">1、请联系商家电话协商处理（订单页或者单品页可以找到商家电话；订单详情页中查看配送方式）；</p></li><li><p class="vf"><i></i>我要取消订单</p><p class="vg">1、配送员未取货：您可以在订单页面自行操作取消；</p><p class="vg">2、配送员已取货：无法取消订单，您可以尝试联系配送员协商，如是商家自送订单，建议联系商家沟通处理。</p></li><li><p class="vf"><i></i>误操作取消订单了，帮忙恢复下订单</p><p class="vg">1、订单一旦操作取消，则无法恢复和再次配送，请您理解；如有需要可重新下单；</p></li><li><p class="vf"><i></i>订单显示"已锁定"怎么办？</p><p class="vg">1、可能原因是，配送员无法联系到您，商品可能已经返回给商家了；请耐心等待商家确认审核；退款会在审核通过后进行退回</p></li><li><p class="vf"><i></i>为什么不能取消订单了？</p><p class="vg">1、如配送员已取货：则无法取消订单了；</p><p class="vg">2、如果是商家自送订单，建议联系商家沟通处理；</p></li></ul>',
"ei":'<ul class="ve"><li><p class="vf"><i></i>怎么申请售后？</p><p class="vg">自收到商品之日起七日内支持退货（生鲜易腐类、定制类、医药类等商品非质量问题一概不接受退换货，特殊标记“7天包退”店铺除外）</p><p class="vg">请您提供订单号、清晰的有问题的商品图片、说明售后原因；</p><p class="vg">申请售后方式如下：</p><p class="vg">1、自行申请：部分商品（48小时内）进入订单详情页左下角，点击“售后”入口自行提交售后申请，客服/ 商家会针对您的问题进行审核处理；</p><p class="vg">2、客服代申请：如无售后入口，请联系在线客服申请处理；</p></li></ul>',"ej":'<ul class="ve"><li><p class="vf"><i></i>钱什么时候给退（取消订单/售后退款/拒收退款/商家修改订单退款）？</p><p class="vg">订单审核通过后，系统会发起退款，到账周期参考如下：</p><p class="vg">1、银行卡支付退款周期为3-15个工作日；信用卡支付退款周期是1-15个工作日；</p><p class="vg">2、微信零钱支付退款时效为1-5个工作日；微信绑定银行卡支付退款时效为2-7个工作日；</p><p class="vg">3、白条支付：未还款的白条额度将在3到5个工作日自动恢复，分期服务费一起退回；已还白条款项会在3-15个工作日按您还款白条的方式原路退回，分期服务费不再退回；</p><p class="vg">此退款周期仅供您参考，具体退款周期可能受银行、支付机构等相关因素影响。</p></li><li><p class="vf"><i></i>钱退到哪里去了？</p><p class="vg">在线支付的订单，一般会按照原支付方式进行退款。</p></li><li><p class="vf"><i></i>为什么退款的金额跟我的订单金额不一致？</p><p class="vg">退款金额只退回该订单中您实际支付金额，</p><p class="vg">1、如您享受了优惠活动（例如，满减活动），则会按商品金额比例扣除享受的优惠金额，此部分优惠金额不会退回。</p><p class="vg">2、取消订单：会退货该订单的实际支付金额，该订单使用的优惠券会退回，在有效期内可以继续使用，如优惠码已被使用则不可再次使用；</p><p class="vg">3、售后退款/退货：会退回该商品的实际支持金额，优惠券和运费不会退回；</p></li></ul>',
"ek":'<ul class="ve"><li><p class="vf"><i></i>修改地址、收货时间（改天再送）、收货人、收货人电话</p><p class="vg">不支持修改，如订单提交错误，为快速解决您的问题，建议取消订单并重新下单；</p></li><li><p class="vf"><i></i>修改/增加备注（忘写备注了）</p><p class="vg">1、配送没有取货前可以优先联系下商家确认是否可以支持修改；</p><p class="vg">2、一旦配送员已取货，则无法再修改；</p></li></ul>',"el":'<ul class="ve"><li><p class="vf"><i></i>优惠券、优惠码为什么不能用？</p><p class="vg">可能存在情况，请您优先自行核实：</p><p class="vg">1、已经过期（使用期限可参见”我的-优惠券“中的说明，或者活动页中的“活动说明”）；</p><p class="vg">2、只是适用于部分活动商品，如无法使用，则您选择的商品可能不参加该活动；</p><p class="vg">3、兑换码需在“我的-优惠券-兑换码”中兑换成优惠券才可以使用；</p><p class="vg">4、优惠券不可叠加使用；</p></li><li><p class="vf"><i></i>取消订单/退货/退款的优惠券能不能退？</p><p class="vg">1、取消订单：该订单使用的优惠券会退回，在有效期内可以继续使用；</p><p class="vg">2、退货/退款：优惠券不会退回。</p></li></ul>',
"em":'<p class="is">选择收货地址</p><ul class="jg" {{if !needCheckDelivery || !hasNoDelivery}}style="margin-bottom: 50px;"{{/if}}>{{each addresslist}} {{if $value.canDelivery || !needCheckDelivery}} {{=include(\'en\', {value: $value, index: $index, addressId: addressId})}} {{/if}} {{/each}}</ul>{{if needCheckDelivery && hasNoDelivery}}<p class="jj">* 以下地址超出配送范围</p><ul class="jg over">{{each addresslist}} {{if !$value.canDelivery}} {{=include(\'en\', {value: $value, index: $index, over: true})}} {{/if}} {{/each}}</ul>{{/if}}<p class="it" clstag="pageclick|keycount|adresslist_adressnew_click_20160729">新建收货地址</p>',
"en":'<li class="{{if index != 0}}h{{/if}}" clstag="pageclick|keycount|{{if over}}settlement_adresslist_not_click_20160729{{else}}settlement_adresslist_ok_click_20160729{{/if}}">{{if addressId == value.id}}<i class="checked" {{if index == 0}}style="top: 0;"{{/if}}></i>{{/if}}<p class="jh" addressId="{{value.id}}">{{value.name}}&nbsp;&nbsp;&nbsp;&nbsp;{{value.mobile}}</p><p class="ji" addressId="{{value.id}}">{{if value.tags}}<i class="zi">{{value.tags==1?"家":(value.tags == 2?"公司":"学校")}}</i>{{/if}} {{value.fullAddress}}</p><i class="edit" addressId="{{value.id}}"></i></li>',
"eo":'<div class="settlement_goods_div scrolling"><p class="is">商品清单</p>{{each products}}<div class="ii a2" sku="{{$value.sku}}" store="{{$value.shopId}}"><img class="oh" src="{{$value.img || $value.imgPath}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'>{{if $value.type == 1203 || $value.promotionType == 1203 || $value.type == 6 || $value.promotionType == 6}}<em class="gift">{{$value.discountDescribe || "赠品"}}</em>{{else if $value.type == 1202 || $value.promotionType == 1202}}<em class="change">{{$value.discountDescribe || "换购"}}</em>{{/if}}<div><span>{{$value.name}}</span><br>{{if $value.promotionList && $value.promotionList.length >0}} {{if $value.promotionList.length == 1}}<br><p class="price">{{$value.promotionList[0].priceStr || \'¥\' + $value.promotionList[0].price / 100}}&nbsp;&nbsp;× {{$value.promotionList[0].quantity || $value.promotionList[0].num}}</p>{{else if $value.promotionList[0].promotionType != 1}}<p class="promotion">{{$value.promotionList[0].priceStr || \'¥\' + $value.promotionList[0].price / 100}}&nbsp;&nbsp;× {{$value.promotionList[0].quantity || $value.promotionList[0].num}}</p><p class="price">{{$value.promotionList[1].priceStr || \'¥\' + $value.promotionList[1].price / 100}}&nbsp;&nbsp;× {{$value.promotionList[1].quantity || $value.promotionList[1].num}}</p>{{else if $value.promotionList[1].promotionType != 1}}<p class="promotion">{{$value.promotionList[1].priceStr || \'¥\' + $value.promotionList[1].price / 100}}&nbsp;&nbsp;× {{$value.promotionList[1].quantity || $value.promotionList[1].num}}</p><p class="price">{{$value.promotionList[0].priceStr || \'¥\' + $value.promotionList[0].price / 100}}&nbsp;&nbsp;× {{$value.promotionList[0].quantity || $value.promotionList[0].num}}</p>{{/if}} {{else}} {{if $value.promotionPrice && !$value.memberIcon}}<p class="promotion">{{$value.promotionPriceStr}}&nbsp;&nbsp;× {{$value.promotionNum}}</p>{{else}}<br>{{/if}} {{if $value.memberIcon}}<p class="price">{{if $value.promotionPrice}} {{$value.promotionPriceStr}}&nbsp;&nbsp;× {{$value.promotionNum}}&nbsp; {{/if}}<span style="color: {{$value.color}}">{{$value.priceStr}}&nbsp; × {{$value.quantity || $value.num}}</span><img src="{{$value.memberIcon}}" style=\'width: 31px; height: 10px;\'/></p>{{else}}<p class="price">{{$value.priceStr}}&nbsp; × {{$value.quantity || $value.num}}</p>{{/if}} {{/if}}<em class="money">{{$value.totalPriceStr || \'¥\' + $value.money/100}}</em></div></div>{{/each}}</div>{{if provider == "shop"}}<a href="javascript:void(0)" class="it">修改购物清单</a>{{/if}}',
"ep":'<div class="kn kq {{if scrollTop< 50}}kp{{/if}} {{if !receiptAddress.data.addressVo && receiptAddress.data.type != \'4\' && receiptAddress.data.type != \'1\'}}no-address{{/if}}" clstag="pageclick|keycount|click_navigate|1" ><p class="ko" {{if !receiptAddress.data.addressVo}}style="text-align: center;"{{/if}} >{{if receiptAddress.data.addressVo}} {{receiptAddress.data.addressVo.addressName}} {{else}} {{if receiptAddress.data.type != \'4\'}}<i class="ky"></i>{{/if}}<span style="display: inline-block; vertical-align: middle;">{{receiptAddress.data.title}}</span>{{/if}}</p>{{if receiptAddress.data.addressVo}}<i class="iconfont kt"></i>{{/if}}</div><div class="km" {{if !bookInfo && !receiptAddress.data.addressVo}}style="padding-bottom: 50px;"{{/if}}>{{include("eq", receiptAddress.data)}} {{if bookInfo}} {{include("er", {bookInfoData: bookInfoData, type: receiptAddress.data.type})}} {{/if}}</div><div class="l1"><div class="l2" {{if selfAddress}}style="padding-bottom: 15px;"{{/if}}>{{if deliverType}} {{include("es", deliverType.data)}} {{/if}} {{include("et", {data: deliverTime.data, distributionType: distributionType, title: deliverTime.title})}} {{if selfAddress}} {{include("eu", selfAddress.data)}} {{/if}}</div><div class="ip">{{include("ev")}} {{if couponInfo}} {{include("ey")}} {{/if}} {{if platPoints && platPoints.data}} {{include("ez", {data: platPoints.data, usePlatPointsFlag: usePlatPointsFlag})}} {{/if}} {{include("f0")}}</div>{{if newVip}} {{include("f1", newVip.data)}} {{/if}} {{include("f2")}} {{if outOfStockConfig}} {{include("f4", {stockConfigContent: stockConfigContent || outOfStockConfig.data[0]})}} {{/if}}</div>{{if newVip && !vipHide}} {{include("f6", newVip.data)}} {{/if}}<div class="m3 m4" clstag="pageclick|keycount|to_order|1"><a class="m5" href="javascript:void(0)">{{submitInfo.data}}</a></div>',
"eq":'<div class="kr">{{if type == \'1\'}}<div class="ks kq"><i class="kw"></i><div class="ji"><p class="ku">{{addressVo.addressName}}</p><p><span class="kv">{{addressVo.name}}</span>{{addressVo.phone}}</p></div><i class="iconfont kt"></i></div>{{else}}<div class="kx {{if type != \'4\' && type != \'5\'}}no-address{{/if}}">{{if type != \'4\'}}<i class="ky"></i>{{/if}}<span style="display: inline-block;">{{title}}</span>{{if type == \'4\'}}<i class="iconfont kt eu"></i>{{/if}}</div>{{if desc}}<p class="tip">{{desc}}</p>{{/if}} {{/if}}</div>',
"er":'<div class="kq kz {{if type == \'1\'}}h{{/if}}" {{if type == \'1\'}}style="margin-top: 20px;"{{/if}} ><i class="l0"></i><input placeholder="订购人姓名" name="buyer_name" value="{{bookInfoData.buyerName}}" clstag="pageclick|keycount|orderuser|1"/><input name="buyer_mobile" placeholder="订购人电话" value="{{bookInfoData.buyerMobile || bookInfoData.initMobile}}" maxLength=\'11\' clstag="pageclick|keycount|orderphone|1" /></div>',
"es":'<div class="l3 kq a2"><p class="deliverType-title">配送方式</p><div class="l4 kq">{{each deliverTypeItemList}}<p class="l5 {{if $index == 0}}left{{else}}right{{/if}} {{if defaultType == $value.type}}selected{{/if}}" deliverTypeItem=\'{{$33($value)}}\'>{{$value.descText}}</p>{{/each}}</div></div>',"et":'<div class="kq l6" {{if distributionType == 2}}style="height: 40px;"{{/if}}>{{if distributionType == 1}}<p class="l7">达达专送</p>{{else if distributionType == 0}}<p class="l7" style="background: #999;">商家自送</p>{{else}}<p>{{title}}</p>{{/if}}<p class="lb">{{data.nonPushTimeText}} {{if data.offPeakTip}}<br><span style="color: {{data.offPeakTip.colorOne}}">{{data.offPeakTip.tipOne}}</span><span style="color: {{data.offPeakTip.colorTwo}}">{{data.offPeakTip.tipTwo}}</span>{{/if}}</p><i class="iconfont kt"></i></div>',
"eu":'<div class="ld">{{address + " " + storeName}}</div>',"ev":'<p class="le"><span class="text">{{storeName}}</span></p>{{include("ew", {data: productInfo.data, isSpread: isSpread, maxLength: maxLength})}}<div class="ll {{if isSpread}}up{{/if}}">共{{$49(productInfo.data)}}件{{if totalWeight}} / {{totalWeight}}kg{{/if}} {{if productInfo.data.length >2}}<i class="iconfont kt"></i>{{/if}}</div>{{include("ex", {data: moneyInfo.data, showFreightTip: showFreightTip})}} {{if disMoneyInfo && disMoneyInfo.data.length}} {{include("ex", disMoneyInfo)}} {{/if}}<div class="kq lm settlement-moneyInfo-coupon" style="margin-bottom: 14px;"><p>优惠券</p>{{if couponInfo.data && !couponInfo.data.promoteType}}<p class="coupon-discount">{{couponInfo.data.description}}</p>{{else if ((couponInfo.data.codeListSuccessFlag || codeListSuccessFlag) && (!couponInfo.data.voucherListVO || couponInfo.data.voucherListVO.length<= 0)) && (!voucherListVO || voucherListVO.length<= 0)}}<p class="coupon-discount">暂无优惠券</p>{{else if couponInfo.data.vouVO && couponInfo.data.vouVO.discountMoney}}<p style="color: #ff5757;" class="coupon-discount">-<i class="lk">¥</i>{{couponInfo.data.vouVO.discountMoney/100}}</p>{{/if}}</div>',
"ew":'<ul class="lf {{if isSpread}}more{{/if}}" {{if isSpread}}style="max-height: {{data.length * 70}}px"{{/if}} >{{each data}}<li class="kq lg"><img class="lh" src="{{$value.img}}"/>{{if $value.type == 1203 || $value.promotionType == 1203 || $value.type == 6 || $value.promotionType == 6}}<em class="gift">{{$value.discountDescribe || "赠品"}}</em>{{else if $value.type == 1202 || $value.promotionType == 1202}}<em class="change">{{$value.discountDescribe || "换购"}}</em>{{/if}}<div class="li"><p class="lj">{{$value.name}}</p><div class="kq">{{if $value.promotionList}} {{=$106($value.promotionList)}} {{else}}<div>{{if $value.promotePrice}}<span {{if $value.basicPrice || $value.memberPrice}}style="color: #ff5757"{{/if}}><i class="lk">¥</i>{{$value.promotePrice.price / 100}}×{{$value.promotePrice.quantity}}</span>{{if $value.basicPrice}}{{\' / \'}}{{/if}} {{/if}} {{if $value.basicPrice}}<span><i class="lk">¥</i>{{$value.basicPrice.price / 100}}×{{$value.basicPrice.quantity}}</span>{{/if}} {{if $value.memberPrice}}<span style="color: {{$value.memberPrice.priceColor}}">{{if $value.promotePrice}}{{\' / \'}}{{/if}}<i class="lk">¥</i>{{$value.memberPrice.price / 100}}×{{$value.memberPrice.quantity}}<img src="{{$value.memberPrice.priceIcon}}" style=\'width: 31px; height: 10px;\'/></span>{{/if}}</div>{{/if}}<div>{{if $value.storeMoney >$value.money && maxLength >3}}<span style="color: #999;text-decoration: line-through;padding-right: 5px;"><i class="lk">¥</i>{{$value.storeMoney / 100}}</span>{{/if}}<span><i class="lk">¥</i>{{$value.money / 100}}</span></div></div></div></li>{{/each}}</ul>',
"ex":'{{each data}}<div class="kq lm"><p>{{if $value.flagText}}<i class="tag ik" style="background:{{$value.flagColor}}">{{$value.flagText}}</i>{{/if}} {{$value.name}} {{if $value.childMoneyList && $value.childMoneyList.length >0}}<a class="io" childMoneyList=\'{{$33($value.childMoneyList)}}\' freight="{{$value.desc || $value.descText}}" totalMoney="{{$value.value}}" freighttitle="{{$value.title}}" href="javascript:void(0)" clstag="pageclick|keycount|deliveryexplain|1"></a>{{/if}}</p>{{if $value.value}}<p style="color: {{$value.color}}">{{=$37($value.value)}}</p>{{/if}}</div><div style="-webkit-transform: translateY(-22px); transform: translateY(-22px);">{{if $value.distanceFreightDesc}}<i class="iq">{{$value.distanceFreightDesc}}</i>{{/if}} {{if $value.periodFreightDesc}}<i class="iq">{{$value.periodFreightDesc}}</i>{{/if}} {{if $value.dynamicFreightDesc}}<i class="iq">{{$value.dynamicFreightDesc}}</i>{{/if}}</div>{{if $value.tipFeeNew && $value.tipFeeNew.feeTip}}<div class="kc" feeToastTip="{{$103($value.tipFeeNew.feeToast, showFreightTip)}}"><div class="freight-marginTop"><i class="kd"></i><span class="ke">{{$value.tipFeeNew.feeTip}}</span><i class="ka {{if $value.tipFeeNew.check}}checked{{/if}}"></i></div>{{if $value.tipFeeNew.tipFeeNewVOList}}<ul class="{{if !$value.tipFeeNew.check || $value.tipFeeNew.tipFeeNewVOList.length<= 1}}hide{{/if}}">{{each $value.tipFeeNew.tipFeeNewVOList}}<li class="freight-tip-tag {{if $value.check}}active{{/if}}" feeid="{{$value.feeId}}">{{$value.price}}</li>{{/each}}</ul>{{/if}}</div>{{/if}} {{/each}}',
"ey":'{{if couponInfo.data.promoteType && ((!(couponInfo.data.codeListSuccessFlag || codeListSuccessFlag) || ((couponInfo.data.codeListSuccessFlag || codeListSuccessFlag) && (couponInfo.data.voucherListVO || []).length >0)) || (voucherListVO && voucherListVO.length >0))}}<div class="lo"><div class="ln">{{if (couponInfo.data.codeListSuccessFlag === false || codeListSuccessFlag === false) && !voucherListVO}}<div class="lp"><p class="lq">查看优惠券</p>{{if couponInfo.data.vouVO && couponInfo.data.vouVO.addItemNoticeOne}}<br><p class="lz">{{couponInfo.data.vouVO.addItemNoticeOne}}</p>{{else}}<br><p class="lz" couponCount {{if !couponCount}} style="display: none;"{{/if}}>{{couponCount || 0}} 张可用</p>{{/if}}</div>{{/if}} {{include("f3", {voucherListVO: voucherListVO || couponInfo.data.voucherListVO, voucherCode: voucherCode})}}</div></div>{{/if}}',
"ez":'<div class="kg account-platPoints"><p {{if data.onOffFlag}}style="display: inline-block; width: 86%; vertical-align: middle;padding-right: 28px;"{{/if}}>{{data.platPointsDesc}}<a class="io" clstag="pageclick|keycount|point_explain|1" platPoints=\'{{$33(data.readmeList)}}\' href="javascript:void(0)"></a></p>{{if data.onOffFlag}}<i class="ka kb {{if usePlatPointsFlag}}checked{{/if}}"></i>{{/if}}</div>',
"f0":'<p class="m1 a2" style="text-align: right;">{{if totalDiscount}}<span style="color: #666;">已优惠<i class="lk" style="margin-left: 5px;">¥</i>{{$36(totalDiscount)}}</span>{{/if}}<span>&nbsp;实付金额<i class="lk" style="margin-left: 8px;font-size: 13px;font-weight: bold;">¥</i><em style="font-size: 23px;font-weight: bold;">{{$36(totalMoney)}}</em></span>{{if msg}}<br><span class="m2">{{msg}}</span>{{/if}}</p>',
"f1":'<div clstag="pageclick|keycount|to_member|1" class="m6 kq"><i class="me"></i><div class="headcont-wrap"><div class="headcont">{{if mainhead}}<p class="mb clamp2">{{each mainhead}}<span {{if $value.color}}style="color:{{$value.color}}"{{/if}}>{{$value.text}}</span>{{/each}}</p>{{/if}}<p class="mc clamp2">{{subhead}}</p></div>{{if jump}}<a href="#vip/channel:settlement" class="m9"></a>{{/if}}<div class="price">{{if promotionCost}}<p class="price1">{{$121(promotionCost)}}</p>{{/if}} {{if primeCost && promotionCost!=primeCost}}<p class="price2">{{$121(primeCost)}}</p>{{/if}}</div><i class="ma {{if checkVipFlag == 1}}checked{{/if}}" vipid={{vipId}}></i></div></div>',
"f2":'<div class="mi"><a class="orderMark" href="javascript:void(0)"><span class="mk">{{remark || orderMark.defaultText || "添加订单备注"}}</span><i class="ml" {{if !remark}}style="display: none;"{{/if}}></i></a>{{if invoice}}<i class="mj">|</i><a class="orderInvoice jm" invoiceInfo href="javascript:void(0)">{{if invoiceInfoData}} {{invoiceInfoData.titleContent}} {{else}}我要开发票{{/if}}</a>{{/if}}</div>',"f3":'{{each voucherListVO}}<div class="lr kq {{if $value.couponCode == voucherCode}}ls{{/if}} {{if $value.use == \'UNAVAILABLE\'}}UNAVAILABLE{{/if}}" quandata=\'{{$33($value)}}\' ><p class="lt">{{$value.amount}}<span class="lu">{{$value.amountUnit}}</span></p><div class="lv a4"><p class="lw">{{$value.couponTitle}}</p><p class="couponInfo-limitRule">{{$value.couponTypeDesc}}&nbsp;{{$value.limitRule}}</p><p class="couponInfo-avilableDate">{{$value.avilableDate}}</p></div>{{if $value.mostDiscountText}}<p class="lx">{{$value.mostDiscountText}}</p>{{else if $value.addItemNoticeTwo}}<p class="lx" style="background: #ff9900;">{{$value.addItemNoticeTwo}}</p>{{else if $value.use == \'UNAVAILABLE\'}}<p class="lx coupon-UNAVAILABLE" clstag="pageclick|keycount|click_reason|1" unavailableReason="{{$value.unavailableReason}}" style="background: #999;">不可用原因<i class="iconfont kt"></i></p>{{/if}}</div>{{/each}}<p class="m0">{{if voucherListVO && voucherListVO.length< 10}}暂无更多{{else}}左滑查看更多{{/if}}</p>',
"f4":'<div class="mq">如遇缺货：<span class="mr">{{stockConfigContent}}</span><i class="iconfont kt"></i></div>',"f5":'<p class="ly" style="top: {{top}}px;left: {{left}}px;">不可用原因：<br>{{=unavailableReason}}</p>',"f6":'<div class=\'m7\' clstag="pageclick|keycount|vip_tips|1"><p class=\'m6 m8 kq\'><i class="mf"></i>{{vipToastTip}}<i class="mg"></i></p></div>',
"f7":'<div class="cartwrap"><div class="loading" style="min-height:{{$29(-60)}}px"></div></div>',"f8":'<div class="k3"><div class="k4"></div></div>',"f9":'<div class="a6j">{{if $85(result) || $86(result)}} {{if !hasLogin}}<div class="a6x">登录后将同步购物车中商品<a class="a6y" href="javascript:void 0;" toLoginPage>登录</a></div>{{/if}} {{include(\'fb\',{address:address})}} {{if $85(result)}} {{include(\'fa\',{list:result.currentLocationStores.cartResults,loc:1})}} {{else}}<div class="a6z"><span>{{result.currentLocationStores.tips}}</span></div>{{/if}} {{if $86(result)}} {{include(\'fc\',{})}} {{include(\'fa\',{list:result.otherLocationStores.cartResults,loc:0})}} {{/if}} {{else}} {{if hasLogin}} {{include(\'fs\', { other_tip_bg: \'yq\', cutHeight: 125, msg: \'购物车空空如也哦~\', btnText: \'去首页逛逛\', btnHref: \'#index\' })}} {{else}}<table class="c" style="background-color:#fff; z-index:5;"><tr><td><div class="a6v">购物车还空空如也哦~<br>登录后将同步购物车中商品<br><a class="a6w" href="javascript:void 0;" toLoginPage>立即登录</a></div></td></tr></table>{{/if}} {{/if}}</div>',
"fa":'{{each list}}<div class="a6m" storeId="{{$value.storeId}}" orgCode="{{$value.orgCode}}"><div style="overflow:hidden;padding-left:2.4%;"><a href="#storeHome/storeId:{{$value.storeId}}/orgCode:{{$value.orgCode}}/hasGoods:true" swipeArea class="a6n" onclick=\'lg("user_action","1.0",{"clickid":"cart__block_20161013", "store_id":"{{$value.storeId}}","currentlocation":"{{loc}}"})\' >{{$value.storeName}}</a><div goodsList class="a6r {{if $72($value.itemList.length)}}a6t{{/if}}"><ul>{{each $value.itemList as $v}}<li><img src="{{$v.imageUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/show_default.png"\'>{{if ($v.skuState!=1)&&($v.skuState!=3)}}<span class="a70">{{$v.skuStateName}}</span>{{/if}} {{if $v.tags}}<div class="a71 tags-{{$v.tags[0].type}}">{{$v.tags[0].iconText}}</div>{{/if}}<em>￥{{$v.price}}</em>{{if $v.cartNum>1 && $v.skuState == 1}}<i>{{$v.cartNum}}</i>{{/if}}</li>{{/each}}<li style="background-image:none;"></li></ul>{{if $72($value.itemList.length)}}<div class="a6s">共{{$value.totalNum}}件</div>{{/if}}</div></div><div class="vn" deleteCart onclick=\'lg("user_action","1.0",{"clickid":"cart_delete_click_20160729", "store_id":"{{$value.storeId}}"})\'><span>删除</span></div><div class="a6u" swipeMask></div></div>{{/each}}',
"fb":'<div class="a6k"><div class="a6l">{{address.poi || address.title || address.address}}<i>(当前位置)</i></div></div>',"fc":'<div class="a6k" style="background-color:#e2e2e2;"><div class="a6l" style="background-color:#999;">其它位置</div></div>',"fd":"{{if sideFlooerItem}}<a class=\"a6o\" id=\"a6o\" onclick=\"lg('user_action','1.0',{'click_id':'home_click_active_20160714_1','page_name':'shopcar'})\" href=\"{{$39($15(sideFlooerItem.to,sideFlooerItem.params,address))}}\"><img src={{sideFlooerItem.imgUrl}} style=\"width:100%;height:auto\"/></a>{{/if}}",
"fe":"<p class='storeHead'><span class='send_to'>配送至：{{address}}</span><a class='edit_addr' href=\"#indexaddress{{if addressId}}/addressId:{{addressId}}{{/if}}{{if type}}/type:{{type}}{{/if}}\">修改</span></p>","ff":'{{if store && store !=""}}<div class="p9">为你推荐</div><ul class="qq">{{each store}}<li class="qr p7" ><div class="p8 {{if !$value.label}}noborder{{/if}}" storeid={{$value.storeId}} orgcode="{{$value.venderId}}" _href="#storeHome/storeId:{{$value.storeId}}/orgCode:{{$value.venderId}}" {{if storeDate}} onclick=\'lg("user_action","1.0",{"clickid":"{{storeDate}}","store_id":"{{$value.storeId}}"})\' {{/if}}><div class="adz"><img class="qs" src="{{$value.logoURL || \'//static-o2o.360buyimg.com/daojia/new/images/icon/notfound-2.png\'}}"/>{{if $value.closeStatus == 1}}<span class="ae2">休息中</span>{{/if}}</div><div class="qt"><h2>{{$value.storeName}}</h2><div class="a20"></div><p class="adq">{{include("h6",{score:$value.storeStar})}}</p><p>{{$value.describe}}</p></div></div>{{if $value.label}}<div class="qy {{if $value.label && $value.label.length>0}} qz {{/if}} {{if $54() && (($value.label.length == 1) && $55($value.label))}}cf{{/if}}"><div class="r0">{{if $value.label && $value.label.length>0}}<ul node-type="storeActivityList" class="r8">{{include(\'hd\',{storetags:$value.label})}}</ul>{{/if}}</div>{{if $value.label && $56($value.label).length>2}}<div class="r1" node-type="checkStoreActivity"><span>{{$56($value.label).length}}个活动</span><i class="r5 r6"></i></div>{{/if}}</div>{{/if}}</li>{{/each}}</ul>{{/if}}',
"fr":'<div class="yk" style="min-height:{{$29()}}px"><div class="tg"><p>{{msg || \'您还没有登录\'}}</p><a class="y5" href="{{$8(false)}}">立即登录</a></div></div>',"ft":'<div class="m full oj" style="min-height:{{$29()}}px"><div class="fresh"><p>{{msg || \'网络开小差，请稍后再试哦~[0001]\'}}</p><a class="yl" href="javascript:window.location.reload()">重新加载</a></div></div>',"fv":'<div class="yn full oj" ><div class="fresh"><p>{{msg || \'网络开小差，请稍后再试哦~[0001]\'}}</p><a class="yl" href="javascript:window.location.reload()">重新加载</a></div></div>',
"fy":'<div class="ye" style="min-height:{{if noHeight}}320px{{else}}{{$29()}}px{{/if}}"><div class="yf"><p>{{msg || \'附近暂无商家[0001]\'}}</p><a {{if fromHash && $16(fromHash)}} href="{{$18()}}" {{else}}href="#index" {{/if}} class="y5 {{if noHeight}}yg{{/if}}">回首页</a></div></div>',"g0":'<div class="th ys {{if allPage}}yt{{/if}}" {{if allPage}}style="min-height:{{$29()}}px"{{/if}}><div class="yo y7"><p>{{msg}}</p><a class="y5 goIndex" href="#index">返回首页</a><a class="y5" href="#indexaddress{{if addressId}}/addressId:{{addressId}}{{/if}}{{if type}}/type:{{type}}{{/if}}">更换地址</a></div>{{if pageName == "goodsDetail" && recommend && recommend.recommendSkuVOList && recommend.recommendSkuVOList.length>0}}<div class="ba recommended"><span><i class="bb"></i>{{recommend.dimensionName}}<i class="bc"></i></span></div><ul class="g9 c7 c5">{{include(\'good-list-tpl\',{result:recommend.recommendSkuVOList})}}</ul>{{/if}} {{if pageName == "storeHome" && recommend && recommend.length>0}}<div class="ba recommended"><span><i class="bb"></i>附近商家<i class="bc"></i></span></div>{{include(\'store-list-tpl\',{result:recommend})}} {{/if}}',
"g1":'{{if canUploadPic}}<ul class="picWrapper"><li class="uploadImage"><img src="//static-o2o.360buyimg.com/daojia/new/images/uploadImage/icon_upload_pic.png" /></li></ul>{{else}} {{include("g4")}} {{/if}}',"g2":'<ul class="picWrapper"><li class="uploadImage"><img src="//static-o2o.360buyimg.com/daojia/new/images/uploadImage/icon_upload_pic.png" /></li></ul>',"g3":'<li class="imgShow" url="{{url}}" _url="{{_url}}"><img src=\'{{url}}\' class="trueImg" /><span class="failImg" url="{{url}}" ></span>{{if showLoading}}<span class="isLoading loading"><img src="//static-o2o.360buyimg.com/daojia/new/images/uploadImage/progress_load_circle.png" /></span>{{/if}}<em url="{{_url||url}}" {{if showLoading}}style="display:none"{{/if}}></em></li>',
"g4":'<div class="after-sales-pic-wrap"><div class="after-sales-form-pic noShowPic a2"><img src="//static-o2o.360buyimg.com/daojia/new/images/uploadImage/icon_picture.png" /><a class="openDjApp " href="openApp.jddj://communication?body={\'params\':{},\'to\':\'home\'}"><em>如需上传图片,请打开</em><i>京东到家app</i></a></div></div>',"g5":'<div class="bigImgWrapper"><img src="{{url}}" /><p class="bigImgDesc">{{if text}}<span>{{text}}</span>{{/if}} {{if !del}}<em class="delImg" url="{{url}}"></em>{{/if}}</p></div>',
"g6":'<div class="tt userdata "><a class="tv {{if hasLogin&& !data.yunBigImageUrl}} tw{{/if}}" href="{{$9(hasLogin,\'#userData\',\'true\')}}">{{if data.yunBigImageUrl}}<img id="tv" src="{{data && data.yunBigImageUrl}}"/>{{/if}}</a>{{if hasLogin}}<span class="nickname">{{data.nickName}} {{if data.vipStatus != -1}}<span class="huiyuan {{if data.vipStatus==1}}unVip{{else if data.vipStatus==2}}isVip{{/if}}">{{if data.vipStatus==1}}{{else if data.vipStatus==2}}{{/if}}</span>{{/if}}<br>{{if data.mobile}}<span class="tx"><a class="tx" href="{{data.moblieChangeUrl}}?IsH5=true&source=7&sid={{data.sid}}&deviceId={{data.deviceId}}&returnUrl={{data.returnUrl}}">{{data.mobile}}</a><a class="ty" href="{{data.moblieChangeUrl}}?IsH5=true&source=7&sid={{data.sid}}&deviceId={{data.deviceId}}&returnUrl={{data.returnUrl}}"></a></span>{{else}}<span class="tx"><a class="tx" href="{{data.moblieChangeUrl}}?IsH5=true&source=7&sid={{data.sid}}&deviceId={{data.deviceId}}&returnUrl={{data.returnUrl}}">绑定手机号</a><a class="ty" href="{{data.moblieChangeUrl}}?IsH5=true&source=7&sid={{data.sid}}&deviceId={{data.deviceId}}&returnUrl={{data.returnUrl}}"></a></span>{{/if}}</span><div class="vp"><label class="vr"><label class="vs"></label></label><a class="vq" href="#message"><i class="hideDot"></i></a></div>{{if data.vipStatus != -1}}<a href="{{data.vipJumpUrl}}" clstag="pageclick|keycount|to_member|1" class="vip_access"></a>{{/if}} {{else}}<span class="login" >登录/注册</span><div class="vp"><label class="vr user-need-login"><label class="vs"></label></label><a class="vq" href="{{$9(hasLogin,\'#message\',\'true\')}}"><i class="hideDot"></i></a></div>{{/if}}</div><div class="u1 user-wallet u2">{{include(\'ge\')}}</div><div class=" u4">{{include(\'g7\')}}</div><div class="u1 q"></div><div class="{{if hasLogin && !$31()}} v1{{/if}}"><a class="ui{{if hasLogin && !$31()}} logout{{/if}}" href="javascript:void(0)">退出账号</a></div>',
"g7":'{{if result && result.length>0}}<div class="swipe7 b2 u5" swipe><ul class="swipe7list">{{each result[0].bannerFloorItemList as item}}<li class="swipe7item"><a href="{{$15((item.to),(item.params),address,"","")}}"><img class="imgstyle" src="{{item.imgUrl}}" onerror=\'this.src="//static-o2o.360buyimg.com/daojia/new/images/index_banner_default@2x.png"\' /></a></li>{{/each}}</ul></div>{{/if}}',"g8":"{{if result}} {{each result as item $index}}<a class=\"u7 {{if item.isRedStatus==\"0\" && !item.newreddot}}news{{/if}} {{if result.length%4==0}} u8{{/if}}\" {{if item.to=='web'}}onclick=\"lg('user_action','{{item.userAction}}',{'page_name':'{{$11(item.to,item.params.url)()}}'})\" {{else}}onclick=\"lg('user_action','1.0',{'page_name':'{{$11(item.to)}}'})\"{{/if}} href=\"{{if item.needPin&&item.params}}{{$8(hasLogin,item.params.url)}} {{else if item.params && item.to==\"jdweb\" }} {{item.params.url}}{{$5(item.params.url)}}sid={{item.sid}} {{else if item.params}} {{item.params.url}} {{else if $10(item.to).needLogin && $10(item.to).nopathname}} {{$9(hasLogin,($10(item.to).to))}} {{else if $10(item.to).needLogin}} {{$9(hasLogin,($10(item.to).to),'true')}} {{else}} {{$10(item.to).to}} {{/if}}\" clickneed=\"{{if item.params}}{{item.params.url}}{{/if}}\" style=\"{{if $index>=(result.length-result.length%4)}}border-bottom:none{{/if}}\"><img class=\"user-list-icon1 mine-store-icon \" src=\"{{item.img}}\" onerror='this.src=\"//static-o2o.360buyimg.com/daojia/new/images/user_iconlist_default_new.png\"'>{{item.name}}</a>{{/each}} {{/if}}",
"g9":'{{if result}}<div class="user-qrcode-switchWrap"><div class="vu"></div><div class="vv"><div class="vw">{{if result.topTip}}<div class="vx">{{result.topTip}}</div>{{/if}} {{if result.midTip}}<p class="vy">{{result.midTip}}</p>{{/if}}<div class="w4">{{if result.barCodeUrl}}<div class="w0"><img src="{{result.barCodeUrl}}"/></div>{{/if}} {{if result.qrCodeUrl}}<div class="vz"><img src="{{result.qrCodeUrl}}"/></div>{{/if}}</div><div class="w1 h"><a href="#orderlist" class="w2">查看订单</a></div></div><div class="qrcode-closeBtn-wrap"><span class="w3"><span class="user-qrcode-part1"></span><span class="user-qrcode-part2"></span></span></div></div></div>{{/if}}',
"ga":'{{if hasLogin}} {{if addresslist && addresslist.length>0}}<p class="uj">我的收货地址</p><ul class="uk">{{each addresslist}}<li addressId="{{$value.id}}" class="{{if $index!=0}}h{{/if}}"><p class="user_info">{{$value.name}}<span>{{$value.mobile}}</span></p><p class="address_info">{{if $value.tags && $value.tags.length>0}}<i class="zi">{{$value.tags==1?"家":($value.tags == 2?"公司":"学校")}}</i>{{/if}} {{$value.fullAddress}}</p><span class="ul" addressId="{{$value.id}}"></span></li>{{/each}}</ul>{{else}}<div class="zj"><div class="address-prompt"><p class="ze">还没有收货地址，快去新建吧</p></div></div>{{/if}}<p class="z5"><a href="#newaddress" class="z6 {{if addresslist.length==20}}toomany{{/if}}">新建收货地址</a></p>{{else}} {{include(\'fr\')}} {{/if}}',
"gb":'<div class="uw">{{if data.showTit}}<p class="showTit">请您填写<em>&nbsp;{{data.showTit}}&nbsp;</em>配送范围内地址</p>{{/if}}<p class="showTit" {{if !data.superzone}}style="display:none;"{{/if}}>这个地址超过该门店的配送范围</p><div class="ku h a2"><label for="name">联系人</label><input type="text" id="name" pattern=".+" placeholder="请填写收货人姓名" vtitle="收货人姓名" name="name" maxLength="10" /></div><div class="uz h a2"><label for="mobile">手机号</label><input type="tel" id="mobile" placeholder="请填写收货人电话号码" maxLength="11" pattern="^0?\\d{11}$" _pattern="^0?\\d{11}$" vtitle="收货人电话号码" name="mobile" /></div><div class="uy h a2"><ul><li class="v0"><span>配送至</span><p tap class="textColor a2"><i>请选择小区/写字楼/学校街道等</i></p></li><li class="ji"><input type="text" pattern=".+" placeholder="详细地址（门牌号/楼层等）" vtitle="收货人详细地址" name="addressDetail" id="addressDetail" maxLength="50" /></li></ul></div><div class="ux h a2"><span>标签:</span><span class="tab" tag=\'1\'>家</span><span class="tab" tag=\'2\'>公司</span><span class="tab" tag=\'3\'>学校</span></div><div class="um button-style"><i>保存</i></div>{{if data.name=="editaddress"}}<span class="un" tap></span>{{/if}}</div>',
"gc":'<div class="us"><div class="ut"><span>头像</span><em><img class="ur" id="tv" src="{{data.yunBigImageUrl || \'//static-o2o.360buyimg.com/daojia/new/images/user/bg_head_new_light.png\'}}"/></em></div>{{if data.userName}}<div class="ut"><span>用户名</span><em>{{data.userName}}</em></div>{{/if}}<div class="ut"><span>昵称</span><em>{{data.nickName}}</em></div><div class="ut"><span id="userGendar">性别</span><em>{{if data.gendar == 0 }}男{{else if data.gendar == 1}}女{{else}}保密{{/if}}</em></div><div class="ut"><span>出生日期</span><em>{{data.birthday}}</em></div><a class="ut uu uv" href="{{data.securityJumpUrl}}?IsH5=true&source=7&sid={{data.sid}}&deviceId={{data.deviceId}}&returnUrl={{data.returnUrl}}"><span>账户安全</span><em>可修改密码&nbsp;&nbsp;<i></i></em></a></div>',
"gd":'<div class="v9"><a class="va user-new-online-service k" href="{{$65(kefu).kefu}}" clstag="pageclick|keycount|my_customer_20160713|1" style="display:none"><i></i><span>在线客服</span></a><a class="vb" href="{{$65(kefu).fankui}}" clstag="pageclick|keycount|my_fedback_20160713|1"><i></i><span>系统功能反馈</span></a></div><div class="vd"><p class="service-title">常见问题</p><div class="vc"><a class="uf a2" href="#cuidan" clstag="pageclick|keycount|my_reminder_20160713|1">为何订单还没送到？</a><a class="uf a2" href="#cancelOrder" clstag="pageclick|keycount|my_cancel_20160713|1">订单取消、订单已锁定怎么办？</a><a class="uf a2" href="#shouhou" clstag="pageclick|keycount|my_service_20160713|1">怎么申请售后？</a><a class="uf a2" href="#tuikuan" clstag="pageclick|keycount|my_refund_20160713|1">退款相关问题</a><a class="uf a2" href="#rewrite" clstag="pageclick|keycount|my_modify_20160713|1">如何修改订单</a><a class="uf a2" href="#youhui" clstag="pageclick|keycount|my_coupon_20160713|1">优惠券/兑换码的使用和退回问题</a></div></div>',
"ge":'<ul class="p u3 {{if paydata&&isIntegral}}widthLength3{{else if !isIntegral}}widthLength2 {{/if}}"><li class="walletdata a3"><a href="{{$8(hasLogin,\'#walletData\')}}"><i class="v8"></i><b>我的钱包</b></a></li>{{if paydata && paydata.infos && paydata.infos[0]}} {{each paydata.infos[0] as item}} {{if item}} {{if item.acctype == \'1\'}}<li><a href="#couponsList"><i class="u6 ">{{$50(item.value)}}</i>{{item.accName}}</a></li>{{/if}} {{if item.acctype == \'3\'}}<li><a href="{{item.openUrl}}{{$5(item.openUrl)}}sid={{sid}}"><i class="u6 ">{{$50(item.value)}}</i>{{item.accName}}</a></li>{{/if}} {{if item.acctype == \'6\'}}<li><a href="#integral"><i class="u6 integral">{{$50(item.value)}}</i>{{item.accName}}</a></li>{{/if}} {{/if}} {{/each}} {{else}}<li style="width:24%;"><a href="{{$9(hasLogin,\'#couponsList\',\'true\')}}"><i class="u6">--</i>优惠券</a></li><li style="width:24%;"><a href="{{$9(hasLogin,\'#\')}}"><i class="u6">--</i>白条</a></li><li style="width:24%;"><a href="{{$9(hasLogin,\'#integral\',\'true\')}}"><i class="u6">--</i>鲜豆</a></li>{{/if}}</ul>',
"gf":'<div class="ug"><div class="u1">{{if data.infos && data.infos[0]}} {{each data.infos[0] as item}} {{if item}} {{if item.acctype == \'3\'}}<a class="uf a2" href="{{item.openUrl}}"><i class="u0 ud"></i>白条<em class="fr">{{if item.value}}{{$50(item.value)}} 元{{else if item.value==0}}0.00 元{{/if}}</em></a>{{/if}} {{if item.acctype == \'2\'}}<a class="uf a2" href="#myJingdou"><i class="a0 icon-jingdou"></i>京豆<em class="fr">{{item.value}} 豆</em></a>{{/if}} {{if item.acctype == \'1\'}}<a class="uf a2" href="#couponsList"><i class="a0 u9"></i>我的优惠券<em class="fr">{{item.value}} 张</em></a>{{/if}} {{if item.acctype == \'6\'}}<a class="uf a2" href="#integral" onclick="lg(\'user_action\', \'1.0\', {\'page_name\':\'mypoint\'});"><i class="u0 ub"></i>鲜豆<em class="fr">{{item.value}} 个</em></a>{{/if}} {{if item.acctype == \'10\'}}<a class="uf a2" href="{{item.openUrl}}{{$5(item.openUrl)}}IsH5=true&sid={{data.sid}}&deviceId={{data.deviceId}}&returnUrl={{data.returnUrl}}"><i class="a0 v3"></i>{{item.accName}}<em class="fr unbindCard"></em></a>{{/if}} {{if item.acctype == \'11\'}}<a class="uf a2" href="{{item.openUrl}}{{$5(item.openUrl)}}IsH5=true&sid={{data.sid}}&deviceId={{data.deviceId}}&returnUrl={{data.returnUrl}}"><i class="a0 v4"></i>{{item.accName}}<em class="fr unbindCard"></em></a>{{/if}} {{/if}} {{/each}} {{/if}}</div><div class="u1">{{if data.infos && data.infos}} {{each data.infos[1] as item}} {{if item}} {{if item.acctype == \'5\'}}<a class="uf a2" href="{{item.openUrl}}{{$5(item.openUrl)}}IsH5=true&sid={{data.sid}}&deviceId={{data.deviceId}}&returnUrl={{data.returnUrl}}"><i class="a0 v2"></i>{{item.accName}}<em class="fr unbindCard">解绑银行卡</em></a>{{/if}} {{if data.hideWX && item.acctype == \'7\'}}<a class="uf a2 wallerWX"><i class="u0 uc"></i>{{item.accName}}<em class="fr unbindCard">{{item.value}}</em></a>{{/if}} {{/if}} {{/each}} {{/if}}</div></div>',
"gg":'<div class="vh"><ul class="vo"></ul><div class="ct"><span>努力加载中</span><i></i></div></div>',"gh":'{{include("gi",{result:result})}}',"gi":"{{if result.data && result.data.length}} {{=include(\"gu\",{data:$82(result),fromHash:\"mineCollectStore\"})}} {{else}} {{if !more}} {{include('fs',{'msg':'您还没有关注门店','other_tip_bg':'yu','hideBtn':true})}} {{/if}} {{/if}}",
"gj":'<div class="acj">微信免密支付</div><div class="ack"><span class="acl close"><i></i></span>免密支付</div><p class="acm"></p><div class="aco"></div>',"gn":'{{if $data && $data.length}}<div style="min-height:{{$29()}}px;background: #fff;"><ul class="pur_list">{{each $data}}<li class="pur_item {{if $value.status==102}}overdue{{/if}}"><h4 class="icon_vip_zhuanshi"><span class="red">￥{{$value.payCost}}</span><i>VIP会员卡</i>{{if $value.status==101}}<i class="tigs_green">待使用</i>{{/if}} {{if $value.status==102}}<i class="tigs_999">已过期</i>{{/if}} {{if $value.status==103}}<i class="tigs_yellow">使用中</i>{{/if}}</h4><p>交易时间：{{$value.createTime}}</p><p>购买时长：{{$value.usefulTime}}</p><p>有效时间：{{$102($value.beginTime)}}到{{$102($value.endTime)}}</p><p>支付方式：{{$value.paymentType}}</p><p>会员卡号：{{$value.cardNo}}</p></li>{{/each}}</ul><p class="pur_txt">已为你展示全部</p></div>{{else}} {{include(\'gl\')}} {{/if}}',
"gp":'{{if $data && $data.length}} {{each $data}}<p class="aan"><em><span class="red">￥{{$value.reduceFreightMoney}}</span>减基础运费</em><b>时间：<i>{{$value.useTime}}</i></b><b>订单号：<i>{{$value.useUniqueMark}}</i></b></p>{{/each}} {{else}}<p class="aaw">没有数据哦~</p>{{/if}}',"gr":'<div style="min-height:{{$29()}}px" class="abh">{{if norenewUser}}<div class="aba"><h5>您尚未开通连续包月服务<br/>开通后享受超值特价</h5><div class="abb">{{if data.promotionCostStr == data.renewCost}}<p class="abn"><i>￥</i>{{data.promotionCostStr}}/月<p><p class="abo">原价{{data.primeCostStr}}</p>{{else}}<p class="abc">本月 ￥<i>{{data.promotionCostStr}}</i></p><p class="abd">次月自动续费<i>￥{{data.renewCost}}</i><b>原价{{data.primeCostStr}}</b></p>{{/if}}<p class="abe">自动续费，开通后可随时取消</p></div><p class="abf pay-vip-baoyue">开通连续包月</p><p class="abg">查看<a href="#vipAutoRenewDesc">《连续包月服务条款》</a></p></div><div class="abm"></div>{{else}}<div class="abj"><div class="renew-user-list"><p class="abi"><span>{{data.endTime}}</span><b>当前有效期</b></p><p class="abi"><span>{{data.costTime}}</span><b>下次扣费时间</b></p><p class="abi"><span>￥{{data.renewCost}}</span><b>扣款金额</b></p></div><div><h6 class="j4">默认支付方式</h6><p class="abi wechat"><b>微信支付</b></p></div><p class="abf show-pop">取消连续包月</p><p class="abg">查看<a href="#vipAutoRenewDesc">《连续包月服务条款》</a></p></div>{{/if}}</div>',
"gs":'<div class="abl">{{=html}}<div>',"h5":'<span class="kh"><span class="da">{{text || \'达达专送\'}}</span></span>',"he":'<span class="af7 {{if skuGifts.giftDetails.length >2}}afc{{/if}}">{{each skuGifts.giftDetails}}<a class="af9" href="#goodsDetails/skuId:{{$value.skuId}}/storeId:{{storeInfo.storeId}}/orgCode:{{storeInfo.venderId}}" onclick=\'lg("user_action","1.0",{"clickid":"to_present","storeid":"{{storeInfo.storeId}}"})\'><img class="af8" src="{{$value.imgeUrl}}" align="absmiddle"/><i class="afa">✖️</i><var class="goods-mz-sku-num">{{$value.skuCount}}</var></a>{{/each}}</span>'};
;for(var daojia_separate_tpl_key in daojia_separate_tpl){h.s[daojia_separate_tpl_key]=daojia_separate_tpl[daojia_separate_tpl_key]};;
View.extend({name:"aboutUs",title:"关于我们",initialize:function(){this.setContentView(h("dx")({insert:"a"}))}});
View.extend({name:"activityPage",borrow:[Q.shareOperate],events:{"tap .ge.sure":"addGoods","click .specify_store":"tabchange","click [skipbykeys]":"skipWithKeys","click .right_store_title":"showAllStores",
"tap .address_go":"closeAddressForm","tap .rg":"closeStoreList","click [node-type=index-gotoStore]":"goToStore","click [couponCode]":"activityCoupons"},from:{indexaddress:"fromAddress",newaddress:"newAddress"},initialize:function(a){a||(a={});var b=this,c=a.queryParam,e=c.actNativeId;b.options=a;b.backInFun=!0;b.activityBusy=c.activityBusy;b.oldHash=a.newHash||window.location.hash;b.setContentView(h("dx")({loading:!0}));b.nowActId=e;b.isShare=!1;b.storeListsInfo=void 0;b.currentPage=
1;b.hasNextPage=!0;b.fromApp="app"==A("channel")?"app":"";O?(a=Yc(),a=JSON.parse(a),b.getActInfo(a,!1)):(fenxiang&&"activityPage"==sharePage?($(".a01").remove(),fenxiang=!1,b.isShare=!0,sa(!1).done(function(a){a.needMatch=1;Fa(a).done(function(a){a=t.formatAddressData(a);t.saveLocalCurrent(a);b.nowAddr=a;b.getActInfo(a,!0)}).fail(function(a){b.getActInfo({},!0)})}).fail(function(){b.getActInfo({},!0)})):t.getCurrentUse({justCoords:!0}).done(function(a){b.checkIsCover(a,!1)}).fail(function(a){x({hash:"#indexaddress",
keep:!0,data:{currentaddress:b.nowAddr||{}}});setTimeout(function(){b.$(".content").append(h("fx")())},1E3)}),R(b,b.more,"div[floor]"))},more:function(a){this.getActInfo(this.nowAddr,this.isShare)},checkIsCover:function(a,b){this.backInFun=!1;this.nowAddr=a;this.getActInfo(a,b)},fromAddress:function(a){var b=window.location.href;this.initData(a);-1!=b.indexOf("fenxiang=true")?this.getActInfo(a,!0):(a.title||a.poi)&&this.checkIsCover(a,!1)},newAddress:function(){var a=t.getLocalCurrent(),
b="activityPage"==sharePage&&a.sharePage?!0:!1;this.initData(a);this.checkIsCover(a,b)},initData:function(a){this.backInFun=!1;this.currentPage=1;this.nowAddr=a;this.setContentView(h("dx")({loading:!0}));this.storeListsInfo={};this.hasNextPage=!0},getActInfo:function(a,b){var c=this;a=a||{};c._isFetch||!1===c.hasNextPage||(c.nowAddr=a,c.backInFun=b?!1:!0,c.activityBusy?c.setContentView(h("fw")({msg:"这里没有活动，回首页逛逛吧[0001]",fromDepriceList:!0})):(c._isFetch=!0,Qd(c,{longitude:a.longitude||
"",latitude:a.latitude||"",city:a.city||"",activityId:c.nowActId,shareFlag:b?!0:!1,currentPage:c.currentPage}).done(function(e){c._isFetch=!1;var f=0,g=1;e||(e={});c.weixinShareInfo=c.setWXShareText("");e.config&&(g=e.config.pageSize||1,f=e.config.totalCount||0,c.pages=0<f%g?parseInt(f/g)+1:f/g,e.config.gloabTitle&&c.setTitle(e.config.gloabTitle),c.weixinShareInfo=c.setWXShareText(e.config.shareInfo||""),fa(c.weixinShareInfo));if(e.data&&e.data.length){if(b&&1==c.currentPage){e.data=c.addFloor(e.data,
a.title);var l=!1;$.each(e,function(a,b){"feed"==b.floorStyle&&(l=!0)});l&&lg("user_action","1.0",{clickid:"hasNoActivityContent"})}e.address=a;1==c.currentPage?c.setContentView(h("b")({result:e,isShare:b?!0:!1})):c.$(".activityDiv").append(h("c")({result:e,isShare:b?!0:!1}));setTimeout(function(){$.each(e.data,function(a,b){if("product5"==b.floorStyle&&"tpl1"==b.styleTpl)return c.storeListsInfo=b,c.storeLists=b.data,!1});if(c.storeListsInfo&&c.storeListsInfo.data&&
!c.$(".rj").length){c.$(".activityDiv").append(h("g")({data:c.storeListsInfo,isShare:b?!0:!1}));c.$(".preTitle").html(h("i")({data:c.storeListsInfo}));c._markedStoreIndex=void 0;c._markedStoreHeight=void 0;c.initShow();var a=c.$("[node-type=stores-title]"),f=c.$("[node-type=rm]");1==c.$(".activityDiv").children().length&&c.$(".rk").find(".store_title").addClass("noMarginTop");c.stickyPosition=0;c.$(".storeHead").length&&
(c.stickyPosition=45,c.$(".rm").addClass("rn"),a.addClass("ro"));Uc({normal:a,fixedNav:f,fixedTop:c.stickyPosition});c.countTime()}Ca(c.$("[swipe]"),{auto:1E3});O&&1==c.currentPage&&(a=window.navigator.userAgent,f=A("djAppVersion",a),f=oa(f),3.4<=f&&(f=xb(c.weixinShareInfo.shareUrl),f=encodeURIComponent(Xc(a,"channel","app")),f=pb(f),Zc(f,c.weixinShareInfo)));c.currentPage>=c.pages?(c.hasNextPage=!1,c.$(".ct").removeClass("cu"),
c.$(".rf").show()):(c.currentPage++,c.$(".ct").addClass("cu"));v.scrollTop(v.scrollTop()+0.1)},0);b&&setTimeout(function(){c.jumpProtocol(c.$(".activityToGoods"),"anchorStore");c.jumpProtocol(c.$(".activityToStore"),"store");c.jumpProtocol(c.$(".activityToDetails"),"goods")},500)}else c.setContentView(h("fw")({msg:e.msg||"这里没有活动，回首页逛逛吧[0001]",fromDepriceList:!0}))}).fail(function(a){c.hasNextPage=!1;c._isFetch=!1;c.$(".ct").removeClass("cu");
c.$(".rf").show();Ma();117==a.code?c.setContentView(h("fs")({msg:a.msg})):c.setContentView(h("fw")({msg:a.msg||"这里没有活动，回首页逛逛吧[0001]",fromDepriceList:!0}))})))},MoniMove:function(){var a=this.$(".ri"),b=this.$(".store-goods"),c=this.$(".rk"),e=this.$(".rk").find(".left_store_title"),f=this.storeLists.length,g=window.innerHeight||480,l=this.countLength().wrapperHeight,h=this.storeLists;c[1]&&0<c[1].getBoundingClientRect().top&&
this.$(".activty-goods-content").eq(0).removeClass("moreMargin");l>g?this.$(".rf").show():this.$(".rf").hide();if(f)for(var l=[],n=f-1;1<=n;n--)if(l[n]=b[n].getBoundingClientRect().top,l[n]<g+400){if(f!=a.find("[hasload=true]").length){var r=this.loadStoreByIndex(b.eq(n),n);0<r.length&&this.getStoreGood(this.nowAddr,this.nowActId,r)}if(this._markedStoreIndex){for(var r=this._markedStoreIndex,s=this._markedStoreHeight,t=this.$(".rk").find(".left_store_title"),
n=r-1;0<=n;n--)if(50>b[n].getBoundingClientRect().top||0==n){u=h[n].storeName;v=h[n].storeId;w=h[n].venderId;t.attr("storeId",v);t.attr("orgCode",w);t.find("a").attr("href","#storeHome/storeId:"+v+"/orgCode:"+w);this.$(".rk").find(".selected_store").text(u);this.$(".specify_store").removeClass("choosed_store");this.$(".specify_store[storeId='"+h[r].storeId+"']").addClass("choosed_store");break}this.$(".activty-goods-content")[r].getBoundingClientRect().top>s&&(v=h[r-1].storeId,
this.$(".specify_store").removeClass("choosed_store"),this.$(".specify_store[storeId='"+v+"']").addClass("choosed_store"),this._markedStoreHeight=this._markedStoreIndex=void 0)}else{if(l[n]<this.stickyPosition+45){var u=b.eq(n).find(".selected_store").text(),v=h[n].storeId,w=h[n].venderId;c.find(".selected_store").text(u);e.attr({storeId:v,orgCode:w});e.find(".wrap-left-store-name").attr("href","#storeHome/storeId:"+v+"/orgCode:"+w);this.$(".specify_store").removeClass("choosed_store");this.$(".specify_store[storeId='"+
v+"']").addClass("choosed_store");break}u=h[0].storeName;w=h[0].venderId;v=h[0].storeId;c.find(".selected_store").text(u);e.find(".wrap-left-store-name").attr("href","#storeHome/storeId:"+v+"/orgCode:"+w);this.$(".specify_store").removeClass("choosed_store");this.$(".specify_store[storeId='"+v+"']").addClass("choosed_store")}}},onhashchange:function(a){if(a!=this.oldHash){clearInterval(this.getGoodsTimer);var b=ea(a);w("#"+a);fenxiang=this.isShare?!0:!1;this.initialize({queryParam:b,newHash:a})}},
initShow:function(){var a=this;a.storeGoodsNum=0;a.storeRenderNum=1;var b=a.storeLists.length,c=a.storeLists;$.each(c,function(b,f){c[b].hasLoaded=!1;c[b].orgCode=f.orgCode||f.venderId;c[b].skuIds=f.skuIdList;a.storeGoodsNum+=2*Math.round(f.skuSize/2);6>a.storeGoodsNum&&a.storeRenderNum++});a.storeRenderNum=1==a.storeRenderNum?2:a.storeRenderNum>b?b:a.storeRenderNum;a.getStoreGood(a.nowAddr,a.nowActId,c.slice(0,a.storeRenderNum));a.$(".specify_store[storeId='"+c[0].storeId+"']").addClass("choosed_store")},
tabchange:function(a){var b=this,c=$(a.currentTarget);a=b.$(".rk").find(".left_store_title");var e=c.index(),f=c.find("span").text(),g=b.$(".store-goods"),l=c.attr("storeId"),h=b.countLength(),n=h.storeToTopHeight,h=h.storesHeightArr,c=c.attr("orgCode");$(window).unbind("touchmove.activity");b.$(".specify_store[storeId='"+l+"']").addClass("choosed_store").siblings().removeClass("choosed_store");b.$(".rk").find(".selected_store").text(f);a.attr("storeId",l);a.attr("orgCode",
c);a.find("a").attr("href","#storeHome/storeId:"+l+"/orgCode:"+c);b.$(".store_list").removeClass("show_store_list");b.$(".right_store_title").removeClass("show_stores");b.$(".rg").removeClass("rh");v.scrollTop(0<e?n+h[e-1]+60:n+5);setTimeout(function(){var a=b.$(".activty-goods-content")[e].getBoundingClientRect().top;a>b.stickyPosition+50&&(b._markedStoreIndex=e,b._markedStoreHeight=a);a=b.loadStoreByIndex(g.eq(e),e);0<a.length&&b.getStoreGood(b.nowAddr,b.nowActId,
a)},100)},showAllStores:function(a){a=$(a.currentTarget);var b=this.$(".rk").find(".store_list"),c=this.$(".rj").find(".rg"),e=this.$(".right_store_title"),f=a[0].getBoundingClientRect().top,g=v.scrollTop(),l=this.countLength().storesHeightArr,h=l.length,n=window.innerHeight;a.hasClass("show_stores")?(e.removeClass("show_stores"),b.removeClass("show_store_list"),c.removeClass("rh"),$(window).unbind("touchmove.activity")):($(window).bind("touchmove.activity",
function(a){a.preventDefault()}),Qb()?(e.eq(1).addClass("show_stores"),b.eq(1).addClass("show_store_list"),c.eq(1).addClass("rh")):l[h-1]>n||1==this.$(".activityDiv").children().length?(e.addClass("show_stores"),b.addClass("show_store_list"),c.addClass("rh")):(e.eq(1).addClass("show_stores"),b.eq(1).addClass("show_store_list"),c.eq(1).addClass("rh")),10<f&&f<l[h-1]&&(this.$(".activty-goods-content").eq(0).addClass("moreMargin"),$(window).scrollTop(f+
g-10)))},closeStoreList:function(){$(window).unbind("touchmove.activity");this.$(".right_store_title").removeClass("show_stores");this.$(".rk").find(".store_list").removeClass("show_store_list");this.$(".rj").find(".rg").removeClass("rh")},getStoreGood:function(a,b,c){var e=this;Rd(e,{longitude:a.longitude,latitude:a.latitude,activityId:b,city:a.city||a.cityName,stores:c}).done(function(a){a||(a={});if(a.data&&0<a.data.length)for(var b=
0;b<a.data.length;b++){var l=a.data[b].storeId,q=h("good-list-tpl")({result:a.data[b].skuList,showCart:!0,showcartCount:!0,skuDate:"cl_hd_sku",cartDate:"cl_hd_cart",goStoreHome:!0,isShare:e.isShare});e.$(".c5[storeId='"+l+"']").html(q);e.$(".store-goods[storeId='"+l+"']").attr("hasLoad","true")}else $.each(c,function(a,b){e.$(".store-goods[storeId='"+b.storeId+"']").attr("hasLoad","true").addClass("none");e.$(".specify_store[storeId='"+b.storeId+"']").remove()}),e.$(".right_store_title span").text(e.$(".specify_store").length/
2),0==e.$(".specify_store").length&&(e.setContentView(h("fw")({msg:a.msg||"这里没有活动，回首页逛逛吧[0001]",fromDepriceList:!0})),e.$(".rj").remove())}).fail(function(a){a||(a={});$.each(c,function(a,b){e.$(".store-goods[storeId='"+b.storeId+"']").attr("hasLoad","true").addClass("none");e.$(".specify_store[storeId='"+b.storeId+"']").remove()});e.$(".right_store_title span").text(e.$(".specify_store").length/2);0==e.$(".specify_store").length&&(e.setContentView(h("fw")({msg:a.msg||
"这里没有活动，回首页逛逛吧[0001]",fromDepriceList:!0})),e.$(".rj").remove())})},countLength:function(){var a=this.$(".activityDiv"),b=this.$(".ri"),c={},a=a.height(),e=this.$(".rj").eq(1).height(),f=0,g=[];c.wrapperHeight=a;c.storeToTopHeight=a-e;b.find(".store-goods").each(function(a,b){f+=$(b).height();g.push(f)});c.storesHeightArr=g;return c},leave:function(){window.clearInterval(this.getGoodsTimer);$(window).unbind("touchmove.activity");this.closeAddressForm()},skipWithKeys:function(a){a=
$(a.currentTarget).attr("keySkipData");a=W(a);x({hash:"#indexSearchToStore",keep:!0,data:a})},backin:function(){this.backInFun&&this.initialize(this.options)},loadStoreByIndex:function(a,b){var c=[];"false"==a.attr("hasload")&&c.push(this.storeLists[b]);"false"==a.next().attr("hasload")&&c.push(this.storeLists[b+1]);"false"==a.prev().attr("hasload")&&c.push(this.storeLists[b-1]);return c},countTime:function(){var a=this;a.getGoodsTimer=window.setInterval(function(){a.MoniMove()},100)},touchmoveHandler:function(a){a.preventDefault()},
addGoods:function(a){ua(a)},addFloor:function(a,b){var c=[],e=!1,f={floorStyle:"addressFloor",poi:b};b=b||"未获取到位置信息";$.each(a,function(a,b){c.push(b);if(!e){if("act1"==b.floorStyle||"act2"==b.floorStyle||"act3"==b.floorStyle||"floorBanner"==b.floorStyle)e=!0,c.push(f);"product5"==b.floorStyle&&(e=!0,c.unshift(f))}});e||c.unshift(f);return c},setWXShareText:function(a){var b=window.location.href,c={title:"促销活动",desc:"京东到家，超值促销活动，优惠多多，抢购了！",link:b,imgUrl:"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png"};
a&&(c={title:a.title&&"undefined"!=a.title?a.title:"促销活动",desc:a.words||"京东到家，超值促销活动，优惠多多，抢购了！",link:b,imgUrl:a.imgUrl||"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png"});return c},jumpProtocol:function(a,b){var c=window.location.protocol,e=window.location.host,f=this;$.each(a,function(a,l){var h=$(l).attr("storeId")||"",n=$(l).attr("orgCode")||"",r=$(l).attr("skuId")||"",s=$(l).attr("promotionType")||"";switch(b){case "anchorStore":bb($(l),c+"//"+e+"/html/index.html#storeHome/shared:true/skuId:"+
r+"/storeId:"+h+"/orgCode:"+n+"/promotionType:"+s+"/fromAnchor:true/shared:true",{to:"store",params:{skuId:r,storeId:h,orgCode:n,promotionType:s,activityId:f.activityId,needAnchorSku:!0,cartType:"0",from:f.fromApp}});break;case "store":bb($(l),c+"//"+e+"/html/index.html#storeHome/shared:true/storeId:"+h+"/orgCode:"+n,{to:"store",params:{storeId:h,orgCode:n,activityId:f.activityId,from:f.fromApp}});break;case "goods":bb($(l),c+"//"+e+"/html/index.html#goodsDetails/shared:true/storeId:"+h+"/orgCode:"+
n+"/skuId:"+r,{to:"productDetail",params:{skuId:r,storeId:h,orgCode:n,from:f.fromApp}})}})},goToStore:function(a){var b=this.$(a.currentTarget).attr("storeId");a=this.$(a.currentTarget).attr("orgCode");window.location.href=O?"openApp.jddj://communication?body={'params':{'storeId':'"+b+"'},'to':'store'}":this.isH5pre+"#storeHome/storeId:"+b+"/orgCode:"+a},activityCoupons:function(a){this.backInFun=!1;a=this.$(a.currentTarget);3>=a.attr("data-status")&&(a=new J.redPack({couponCode:a.attr("couponCode"),
pageFrom:"activity"}),this.$(".scrolling").before(a.el))}});
ViewMethod.define("AddressForm",{events:{"focus input[name=mobile]":"clearmobilenumber","tap .v0 p":"locateAddress","click .um":"submitAddress","tap .un":"delAddress","click .ux .tab":"checkTab"},from:{locateaddress:"getLocateAddress"},initialize:function(a){var b=this;$("#container .loading").remove();var c=ea((a||{}).query||""),e=c.storeId,f=c.orgCode,g=c.orderId,l=c.poi||c.storeHome,c=
c.sharePage,q=b.data=a.data||{};l&&(l=decodeURI(l),b.showTit=!0,b.orderId=g,b.title=l);b.setContentView(h("dx")({insert:"gb",data:{showTit:l,superzone:q.superzone,name:b.name}}));b.userMobile=z("PDJ_H5_MOBILE");b.storeId=e;b.orgCode=f;b.sharePage=c;setTimeout(function(){b.$("#mobile").val(b.userMobile);var a=q.address,c=!!a;q.addr_type&&(b.addr_type=q.addr_type);q.sku&&(b.sku=q.sku);a&&(b.storeId&&b.checkAddrAndStore(_.extend({storeId:b.storeId},a)),b.addressid=a.id,b.renderDefaultValue(a,
c))},0)},renderDefaultValue:function(a,b){"newaddress"!=this.name&&a.name&&this.$("#name").val(a.name);"newaddress"!=this.name&&a.mobile&&this.$("#mobile").val(a.mobile);"newaddress"!=this.name&&a.addressDetail&&this.$("#addressDetail").val(a.addressDetail);(a.poi||a.title)&&this.$(".v0 i").text(a.poi||a.title);a.tags&&this.$(".ux").find('[tag="'+a.tags+'"]').addClass("check");this.$(".v0").find("p").removeClass("textColor");this.currentAddress=this.getAddress=a},
locateAddress:function(){this.$("input").blur();x({hash:"#locateaddress",keep:!0,data:{address:this.currentAddress||{}}})},getLocateAddress:function(a){a&&(this.$(".v0").find("p").removeClass("textColor"),this.currentAddress=a,this.$(".v0 i").html(a.title),this.storeId&&this.checkAddrAndStore(_.extend({storeId:this.storeId},a)))},returnData:function(){return this.addressData},clearmobilenumber:function(a){a=a.currentTarget;this._doneclear||(a.value="",this._doneclear=!0)},
checkAddrAndStore:function(a){var b=this;a.location&&(a.longitude=a.location.lng,a.latitude=a.location.lat);r(b,{functionId:"addresspdj/containsStoreId",body:{storeId:a.storeId,coordType:2,longitude:a.longitude,latitude:a.latitude}},"POST").done(function(a){a.exists?(b.$(".showTit").hide(),b.superzone=!1):(b.$(".showTit").show(),b.superzone=!0)}).fail(function(){})},showAddrPrompt:function(a,b,c){N({msg:b||"您填写的地址已超出<i class='title'>"+a+"</i>的配送范围。",button:[{text:c||"放弃购买",callback:function(){L()}},
{text:'<i class="title">修改地址</i>'}]})},delAddress:function(a){var b=this,c=b.$(a.target);if(c.hasClass("sending"))return!1;c.addClass("sending");N({msg:"确认删除该地址？",button:[{text:"取消",callback:function(){c.removeClass("sending")}},{text:"确认",callback:function(){C.removeAddress(b.addressid).done(function(a){n("地址删除成功");L()}).fail(function(a){n(a.msg)}).always(function(){c.removeClass("sending")})}}]})},checkTab:function(a){a=$(a.currentTarget);a.hasClass("check")?a.removeClass("check"):a.addClass("check").siblings(".tab").removeClass("check")}});
View.extend({borrow:"AddressForm",name:"newaddress",title:"新建收货地址",submitAddress:function(){var a=this;a.$("input").blur();var b=a.$(".um");if(!b.hasClass("sending")){var c=a.$("#mobile")[0];a._doneclear?c.setAttribute("pattern",c.getAttribute("_pattern")):c.removeAttribute("pattern");if(c=Ib(a.$(".uw")))n(c);else if(a.currentAddress){b.addClass("sending");var e=Kb(),c=a.currentAddress,f=a.$(".tab.check").attr("tag")||"";_.extend(e,{cityName:c.city,countyName:c.district,
poi:c.title,cityId:c.areaCode||c.cityCode||c.cityId,countyId:c.districtCode,coordType:2,longitude:c.longitude||c.location.lng,latitude:c.latitude||c.location.lat,tags:f});if(f)try{lg("user_action","1.0",{click_id:"selectaddrtag",selectaddrtag:1==f?"home":2==f?"company":"school"})}catch(g){}(function(){a.sharePage&&(e.sharePage=!0);"settle"==a.addr_type?yc(e).done(function(b){b=t.formatAddressData(b);a.addressData=b;L()}).fail(function(a){n(a.msg||"地址添加失败")}).always(function(){b.removeClass("sending")}):
C.addAddress(e).done(function(){if(jShopShare){var b=t.getLocalCurrent(),b=A("returnLink")+"?latitude="+b.latitude+"&longitude="+b.longitude+"&title="+encodeURIComponent(b.title)+(b.id?"&addressId="+b.id:"");w(b);return!1}!a.showTit&&n("添加成功");a.addr_type?"storeHome"==a.addr_type?x({hash:"#storeHome/storeId:"+a.storeId+"/orgCode:"+a.orgCode+"/isStoreHome:true"}):"goodDetail"==a.addr_type&&x({hash:"#goodsDetails/skuId:"+a.sku+"/storeId:"+a.storeId+"/orgCode:"+a.orgCode+"/isStoreHome:true"}):a.data&&
a.data.fugouData?a.data.callback(a.data.fugouData):setTimeout(function(){L()},1600)}).fail(function(b){!a.showTit&&n(b.msg||"地址添加失败")}).always(function(){b.removeClass("sending")})})()}else n("请选择配送地址")}},returnData:function(){this.addressData&&(this.addressData.superzone=this.superzone);return this.addressData}});
View.extend({borrow:"AddressForm",name:"editaddress",title:"编辑收货地址",submitAddress:function(){var a=this;a.$("input").blur();var b=a.$(".um");if(!b.hasClass("sending")){var c=
a.$("#mobile")[0];a._doneclear?c.setAttribute("pattern",c.getAttribute("_pattern")):c.removeAttribute("pattern");if(c=Ib(a.$(".uw")))n(c);else{b.addClass("sending");var e=Kb();if(c=a.currentAddress){var f=a.getAddress,g=a.$(".tab.check").attr("tag")||"";_.extend(e,{cityName:c.city||f.cityName,countyName:c.district||f.countyName,poi:c.title||f.poi,cityId:c.areaCode||c.cityCode||f.cityId,countyId:c.districtCode||f.countyId,coordType:2,longitude:c.longitude||c.location.lng||f.location.lng,
latitude:c.latitude||c.location.lat||f.location.lat,id:a.getAddress.id,tags:g});if(g)try{lg("user_action","1.0",{click_id:"selectaddrtag",selectaddrtag:1==g?"home":2==g?"company":"school"})}catch(l){}(function(){"settle"==a.addr_type?zc(e).done(function(b){a.addressData=e;L()}).fail(function(a){n(a.msg||"地址修改失败")}).always(function(){b.removeClass("sending")}):C.updateAddress(e).done(function(){!a.showTit&&n("修改成功");a.data&&a.data.fugouData?a.data.callback(a.data.fugouData):a.addr_type?"storeHome"==
a.addr_type?x({hash:"#storeHome/storeId:"+a.storeId+"/orgCode:"+a.orgCode+""}):"goodDetail"==a.addr_type&&x({hash:"#goodsDetails/skuId:"+a.sku+"/storeId:"+a.storeId+"/orgCode:"+a.orgCode+"/isStoreHome:true"}):L()}).fail(function(b){!a.showTit&&n(b.msg||"地址修改失败")}).always(function(){b.removeClass("sending")})})()}else n("请选择定位地址")}}}});
View.extend({name:"addresslist",events:{"click li":"ops","click a.toomany":"preventAdd"},title:"管理地址",initialize:function(){var a=this;C.fetchAddressList().done(function(b){var c=
C.getLocalAddressList();a.addresslist=b;var e=a.currentAddress=t.getLocalCurrent();a.setContentView(h("dx")({insert:"ga",addresslist:b||[],hasLogin:c?!0:!1,currentAddress:e}))})},backin:function(){this.initialize()},ops:function(a){if(!this._pendingOps){var b=$(a.target),c=$(a.currentTarget);a=c.attr("addressId");b.hasClass("ul")?(b=C.getAddressById(a,this.addresslist),x({hash:"#editaddress/addressid:"+a,data:{address:b}})):c.hasClass("selected")||(C.switchLocalDefaultAddress(a),
c.parent().find("li.selected").removeClass("selected"),c.addClass("selected"),this._pendingOps=!0,setTimeout(function(){L()},200))}},preventAdd:function(a){a.preventDefault();if(this._pendingOps)return!1;n("地址数已达到最大");return!1}});
View.extend({name:"cardbag",title:"我的卡包",events:{"click .mycard":"openmycard"},initialize:function(a){a||{};document.title="我的卡包";var b=this;b.setContentView(h("dx")({title:"我的卡包",loading:!0,includefooter:!1,pagename:"cardbag"}));console.log("test");r({functionId:"gateway/querycardpackage",
body:{}},"GET").done(function(a){b.$(".content").html(h("z")(a||{}));a.memberCardPackVOList.length?b.$(".content").html(h("z")(a||{})):b.$(".content").html(h("y")({}))}).fail(function(a){b.$(".content").html(h("y")({msg:a.msg}))})}});
View.extend({name:"cashier",title:"收银台",events:{"click .acx li":"changePayType","click .btnSubmit,.btnRefresh,.dai":"payState","click .btnFinish":"finishPay","click .ad1":"openWxFreePay","click .ad7":"closeMasker"},
initialize:function(a){a||(a={});a=a.queryParam;var b=!1;T("isToWX");T("newPayH5Url");T("newPayWxSdk");a&&"token"in a&&"appFrom"in a&&"source"in a&&(b=!0);this.token=b?decodeURIComponent(a.token):A("payToken");this.appFrom=b?decodeURIComponent(a.appFrom):A("from");this.setContentView(h("dx")({loading:!0}));this.initCashier()},initCashier:function(){var a=this;oc({token:a.token}).done(function(b){b||(b={});a.renderCashier(b)}).fail(function(b){"dashang"==a.appFrom&&lg("user_action","1.0",{clickid:"dashangInitFail",
user_pin:z("PDJ_H5_PIN")});a.setContentView(h("ft")({msg:b&&b.msg||""}))})},renderCashier:function(a){this.orderId=a.orderId;this.paySource=a.paySource;this.returnLink=window.returnAppLink=a.notifyUrl;this.openId=z("openid_pdj_jd")||a.openId;-1!=_.indexOf(Gb,this.paySource)&&O&&(window.returnAppLink="");if(a.countDownTime){this.lastTime=K(a.countDownTime);var b=this.getTime()}this.setContentView(h("a0")({initTime:b||"00:00",amount:a.amount,payWays:a.payWays,stationName:"vip"==
a.cashierType?"VIP会员":a.stationName,prescriptionTag:a.prescriptionTag,sharePacket:-1!=_.indexOf(De,this.paySource)?!0:!1,otherChannel:-1!=_.indexOf(Ee,this.paySource)?"dadamall":-1!=_.indexOf(Ya,this.paySource)?"dada":"",isJDApp:I,countDownTime:a.countDownTime}));(this.lastTime=this.countDownTime=a.countDownTime)&&-1!=a.countDownTime&&(this.start_time=(new Date).getTime(),this.startPayTime());this.returnFromWeChat();I&&this.$(".acx li").eq(0).hasClass("jd")&&1!=this.$(".acx li").eq(0).attr("freeTag")&&
this.getPayDescribe();u.setItem("currentOrderId",this.orderId)},changePayType:function(a){a=this.$(a.currentTarget);var b=a.attr("index");a.hasClass("dai")||(a.siblings().find("i").removeClass("ad4"),a.find("i").addClass("ad4"),this.payType=a.attr("payType"),this.freeTag=a.attr("freeTag"),0!=b&&("wx"==this.payType?this.$(".ad1").removeClass("none"):"jd"==this.payType&&this.getPayDescribe()))},payState:function(a){var b=this,c=b.$(a.currentTarget);c.hasClass("isShare")||(c.hasClass("dai")&&
c.addClass("isShare"),ma({token:b.token}).done(function(e,f){if(0==f.code)if(20==e)b.clearOrderData(),n("该订单已成功支付"),setTimeout(function(){-1!=_.indexOf(Fb,b.paySource)?window.location.href="openapp.jddj://communication/closeWeb":-1!=_.indexOf(Ya,b.paySource)?w(b.returnLink):-1!=_.indexOf(Lc,b.paySource)?O?window.location.href="openApp.jddj://communication?body={'params':{},'to':'orderList'}":w("#orderlist"):-1!=_.indexOf(Kc,b.paySource)?b.toPaySuccess():w(b.returnLink)},1E3);else if(c.hasClass("dai")){lg("user_action",
"1.0",{order_id:(b.orderId||"0").toString(),click_name:"other_pay"});var g=c.attr("title"),l=c.attr("desc"),h=c.attr("link");b.toShare(g,l,h)}else b.toPay(a);else n(f.msg)}).fail(function(a){n(a&&a.msg)}).always(function(){c.hasClass("dai")&&c.removeClass("isShare")}))},toPay:function(a){var b=this.$(a.currentTarget);if("yes"==b.attr("isSending")||b.hasClass("disable"))return!1;b.attr("isSending","yes");this.payType=this.$(".ad4").parent().attr("payType");a="h5";P?a="weixin":I?a="jd":O?a=
"daojia":-1!=_.indexOf(Ya,this.paySource)&&(a="dada");lg("user_action","1.0",{clickid:"payPlat",orderid:this.orderId,user_pin:z("PDJ_H5_PIN"),plat:a});-1!=_.indexOf(Gb,this.paySource)&&lg("user_action","1.0",{clickid:"dashangPay",orderid:this.orderId,user_pin:z("PDJ_H5_PIN")});"wx"==this.payType?P&&!this.openId?(N({msg:"请在右上角打开浏览器进行微信支付",button:[{text:"知道了",callback:function(){b.removeAttr("isSending")}}]}),lg("user_action","1.0",{clickid:"lose_openid",order_id:(this.orderId||"0").toString(),user_pin:z("PDJ_H5_PIN")})):
this.initWxPay():"jd"==this.payType?this.initJdPay():"zfb"==this.payType&&this.initAliPay()},initWxPay:function(){var a=this;pc({token:a.token,openid:a.openId,orderId:a.orderId,freeTag:a.freeTag}).done(function(b){"object"!=typeof b?a.getFreePayRecordStatus():-1!=_.indexOf(Be,a.paySource)?P?a.wxSdkPay(b):a.wxWebPay(b):-1!=_.indexOf(Fb,a.paySource)?a.djAppPay(b):-1!=_.indexOf(Ya,a.paySource)?a.dadaAppWxPay(b):-1!=_.indexOf(Ce,a.paySource)?a.wxWebPay(b):-1!=_.indexOf(Kc,a.paySource)?a.jdAppPay(b):a.wxWebPay(b)}).fail(function(b){b&&
"906"==b.code?setTimeout(function(){w(window.location.protocol+"//"+window.location.host+"/activity/vip/index.html")},1E3):n(b&&b.msg);lg("user_action","1.0",{clickid:"wxpayFail",orderid:a.orderId,user_pin:z("PDJ_H5_PIN"),msg:b&&b.msg,code:b.code})}).always(function(){setTimeout(function(){a.$(".btnSubmit,.btnRefresh").removeAttr("isSending")},2E3)})},initJdPay:function(){var a=this;qc({token:a.token,orderId:a.orderId}).done(function(b){b.orderId?I?a.jdSdkPay(b):a.jdWebPay(b):E&&I?x({hash:"#jdPay",
data:b}):E?a.jdWebPay(b):x({hash:"#jdPay",data:b})}).fail(function(b){n(b&&b.msg);lg("user_action","1.0",{clickid:"jdpayFail",orderid:a.orderId,user_pin:z("PDJ_H5_PIN"),msg:b&&b.msg,code:b.code})}).always(function(){setTimeout(function(){a.$(".btnSubmit,.btnRefresh").removeAttr("isSending")},2E3)})},initAliPay:function(){var a=this;rc({token:a.token,orderId:a.orderId}).done(function(b){-1!=_.indexOf(Ya,a.paySource)?a.dadaAppAliPay(b):a.zfbWebPay(b)}).fail(function(b){n(b&&b.msg);lg("user_action",
"1.0",{clickid:"zfbpayFail",orderid:a.orderId,user_pin:z("PDJ_H5_PIN"),msg:b&&b.msg,code:b.code})}).always(function(){setTimeout(function(){a.$(".btnSubmit,.btnRefresh").removeAttr("isSending")},2E3)})},wxSdkPay:function(a){var b=this;WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:a.appid,timeStamp:a.timestamp,nonceStr:a.noncestr,"package":"prepay_id="+a.prepayid,signType:"MD5",paySign:a.sign},function(a){"get_brand_wcpay_request:ok"==a.err_msg?b.toPaySuccess():n("微信支付失败")})},
wxWebPay:function(a){var b=this;I&&E?b.wxWebPayIframe(a):I&&!E?(Y("wxWebPay","yes"),w(a.mweburl)):E?(ze?Y("wxWebPay","yes"):setTimeout(function(){b.renderRePay()},1500),w(a.mweburl)):b.wxWebPayIframe(a)},jdAppPay:function(a){a={partnerId:a.partnerid,prepayId:a.prepayid,nonceStr:a.noncestr,timeStamp:a.timestamp,package:"Sign=WXPay",sign:a.sign};try{if(E&&Ha){var b={method:"openWeChatPay",params:JSON.stringify(a),callBackName:"window.jdAppWxPayBack"};window.webkit.messageHandlers.JDAppUnite.postMessage(b)}else window.JDAppUnite&&
window.JDAppUnite.openWeChatPay(JSON.stringify(a),"window.jdAppWxPayBack")}catch(c){lg("user_action","1.0",{clickid:"jdWxPayCatch",orderId:This.orderId,catchInfo:JSON.stringify(c),catchName:JSON.stringify(c.name),catchMessage:JSON.stringify(c.message)})}},wxWebPayIframe:function(a){var b=this;T("isToWX");Y("newPayWxSdk",a.mweburl);Y("newPayH5Url",window.location.href);var c=document.createElement("iframe");c.style.display="none";c.src="jdWxPayIframe.html";c.onload=function(){b.done_load?setTimeout(function(){$(c).remove()},
3200):b.done_load=!0};document.body.appendChild(c);setTimeout(function(){b.renderRePay()},1500)},jdWebPay:function(a){this.$(".cashierContainer").append(h("d1")(a));$("#batchForm").submit()},jdSdkPay:function(a){var b=this;try{a={type:"thirdPay",param:a,returnType:"callJS",success:function(a){lg("user_action","1.0",{clickid:"jdSDKPay",data:JSON.stringify(a),orderId:b.orderId});"string"==typeof a?-1!=a.indexOf("JDP_PAY_SUCCESS")?ma({token:b.token}).done(function(a,c){0==c.code&&20==a&&b.toPaySuccess()}):
-1==a.indexOf("JDP_PAY_CANCEL")&&(a.indexOf("JDP_PAY_FAIL"),b.renderRePay()):"object"==typeof a?"JDP_PAY_SUCCESS"==a.payStatus?ma({token:b.token}).done(function(a,c){0==c.code&&20==a&&b.toPaySuccess()}):"JDP_PAY_CANCEL"!=a.payStatus&&b.renderRePay():b.renderRePay()}},JDPaySDK.jdPay(a)}catch(c){lg("user_action","1.0",{clickid:"jdSDKPayCatch",orderId:b.orderId,catchInfo:JSON.stringify(c),catchName:JSON.stringify(c.name),catchMessage:JSON.stringify(c.message)}),b.renderRePay()}},zfbWebPay:function(a){this.$(".cashierContainer").append(h("d2")(a));
$("#zfbForm").submit()},djAppPay:function(a){if(E)wa?window.webkit.messageHandlers.MobileNavi.postMessage({method:"toWXPay",params:JSON.stringify({timestamp:a.timestamp,packageValue:"Sign=WXPay",appid:a.appid,sign:a.sign,partnerid:a.partnerid,prepayid:a.prepayid,noncestr:a.noncestr}),callBackName:null,callBackId:null}):toWXPay(a.timestamp,"Sign=WXPay",a.appid,a.sign,a.partnerid,a.prepayid,a.noncestr);else try{djJavaJSPay.toWXPay(a.timestamp,"Sign=WXPay",a.appid,a.sign,a.partnerid,a.prepayid,a.noncestr)}catch(b){lg("user_action",
"1.0",{clickid:"androidWXPay",data:JSON.stringify(a),error:JSON.stringify(b)})}},dadaAppWxPay:function(a){var b={appid:a.appid,partnerId:a.partnerid,prepayId:a.prepayid,nonceStr:a.noncestr,timeStamp:a.timestamp,packageValue:"Sign=WXPay",sign:a.sign},c=JSON.stringify(b);if(E){a={paySource:this.paySource,payType:"10",payInfo:b};try{window.connectWebViewJavascriptBridge(function(b){b.callHandler("ios_js_payment_center",a,function(a){a=JSON.parse(a).resultCode;0==a?w(window.returnAppLink):n(returnMsgForDadaAppWxPay(a))})})}catch(e){}}else window.nativeCode.androidWXPay(c)},
dadaAppAliPay:function(a){if(E){a={paySource:this.source,payType:"40",payInfo:a};try{window.connectWebViewJavascriptBridge(function(b){b.callHandler("ios_js_payment_center",a,function(a){a=JSON.parse(a).resultCode;9E3==a?w(window.returnAppLink):n(returnMsgForDadaAppAliPay(a))})})}catch(b){}}else window.nativeCode.androidAliPay('_input_charset="'+a._input_charset+'"&body="'+a.body+'"&it_b_pay="'+a.it_b_pay+'"&notify_url="'+a.notify_url+'"&out_trade_no="'+a.out_trade_no+'"&partner="'+a.partner+'"&payment_type="'+
a.payment_type+'"&seller_id="'+a.seller_id+'"&service="'+a.service+'"&subject="'+a.subject+'"&total_fee="'+a.total_fee+'"&sign="'+a.sign+'"&sign_type="'+a.sign_type+'"')},renderRePay:function(){var a=this;setTimeout(function(){a.$(".paySubmit").addClass("none");a.$(".payConfirm").removeClass("none")},500)},finishPay:function(){var a=this;ma({token:a.token}).done(function(b,c){0==c.code?20==b?-1!=_.indexOf(Gb,a.paySource)?n("打赏成功"):a.toPaySuccess():-1!=_.indexOf(Fe,a.paySource)?n("您还未完成支付，请重新支付"):
n("您的订单还未完成支付，请重新支付"):n(c.msg)}).fail(function(a){n(a.msg)})},toShare:function(a,b,c){var e=this;setTimeout(function(){fa({title:a,desc:b,link:c,imgUrl:"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png"})},10);if(P)e.$(".ad6").show(),setTimeout(function(){e.closeMasker()},5E3);else if(I){var f={title:a,content:b,shareUrl:c,imageUrl:"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png",iconUrl:"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png",shareActionType:"P",
channel:"Wxfriends,Wxmoments"};E?(f.shareUrl=encodeURIComponent(f.shareUrl),f.category="jump",f.des="share",f.type="111",f.isCallBack="Y",window.location.href="openApp.jdmobile://virtual?params="+JSON.stringify(f)):(f.callback="Y",f.eventId="",shareHelper.initShare(JSON.stringify(f)))}else O&&(E?wa?window.webkit.messageHandlers.MobileNavi.postMessage({method:"toPayShare",params:JSON.stringify({title:a,desc:b,shareUrl:c}),callBackName:null,callBackId:null}):toPayShare(a,b,c):window.djJava.toPayShare(a,
b,c))},closeMasker:function(){this.$(".ad6").hide()},startPayTime:function(){var a=this;clearInterval(a.paytimeCountDown);a.paytimeCountDown=setInterval(function(){a.renderPayTime(a.lastTime)},1E3)},renderPayTime:function(){var a=this;a.now_time=(new Date).getTime();a.lastTime=a.countDownTime-(a.now_time-a.start_time);0>=a.lastTime?(a.$(".payTime em").html("00:00"),a.$(".btnSubmit").addClass("disable"),clearInterval(a.paytimeCountDown),a.clearOrderData(),ma({token:a.token}).done(function(b,
c){0==c.code&&(20==b?-1!=_.indexOf(Lc,a.paySource)?O?window.location.href="openApp.jddj://communication?body={'params':{},'to':'orderList'}":w("#orderlist"):a.payOverTime():a.payOverTime())})):a.$(".payTime em").html(a.getTime())},getTime:function(){var a=new Date(this.lastTime),b=1==a.getMinutes().toString().length?"0"+a.getMinutes():a.getMinutes(),a=1==a.getSeconds().toString().length?"0"+a.getSeconds():a.getSeconds();return b+":"+a},getFreePayRecordStatus:function(){var a=this;a.$(".ad8").show();
setTimeout(function(){tc({token:a.token,orderId:a.orderId,paySource:a.paySource}).done(function(b){a.$(".ad8").hide();b=b||"";"SUCCESS"==b?O?w(window.returnAppLink):a.toPaySuccess():"PAY_FAIL"==b?N({msg:"余额不足，请选择其他支付方式",button:[{text:"确定",callback:function(){a.$(".btnSubmit").removeAttr("isSending").removeClass("disable")}}]}):O?window.location.href="openApp.jddj://communication?body={'params':{},'to':'orderList'}":w("#orderlist")}).fail(function(){a.$(".ad8").hide();O?window.location.href=
"openApp.jddj://communication?body={'params':{},'to':'orderList'}":w("#orderlist")})},2E3)},toPaySuccess:function(){T("wxWebPay");this.clearOrderData();clearInterval(this.paytimeCountDown);if(I&&E)if(-1!=this.returnLink.indexOf("#")){var a="#"+this.returnLink.split("#")[1];x({hash:a})}else w(this.returnLink);else w(this.returnLink)},openWxFreePay:function(){var a=this;sc({paySource:a.paySource,payWay:10}).done(function(a){Y("wxFreePay","yes");O?E?wa?window.webkit.messageHandlers.MobileNavi.postMessage({method:"getWXFree",
params:JSON.stringify({signUrl:a}),callBackName:null,callBackId:null}):getWXFree(a):window.djJava.getWXFree(a):w(a)}).fail(function(b){b&&"1000"==b.code&&a.initialize()})},returnFromWeChat:function(){var a=this;"yes"==z("wxWebPay")&&(T("wxWebPay"),ma({token:a.token}).done(function(b,c){0==c.code&&(20==b?-1==a.returnLink.indexOf("vipPayResult")&&a.toPaySuccess():a.renderRePay())}));"yes"==z("wxFreePay")&&(T("wxFreePay"),a.initialize())},getPayDescribe:function(){var a=this;uc({token:a.token,orderId:a.orderId}).done(function(b){b&&
0!=b.length&&(a.$(".ad2 span").html(b),a.$(".ad2").show())}).fail(function(){})},clearOrderData:function(){u.removeItem("settlementData");u.removeItem("currentOrderId")},payOverTime:function(){var a=this;N({title:"支付超时",msg:"您的订单因超时未支付已取消，请重新下单。",button:[{text:"知道了",callback:function(){lg("user_action","1.0",{clickid:"cashier_countdown_20160908"});-1!=_.indexOf(Fb,a.paySource)?window.location.href="openapp.jddj://communication/closeWeb":L()}}]})},leave:function(){T("wxWebPay");clearInterval(this.paytimeCountDown)},
returnData:function(){return{}}});
View.extend({name:"jdPay",title:"京东支付",events:{},initialize:function(a){a||(a={});var b=a.data;if(!b||"cashier"!==a.from||a.entrancepage)return setTimeout(function(){history.go(-2)},0);window._removeOrderResultPage=function(a){$("#jdpay_iframe").remove();x({hash:"#orderopresult/"+(a||"")})};a='<iframe frameborder="0" id="jdpay_iframe" src="javascript:;" style="width:100%;height:'+v.height()+'px;"></iframe>';this.$el.append(a);setTimeout(function(){var a=h("d1")(b),
e=document.getElementById("jdpay_iframe");try{var f=e.contentWindow.document;f.write(a);setTimeout(function(){f.getElementById("batchForm").submit()},9)}catch(g){n("支付失败")}},0)},backin:function(){history.go(-2)}});
View.extend({name:"channelPage",borrow:[Q.shareOperate],events:{"tap #refresh":"refresh","click [node-type=checkStoreActivity]":"checkStoreActivity","click [skipbykeys]":"skipWithKeys","tap .address_go":"closeAddressForm",'click [node-type="index-gotoStore"]':"indexGoStoreHome","click [node-type=index-checkStoreActivity]":"checkIndexStoreActivity",
"click .cy":"consigneeAddress","click [node-type=index-checknearbyStore]":"checknearbyStore"},from:{indexaddress:"fromAddress",newaddress:"newAddress"},initialize:function(a){var b=this;b.channelId=a.queryParam.channelId;b.oldHash=a.newHash||window.location.hash;b.setContentView(h("dx")({loading:!0}));fenxiang&&"channelPage"==sharePage?(fenxiang=!1,b.getLocatePosition({hash:"#indexaddress/type:channelShare",type:"channelShare"}).done(function(a){a.channelId=b.channelId;b.getChannelInfo(a,
!0,!0)})):t.getCurrentUse().done(function(a){b.checkCoords(a,!1)}).fail(function(a){x({hash:"#indexaddress",keep:!0,data:{currentaddress:{}}});setTimeout(function(){b.$(".content").append(h("fx")())},1E3)})},checkCoords:function(a,b){a.channelId=this.channelId;this.getChannelInfo(a,b)},fromAddress:function(a){this.checkCoords(a,"channelPage"==sharePage&&"channelShare"==a.type)},newAddress:function(){this.setContentView(h("dx")({loading:!0}));var a=t.getLocalCurrent();this.checkCoords(a,
a.sharePage?!0:!1)},refresh:function(){window.location.reload()},onhashchange:function(a){a!=this.oldHash&&(a=ea(a),this.initialize({queryParam:a}))},consigneeAddress:function(){x({hash:"#indexaddress"})},checkStoreActivity:function(a){a=this.$(a.currentTarget);var b=a.prev().children('[node-type="storeActivityList"]').children("li");a.find(".r6").toggleClass("r7");b.each(function(a){1<a&&$(this).toggle()})},publicSlide:function(){var a=this;if(a.$(".msWrap").length){a.index=
0;var b=setInterval(function(){var b=a.$(".msWrap").find("a");a.index++;a.index>=b.length&&(a.index=0);for(i=0;i<b.length;i++)a.$(b[i]).removeClass("show-miaosha");a.$(b[a.index]).addClass("show-miaosha")},1E3),c=location.hash;setInterval(function(){location.hash!=c&&clearInterval(b)},1E3)}},calculateLayout:function(){45<$(window).scrollTop()?this.$(".cy").hide():this.$(".cy").show()},unbindScroll:function(){var a="ontouchstart"in window,b=a?"touchstart":"mousedown",
c=a?"touchmove":"mousemove",a=a?"touchend touchcancel":"mouseup mouseout",e=$(window);e.unbind("scroll");e.unbind(b);e.unbind(c);e.unbind(a)},bindScroll:function(){var a=this,b="ontouchstart"in window,c=b?"touchstart":"mousedown",e=b?"touchmove":"mousemove",b=b?"touchend touchcancel":"mouseup mouseout",f=$(window);f.bind(c,function(a){a.stopPropagation()});f.bind(e,function(b){b.stopPropagation();a.calculateLayout()});f.bind(b,function(b){b.stopPropagation();f.bind("scroll",_.debounce(a.calculateLayout.bind(a),
150))})},moreRecommendStore:function(){this.hasNextRecommend&&!this.lockLoading&&this.ajaxStoreList()},ajaxStoreList:function(){var a=this;if(a.lockLoading||!a.hasNextRecommend)return!1;a.lockLoading=!0;qb(a,a.index,a.addrAjax,a.channelId).done(function(b){b||(b={});b.data&&b.data.data&&b.data.data.length?(a.lockLoading=!1,1==a.index&&(a.pages=Math.ceil(K(b.config.storeConfig.totalCount)/K(b.config.storeConfig.pageSize))),"product7"==b.data.floorStyle&&"tpl1"==b.data.styleTpl&&(1==a.index?a.$(".bf").append(h("bl")({data:b.data.data,
floorTitle:b.data.floorTitle||{},edge:b.data.edge})):a.$(".vo").append(h("gu")({data:b.data.data}))),a.index++,a.hasNextRecommend=a.index>a.pages?!1:!0,a.hasNextRecommend?a.$(".ct").addClass("cu"):(a.$(".ct").removeClass("cu"),a.$(".rf").show())):(a.hasNextRecommend=!1,a.$(".ct").removeClass("cu"))}).fail(function(){a.hasNextRecommend=
!1}).always(function(){a.lockLoading=!1})},getChannelInfo:function(a,b,c){var e=this;r(e,{functionId:"channel/getChannelDetail",body:{longitude:a.longitude,latitude:a.latitude,city:a.city||a.cityName,address:a.title||a.poi||a.address,coordType:"2",channelId:a.channelId}}).done(function(c){c||(c={});c.config&&c.config.gloabTitle&&e.setTitle(c.config.gloabTitle);c.data.length?(e.setContentView(h("dx")({insert:"a7",result:c,address:a,channelId:e.channelId})),e.insertSearchBar(),(1118==
e.channelId||1953==e.channelId||43==e.channelId||6==e.channelId)&&c.config&&c.config.isFlowerCake&&e.bindScroll(),e.$("[swipe]").each(function(a,b){var c=$(b),e="banner"==c.attr("floorStyle")?!0:!1;Ca(c,e?{auto:3E3}:{})}),e.publicSlide(),c.config.storeConfig&&c.config.storeConfig.recommendStore&&(e.index=1,e.addrAjax=t.getLocalCurrent()||{},R(e,e.moreRecommendStore,".vo li"),e.hasNextRecommend=!0,e.lockLoading=!1,e.ajaxStoreList()),b&&c.data.length&&(e.editAddressHead(e,a.title,
a.id,"channelShare"),setTimeout(function(){e.$(".we").addClass("topBarClass")},300))):e.setContentView(h("g0")({msg:c.msg||"很抱歉，附近暂无商家[0001]",addressId:a.id||"",allPage:!0,type:b?"channelShare":""}))}).fail(function(c){e.$(".scrolling").removeClass("topAddress");e.$(".storeHead").remove();c=h("g0")({msg:c&&c.msg,addressId:a.id||"",type:b?"channelShare":"",allPage:!0});e.$(".content").html(c).show()})},skipWithKeys:function(a){var b=$(a.currentTarget);a=
b.attr("keySkipData");var b=b.attr("userAction"),c="#indexSearchToStore";b&&(b=W(b),c=c+"/res_unit:"+b.res_unit+"/res_type:"+b.res_type+"/unit_index:"+b.unit_index);a=W(a);x({hash:c,keep:!0,data:a})},leave:function(){this.closeAddressForm();this.unbindScroll()},backin:function(){1118!=this.channelId&&1953!=this.channelId&&43!=this.channelId&&6!=this.channelId||this.bindScroll()},indexGoStoreHome:function(a){var b=a.target;a=$(a.currentTarget).attr("_href");if(-1!=b.className.indexOf("a2q")||
-1!=$(b).parents().indexOf("xa")||-1!=b.className.indexOf("xa"))return!1;$(b).parent().hasClass("adt")&&(a=$(b).parent().attr("_href"));x({hash:a})},checkIndexStoreActivity:function(a){a=this.$(a.currentTarget);var b=a.prev().children('[node-type="index-storeActivityList"]').children("li");a.find(".a2q").toggleClass("adx");b.each(function(a){1<a&&$(this).toggle()})},insertSearchBar:function(){var a=
new J.searchBar({cateIndex:!0,outStore:!0,view:this});this.searchFragment=a;this.$el.prepend(a.el);this.$(".scrolling").addClass("channelHasSearch")},checknearbyStore:function(a){a=this.$(a.currentTarget);a.find(".a2q").toggleClass("adx");var b=a.next();a.parent().toggleClass("aed");b.toggleClass("aeh");a.parents(".dr").toggleClass("aea");b=a.attr("data-storeId");a.parent().hasClass("aed")?
a.attr("onclick",'lg("user_action","1.0",{"clickid":"foldStore","storeId":"'+b+'","isFlold":"true"})'):a.attr("onclick",'lg("user_action","1.0",{"clickid":"foldStore","storeId":"'+b+'","isFlold":"false"})')}});
View.extend({name:"couponsList",title:"优惠券列表",className:"myCoupon",index:1,events:{"click .couponDetail":"couponDetail","tap .kl":"addCoupon","click .couponShowTag":"showCouponDesc"},initialize:function(){this.setContentView(h("dx")({loading:!0}));var a=this;a.lockLoading=
!0;Va(a,this.index,10,1).done(function(b,c){b||(b=[]);a.lockLoading=!1;var e=h("a9")({result:b,state:1});a.$(".content").html(e);a.couponsHidden();0==b.length&&a.$(".ic").show().addClass("guDing");0<b.length&&10>b.length&&a.$(".ic").show();Ac(a)}).fail(function(b){"201"==b.code?X():(a.lockLoading=!1,b=h("a9")({error:1,state:1}),a.$(".content").html(b),a.$(".ic").show().addClass("guDing"))});R(a,a.more,"li[couponCode]")},
more:function(){var a=this;!1===a.hasNextPage||a.lockLoading||(a.index++,a.lockLoading=!0,Va(a,a.index,10,1).done(function(b,c){var e=h("e5")({youhuiquanList:b});a.$(".coupons").append(e);a.couponsHidden();10>b.length&&(a.hasNextPage=!1,a.$(".ic").show())}).fail(function(){a.$(".ic").show()}).always(function(){a.lockLoading=!1}))},couponDetail:function(a){a.preventDefault();var b=$(a.target);a=b.parent().attr("showTitle");b=b.parent().attr("showtext");
(b=b.replace(/\n/g,"<br>"))&&ia({title:a,desc:b})},addCoupon:function(a){var b=this;N({className:"couponAlertWrap",title:"请输入您的兑换码",msg:'<input type="text" class="couponInput"  placeholder="请输入兑换码"/>',button:[{text:"取消",callback:function(){}},{text:'<span clstag="pageclick|keycount|my_coupons_sure_20160713|1">确认</span>',callback:function(){var a=$(".couponAlertWrap .couponInput").val();a?function(){Yd(b,a).done(function(){Va(b,1,10,1).done(function(a){b.lockLoading=!1;a=h("a9")({result:a,
state:1});b.$(".content").html(a)}).fail(function(){b.lockLoading=!1;var a=h("a9")({error:1,state:1});b.$(".content").html(a)})}).fail(function(a){a||(a={});n(a.msg)}).always(function(){setTimeout(function(){v.scrollTop(0)},0)})}():n("请输入兑换码");b._hasAdd=!0}}]})},returnData:function(){return this._hasAdd},showCouponDesc:function(a){a=$(a.currentTarget);a.find(".a8n").toggleClass("down");a.find(".a8k").toggleClass("show")},couponsHidden:function(){this.$(".a8k").each(function(){$(this).height()!=
$(this).next().height()&&($(this).css("margin-right","18px"),$(this).parent().parent().addClass("couponShowTag"),$(this).siblings(".a8n").show())})},leave:function(){$("body").removeClass("noCouponBg")}});
View.extend({name:"disabledCoupons",title:"不可用优惠卷",className:"disabledCoupon",index:1,events:{"tap .coupon-tap-ele":"disCouponsTap","click .couponDetail":"couponDetail","click .couponShowTag":"showCouponDesc"},initialize:function(){this.setContentView(h("dx")({loading:!0}));
Ac(this);this.state=3;this.lockLoading=!0;this.getCouponsList();R(this,this.more,"li[couponCode]")},more:function(){var a=this;!1===a.hasNextPage||a.lockLoading||(a.index++,a.lockLoading=!0,Va(a,a.index,10,a.state).done(function(b,c){var e=h("e5")({youhuiquanList:b});a.$(".coupons").append(e);10>b.length&&(a.hasNextPage=!1)}).always(function(){a.lockLoading=!1}))},disCouponsTap:function(a){this.state=$(a.currentTarget).attr("_state");this.index=1;this.getCouponsList()},getCouponsList:function(){var a=
this;Va(a,this.index,10,a.state).done(function(b,c){$("body").removeClass("noCouponBg");a.lockLoading=!1;var e=h("a9")({result:b,state:a.state});a.$(".content").html(e);a.couponsHidden();b&&!b.length&&$("body").addClass("noCouponBg")}).fail(function(){a.lockLoading=!1;var b=h("a9")({error:1,state:a.state});a.$(".content").html(b);$("body").addClass("noCouponBg")})},returnData:function(){return this._hasAdd},couponDetail:function(a){a.preventDefault();var b=$(a.target);a=
b.parent().attr("showTitle");b=b.parent().attr("showtext");(b=b.replace(/\n/g,"<br>"))&&ia({title:a,desc:b})},showCouponDesc:function(a){a=$(a.currentTarget);a.find(".a8n").toggleClass("down");a.find(".a8k").toggleClass("show")},couponsHidden:function(){this.$(".a8k").each(function(){$(this).height()!=$(this).next().height()&&($(this).css("margin-right","18px"),$(this).parent().parent().addClass("couponShowTag"),$(this).siblings(".a8n").show())})},
leave:function(){$("body").removeClass("noCouponBg")}});
View.extend({name:"daiPay",title:"求代付",events:{"tap .j9 button":"submit"},initialize:function(){var a=this;$(document)[0].title="求代付";a.token=A("token");a.orderId=A("orderId");a.openId=A("openId")||z("openid_pdj_jd")||"";a.setContentView(h("dx")({loading:!0}));a.toShare();Bd(a,{token:a.token,orderId:a.orderId}).done(function(b){var c=b||{};b=0==c.countDownTime?1:0;a.djPin=c.djPin;a.returnLink=c.resource;gc(a,{orderId:a.orderId,
encryptionPin:a.djPin,failure:b}).done(function(b){var f="";1==b.payState?f="1":2==b.payState?f="4":3==b.payState?f="3":4==b.payState&&(f="2");lg("user_action","1.0",{order_id:(a.orderId||"0").toString(),pay_status:f});if(1==b.payState){if(c.countDownTime)var g=new Date(parseInt(c.countDownTime)),f=1==g.getMinutes().toString().length?"0"+g.getMinutes():g.getMinutes(),g=1==g.getSeconds().toString().length?"0"+g.getSeconds():g.getSeconds(),g=f+":"+g;a.$(".content").html(h("cp")({amount:c.amount,
initTime:g,customerName:b.customerName,productList:b.orderProductList,prescriptionTag:c.prescriptionTag}));a.returnLink=c.resource;(a.lastTime=a.countDownTime=c.countDownTime)&&-1!=c.countDownTime&&(a.start_time=(new Date).getTime(),a.startCalculateTime())}else a.$(".content").html(h("cr")({payState:b.payState,productList:b.orderProductList}))}).fail(function(b){a.$(".content").html(h("fs")({msg:b&&b.msg}))})}).fail(function(b){a.$(".content").html(h("fs")({msg:b&&
b.msg}))})},startCalculateTime:function(){var a=this;clearInterval(a.paytimeCountDown);a.paytimeCountDown=setInterval(function(){a.renderPaytimeText(a.lastTime)},1E3)},renderPaytimeText:function(){this.now_time=(new Date).getTime();this.lastTime=this.countDownTime-(this.now_time-this.start_time);if(0>=this.lastTime)return this.payButtonState(),!1;var a=new Date(this.lastTime),b=1==a.getMinutes().toString().length?"0"+a.getMinutes():a.getMinutes(),a=1==a.getSeconds().toString().length?"0"+a.getSeconds():
a.getSeconds();this.$(".ju em").html(b+":"+a)},payButtonState:function(){this.$(".ju em").html("00:00");this.$(".j9 button").addClass("disable").html("支付失效");clearInterval(this.paytimeCountDown)},submit:function(a){var b=this,c=b.$(a.currentTarget);if("no"!=c.attr("isSending")||c.hasClass("disable"))return!1;lg("user_action","1.0",{order_id:(b.orderId||"0").toString(),click_name:"other_pay_submit"});c.attr("isSending","yes");gc(b,{orderId:b.orderId,encryptionPin:b.djPin}).done(function(a){1==
a.payState?P&&!b.openId?N({msg:"服务器繁忙，请重新打开链接进行微信支付",button:[{text:"知道了",callback:function(){WeixinJSBridge&&WeixinJSBridge.invoke("closeWindow",{},function(a){})}}]}):Cd(b,{token:b.token,openId:b.openId,orderId:b.orderId}).done(function(a){b.openId&&b.wxPay(a)}).fail(function(a){919==a.code?b.$(".content").html(h("cr")({payState:""})):n(a.msg||"网络开小差，请稍后再试哦~[0001]")}).always(function(){c.attr("isSending","no")}):b.$(".content").html(h("cr")({payState:a.payState}))}).fail(function(a){b.payButtonState()})},
wxPay:function(a){var b=this;WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:a.appid,timeStamp:a.timestamp,nonceStr:a.noncestr,"package":"prepay_id="+a.prepayid,signType:"MD5",paySign:a.sign},function(a){"get_brand_wcpay_request:ok"==a.err_msg&&w(b.returnLink)})},toShare:function(){var a=window.location.protocol+"//"+window.location.host+"/html/index.html?token="+encodeURIComponent(this.token)+"&orderId="+this.orderId+"#daiPay";fa({title:"土豪大大，跪求代付～",desc:"我在京东到家上挑好了商品，快帮我付个款吧～",
link:a,imgUrl:"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png"})}});
View.extend({name:"daiPaySuccess",title:"求付款",events:{},initialize:function(){var a=A("amount")||"0.00",b=A("payState");this.setContentView(h("dx")({loading:!0}));b?this.$(".content").html(h("cr")({payState:b})):this.$(".content").html(h("cq")({amount:a}))}});
View.extend({name:"evaluate",title:"全部评价",events:{"tap .evaluateStoreHome .tabNav li":"changeTab","tap .evaluateStoreHome .cuteWrap .cute":"goodBadTab",
"tap .evaluateStoreHome .filterEvaluate .RadioWrap":"filterComments","click .evaluateStoreHome .singleProWrap .singlePro":"singleProGo"},initialize:function(a){a=ea((a||{}).query||"").storeId||"";this.scrollTop=0;this.storeId=a;this.startTime=0;this.page=1;this.hasNextPage=!0;this.showGual=this.isLoading=!1;this.sending=!0;this.setContentView(h("dx")({loading:!0}));this.pushGoods();R(this,this.more,"ul.evaluateListWrap li")},more:function(){this.hasNextPage&&!this.isLoading&&(this.page++,this.pushGoods(!0))},
getWindowMinHeight:function(){return $(window).height()-80},DefaultPicBg:function(a,b){var c="";switch(a){case 1:c=1==b?"暂无有内容的评价":"暂无评价";break;case 2:c=1==b?"暂无有内容的好评":"暂无好评";break;case 3:c=1==b?"暂无有内容的中评":"暂无中评";break;case 4:c=1==b?"暂无有内容的差评":"暂无差评";break;default:c="暂无有内容的评价"}c='<div class="gx gy" style="min-height:'+this.getWindowMinHeight(-212)+'px"><div class="gz"><h5>'+c+"</h5><p>请查看其它评价吧！</p></div></div>";this.$(".evaluateListWrap").html(c)},ajaxEvaluate:function(a,
b){var c=this,e={},f=c.page=1;c.startTime=0;c.hasNextPage=!1;c.isLoading=!0;c.sending=!0;c.$(".switchLoading").show();var f=c.showGual?1:2,g;b?(e={storeId:c.storeId,qual:f,page:c.page,tagKey:a},g=xc):(e={storeId:c.storeId,type:a,qual:f,page:c.page},g=wc);g(c,e).done(function(e){e||(e={});c.result=e;c.isLoading=!1;0==c.startTime&&(e.evaluateList&&0<e.evaluateList.length?(c.$(".evaluateListWrap").html(h("aa")({data:e.evaluateList})),c.startTime=1,c.hasNextPage=c.page>=e.config.totalCount/
10||e.evaluateList&&10>e.evaluateList.length?!1:!0,c.loadEvaluateList(e)):b?c.DefaultPicBg():c.DefaultPicBg(a,f))}).fail(function(a){0==c.startTime?c.$(".evaluateListWrap").html(h("fw")({msg:(a||{}).msg||"出错啦"})):n(a.msg||"网络开小差，请稍后再试哦~[0001]")}).always(function(){c.sending=!1;c.$(".switchLoading").hide()})},getTabType:function(){var a;this.$(".tabNav li").each(function(){$(this).hasClass("selected")&&(a=$(this).data("type"))});return a},changeTab:function(a){if(!this.sending){a=
$(a.currentTarget);var b=a.data("type");a.addClass("selected").siblings("li").removeClass("selected");this.$(".cuteWrap .cute").removeClass("selected");this.ajaxEvaluate(b)}},getGoodBadTab:function(){var a;this.$(".cuteWrap .cute").each(function(){$(this).hasClass("selected")&&(a=$(this).data("type")+"")});return a},goodBadTab:function(a){if(!this.sending){a=$(a.currentTarget);var b=a.data("type")+"",c=a.data("tagname"),e=a.data("storeid");a.addClass("selected").siblings("span").removeClass("selected");
this.$(".tabNav li").removeClass("selected");lg("user_action","1.0",{clickid:"evaluate_label",label_content:""+c+"",store_id:""+e+""});this.ajaxEvaluate(b,!0)}},filterComments:function(a){a=$(a.currentTarget);var b,c=!1;this.getGoodBadTab()?(b=this.getGoodBadTab(),c=!0):(b=this.getTabType(),c=!1);this.$(".tabNav li").hasClass("selected");$(".inputRadio",a).hasClass("RadioSelected")?($(".inputRadio",a).removeClass("RadioSelected"),this.showGual=!1,c?this.ajaxEvaluate(b,!0):this.ajaxEvaluate(b),lg("user_action",
"1.0",{click_name:"evaluate_content_0",store_id:this.storeId})):($(".inputRadio",a).addClass("RadioSelected"),this.showGual=!0,c?this.ajaxEvaluate(b,!0):this.ajaxEvaluate(b),lg("user_action","1.0",{click_name:"evaluate_content_1",store_id:this.storeId}))},pushGoods:function(a){var b=this;if(b.isLoading||!b.hasNextPage)return!1;b.isLoading=!0;b.sending=!0;a||(b.page=1);var c=0,c=0==b.startTime?0:b.showGual?1:2,e={};b.getGoodBadTab()?(e={storeId:b.storeId,qual:c,page:b.page,tagKey:b.getGoodBadTab()},
a=xc):(e={storeId:b.storeId,type:b.getTabType()||1,qual:c,page:b.page},a=wc);b.$(".switchLoading").show();a(b,e).done(function(a){a||(a={});0==b.startTime?(b.$(".content").html(h("ab")({result:a,storeid:b.storeId})),b.startTime=1,(!a.evaluateList||0>=a.evaluateList.length)&&b.getTabType()&&b.DefaultPicBg(e.type,c)):b.$(".evaluateListWrap").append(h("aa")({data:a.evaluateList}));b.isLoading=!1;if(b.page>=a.config.totalCount/10||a.evaluateList&&10>a.evaluateList.length)b.hasNextPage=
!1;a.evaluateList&&0<a.evaluateList.length&&b.loadEvaluateList(a)}).fail(function(a){b.$(".content").html(h("fs")({msg:(a||{}).msg||"出错啦"}))}).always(function(){b.sending=!1;b.$(".switchLoading").hide()})},loadEvaluateList:function(a){this.hasNextPage?this.$(".ct").addClass("cv"):(this.$(".ct").removeClass("cv"),0!=a.config.totalCount&&(this.$(".evaluateListWrap").append(h("ar")({showmsg:"没有更多评价了"})),
this.$(".wd").show()))},singleProGo:function(a){this.scrollTop=$(window).scrollTop()},backin:function(a){a.from="goodsDetails";var b=this;setTimeout(function(){$(window).scrollTop(b.scrollTop)},100)}});
View.extend({name:"faxian",title:"发现",className:"a78",events:{"tap [_follow]":"follow"},initialize:function(){delete window.unReadFeedNum;var a=this;this.$el.html(h("dx")({includefooter:!0,pagename:"faxian"}));this.hasNextPage=!0;this.careType=1;t.getCurrentUse({justCoords:!0}).done(function(b){a.address=
b}).fail(function(){a.address={}}).always(function(){setTimeout(function(){a.fetch(0);R(a,a.more,"[faxianItem]")},0)});pa()},fetch:function(a){var b=this;if(!this._loading){if(!_.isNumber(a)){var c=this.$('[faxianItem="'+this.careType+'"]');a=K(Math.ceil(c.length/10))}this._loading=!0;de(this,a,this.careType,this.address).done(function(c){c||(c={});c.config||(c.config={});var f=h("ac")(c||{});b.$(".content").append(f);f=c.config;!(b.hasNextPage=f.hasNextPage)&&f.isHasNonCare&&1==b.careType&&
(b.careType=0,b.hasNextPage=!0,f=h("ad")({}),b.$(".content").append(f),setTimeout(function(){b.fetch(0)},0));!b.hasNextPage&&(0<a||0<(c.data||[]).length)&&b.$(".content").append('<div class="a7j">─── 没有更多动态啦 ───</div>')}).fail(function(c){c||(c={});201==c.code||"unlogin"==c.type?b.$(".content").html(h("fr")({msg:"登录后才能看哦"})):0==a&&(c=h("ac")({}),b.$(".content").html(c))}).always(function(){b._loading=!1})}},more:function(){this.hasNextPage?this.fetch():
window.clearInterval(this._scroll_IntervalId)},follow:function(a){var b=$(a.currentTarget);a=b.attr("storeId");Ia(this,{isFollow:!0,storeId:a}).done(function(){b.removeAttr("_follow").html("已关注").addClass("followed")}).fail(function(a){n((a||{}).msg||"网络错误")})}});
View.extend({name:"feedBack",title:"意见反馈",initialize:function(){var a=this;a.setContentView(h("dx")({insert:"ae",content:"我知道我们的业务还不成熟，还有许多需要改进的地方，所以我们需要您的吐槽来帮助我们发现问题。\n\n您的意见是我们前进的动力^_^"}));$d(a,{bannerType:"11"}).done(function(b){b&&
"我知道我们的业务还不成熟，还有许多需要改进的地方，所以我们需要您的吐槽来帮助我们发现问题。\n\n您的意见是我们前进的动力^_^"!=b&&a.$(".opinion_box").html(b)})},events:{"tap .fyh":"submit"},submit:function(){var a=this,b=a.checkContent();b&&Bc(a,{content:b}).done(function(){n("提交成功，感谢你的建议");a.$("#userFeedBack").val("");a.$("#feedBackMobile").val("")}).fail(function(a){n((a||{}).msg)})},checkContent:function(){var a=this.$("#userFeedBack").val().trim(),b=this.$("#feedBackMobile").val();return a?300<a.length?(n("反馈内容最多300个字"),""):ue.test(a)?b&&!/^0?\d{11}$/.test((b||
"").toString().trim())?(n("请输入正确的手机号"),""):b+a:(n("反馈内容不可以输入特殊字符"),d.reject()):(n("意见不能为空"),"")}});
View.extend({name:"goodsDetails",borrow:[Q.shareOperate],title:"商品详情",listInterval:"",events:{"tap .ge.sure":"addGoods","click .fo a,.ga":"anothergoods","click .e6,.gq":"showDetail","tap .fa":"showPrescription","tap .property-title":"showProperty","tap .select-property-content-1 li":"selectPropertyFirst","tap .select-property-content-2 li":"selectPropertySecond",
"tap .g1,.fs":"closeSelectAndPush","tap .g7.sure, .select-tuan-buy.sure":"closeSelectMask","tap .promotion-title":"togglePromotion","tap .address_go":"closeAddressForm","tap .ei .ek.sure":"addGoodsNew","tap .ei .Box span.add":"addGoodsAdd","tap .ei .Box span.reduce":"addGoodsReduce","click .af9":"anothergoods"},initialize:function(a){this.animate=!0;this.submitData={};this.getUrlDate(a);this.fromHash=a.from;
fenxiang&&"goodsDetails"==sharePage?(fenxiang=!1,a=A("channel")||"",w(window.location.protocol+"//"+window.location.host+"/activity/goodsShare/index.html?storeId="+this.storeId+"&orgCode="+this.orgCode+"&skuId="+this.skuId+"&channel="+a)):this.pushHtml(a)},getUrlDate:function(a){a=ea((a||{}).query||"");this.skuId=a.skuId;this.storeId=a.storeId;this.orgCode=a.orgCode;this.isPinTuan=parseInt(a.isPinTuan);this.hasGoodsShop=a.hasGoods||""},from:{shopSettlement:"settleErrorHandler"},settleErrorHandler:function(a,
b){this.minicart&&this.minicart.settleErrorHandler(a,b)},backin:function(a){a=a.from;"indexaddress"!=a&&this.weixinShare();this.closeSelectAndPush(a)},showProperty:function(){$(window).scrollTop("0");this.getProperty(this.data)},getProperty:function(a){var b=this;r(b,{functionId:"product/getProductSaleAttr",body:{skuId:a.skuId,storeId:a.storeId,orgCode:a.orgCode}}).done(function(c){c||(c={});b.submitData.serverSkuVOList=[{skuId:K(a.skuId),skuName:c.name}];a.skuState=c.buttonEnable;a.settlementModeName=
c.settlementModeName;c.groupSkuVO&&(a.djPrice=c.groupSkuVO.djPrice,a.groupPrice=c.groupSkuVO.groupPrice,a.groupPriceBuyButton=c.groupSkuVO.groupPriceBuyButton,a.djPriceBuyButton=c.groupSkuVO.djPriceBuyButton,a.isDjPriceBuy=c.groupSkuVO.isDjPriceBuy,a.isGroupPriceBuy=c.groupSkuVO.isGroupPriceBuy,a.productType=c.productType,a.from=1);b.$(".fq").remove();b.$el.append(h("al")(c));b.$(".fq").show();b.$(".a4q,.fp").hide();
b.$(".scrolling").removeClass("addBottom");if(1==c.productType||4==c.productType)c=new J.supermarketBottomCart({originPage:"detailselect",goodDate:a}),b.$(".ft").append(c.el);else if(6==c.productType||7==c.productType)c=new J.supermarketBottomCart({originPage:"tuan",goodDate:a}),b.$(".ft").append(c.el),b.$(".zv").removeClass("zw");b.animate&&($(".ft").addClass("g8"),b.animate=!1);b.$(".scrolling,.scroller").css({height:v.height(),
overflow:"hidden"})}).fail(function(a){n(a.msg)})},selectPropertyFirst:function(a){var b=this.currentData=this.data;a=$(a.currentTarget);this.$(".zu,.g6").removeClass("sure");if(a.hasClass("selected"))return!1;var c=this.$(".select-property-content-1"),e=this.$(".select-property-content-2");0==e.length?(a=a.attr("_skuId"),b.skuId=a,this.getProperty(b)):this.handerProperty(a,c,e,b)},selectPropertySecond:function(a){var b=this.currentData=this.data;a=$(a.currentTarget);
this.$(".zu,.g6").removeClass("sure");if(a.hasClass("selected"))return!1;var c=this.$(".select-property-content-2"),e=this.$(".select-property-content-1");this.handerProperty(a,c,e,b)},handerProperty:function(a,b,c,e){var f=c.find(".selected").length;a.attr("_saleId");var g=a.attr("_otherProperty");b.removeClass("on");a.addClass("selected").siblings().removeClass("selected");a=a.attr("_otherkey").split("-");b=a.length;c.find("li").removeClass("status-1").addClass("status-3");
for(var l=0;l<b-1;l++)this.$("li[_saleId='"+a[l]+"']").removeClass("status-3").addClass("status-1");0==f?(this.$(".zu,.g7").addClass("sure"),this.$(".danpin-order-button").text("立即购买"),this.$(".skill-order-button").text("立即下单"),this.$(".g7").text("加入购物车"),c.addClass("on")):(f=c.find(".selected").attr("_saleId"),-1<g.indexOf(f)?(c=g.indexOf(f)+f.length+1,f=g.indexOf(";",c),e.skuId=g.substring(c,f),this.$(".g7, .select-tuan-buy").attr("_skuid",
e.skuId),this.getProperty(e)):(this.$(".zu,.g7").addClass("sure"),this.$(".danpin-order-button").text("立即购买"),this.$(".skill-order-button").text("立即下单"),this.$(".g7").text("加入购物车"),c.find("li").removeClass("selected"),c.addClass("on"),this.submitData.serverSkuVOList=[{skuId:"",skuName:""}],this.$(".g7, .select-tuan-buy").attr("_skuid","")))},closeSelectMask:function(a){var b=this,c=b.$(a.currentTarget);if(""==c.attr("_skuid"))return!1;if(c.hasClass("ge"))var e=
setInterval(function(){c.hasClass("addSuccess")&&(b.closeSelectAndPush(),clearInterval(e),c.removeClass("addSuccess"))},100);else b.closeSelectAndPush()},closeSelectAndPush:function(a){var b=(this.currentData||{}).skuId||this.skuId;""==b&&(b=this.skuId);this.pushHtml({query:"goodsDetails/skuId:"+b+"/storeId:"+this.storeId+"/orgCode:"+this.orgCode,from:a});this.animate=!0},togglePromotion:function(a){a=$(a.currentTarget).find(".arrow");a.hasClass("es")?(a.removeClass("es").addClass("et"),
this.$(".ev").show(),this.$(".ey").hide()):(a.removeClass("et").addClass("es"),this.$(".ev").hide(),this.$(".ey").show())},showPrescription:function(a){a=this.$(a.currentTarget);a.hasClass("es")?(a.removeClass("es").addClass("et"),this.$(".f8").removeClass("f8").addClass("f9")):(a.removeClass("et").addClass("es"),this.$(".f9").removeClass("f9").addClass("f8"))},
anothergoods:function(a){delete this.fromHash;var b=$(a.currentTarget),c=jb(b.attr("href"),"#"),e=location.protocol+"//"+location.host+window.location.pathname+"#"+c;b.hasClass("af9")||(a.preventDefault(),this.pushHtml({query:c},null,e))},onhashchange:function(a,b){-1!==a.indexOf("goodsDetailDescription")?this.toGoodsDetailPage():b&&-1!==b.indexOf("goodsDetailDescription")?this.toOriginalPage():this.pushHtml({query:a},null,location.protocol+"//"+location.host+window.location.pathname+"#"+
a)},pushHtml:function(a,b,c){var e=this;b||e.getUrlDate(a);clearTimeout(e.listInterval);e.submitData.storeId=K(e.storeId);e.submitData.orgCode=e.orgCode;var f=t.getLocalCurrent()||{};e.setContentView(h("dx")({loading:!0}));e.data={skuId:e.skuId,storeId:e.storeId,orgCode:e.orgCode,longitude:f.longitude||0,latitude:f.latitude||0,type:2};Sd(e,e.data).done(function(b){b||(b={});!b.isInScope&&"settlementGoods"==e.fromHash&&f.longitude&&N({className:"l",msg:"您的收货地址已超出门店配送范围哦",button:[{text:"知道了",
callback:function(){}}]});e.goodsResult=b;b.hasSaleAttr?e.$el.addClass("goodsDetails"):e.$el.removeClass("goodsDetails");var l=!0;if(2==b.productType||5==b.productType||7==b.productType)l=!1;b.groupSkuVO&&(e.data.djPrice=b.groupSkuVO.djPrice,e.data.groupPrice=b.groupSkuVO.groupPrice,e.data.groupPriceBuyButton=b.groupSkuVO.groupPriceBuyButton,e.data.djPriceBuyButton=b.groupSkuVO.djPriceBuyButton,e.data.isDjPriceBuy=b.groupSkuVO.isDjPriceBuy,e.data.isGroupPriceBuy=b.groupSkuVO.isGroupPriceBuy,e.data.productType=
b.productType,e.data.from=0);b.memberConfigInfo&&(b.memberConfigInfo.vipPriceColorCode=b.memberConfigInfo.colorCode,b.memberConfigInfo.vipPriceIcon=b.memberConfigInfo.icon);e.submitData.serverSkuVOList=[{skuId:K(e.skuId),skuName:b.name}];e.submitData.storeName=(b.storeInfo||{}).storeName||"";e.isPinTuan=b.groupSkuVO?1:0;e.currentUrl="";if(c)e.currentUrl=c;else{var q=xa();e.currentUrl=location.protocol+"//"+location.host+window.location.pathname+"#"+q}e.weixinShare();3!=b.productType&&4!=b.productType&&
5!=b.productType||!b.miaoshaInfo||1!=b.miaoshaInfo.miaoShaSate||(q=K(b.miaoshaInfo.miaoshaRemainTime/1E3),b.second=La(K(q%60)),b.hour=La(K(q/3600)),b.minute=La(K((q-3600*b.hour)/60)),Tc(b.miaoshaInfo.miaoshaRemainTime/1E3,e),e.listInterval=setTimeout(function(){if(0==$("body").has(e.$el).length)return clearTimeout(e.listInterval),!1;e.pushHtml(a)},b.miaoshaInfo.syntime));e.$(".content").html(h("af")(b));e.$(".scrolling").addClass("addBottom");0<b.image.length&&e.getStoreBanner(b.image);
b.detailInfo&&(e.fragment=new J.goodsDetailDescription({result:b.detailInfo.h5HtmlText,el:e.$(".fi")}));b.isRemind&&Td(e,e.data).done(function(a){a||(a={});a=a.dimensionsResultVOList||[];a=a[0]||{};for(var b=a.recommendSkuVOList||[],c=b.length,f=Math.ceil(c/6),g=[],q=0;q<f;q++){var n={};n.data=q==f-1?b.slice(6*q,c):b.slice(6*q,6*(q+1));$.map(n.data,function(a,b){a.memberConfigInfo&&(a.memberConfigInfo.vipPriceColorCode=a.memberConfigInfo.colorCode,a.memberConfigInfo.vipPriceIcon=a.memberConfigInfo.icon)});
g.push(n)}c?e.$(".fk").html(h("ak")({result:g,showcartCount:l,showCart:l,skuDate:"goodsdetails_tj_sku",cartDate:"goodsdetails_tj_cart",title:a.dimensionName})):e.$(".fk").hide();var r=e.$(".fk").find(".fm");setTimeout(function(){Ca(r)},0)}).fail(function(){e.$(".fk").hide()});3==b.productType?e.$el.append(h("ah")(b)):2==b.productType||5==b.productType?e.$el.append(h("ai")(b)):
6==b.productType||7==b.productType?(b=new J.supermarketBottomCart({originPage:"tuan",goodDate:e.data}),e.$el.append(b.el)):(b=document.createElement("div"),e.$el.append(b),e.minicart=new J.minicart({el:b,view:e,storeId:e.storeId,orgCode:e.orgCode,storeName:e.submitData.storeName,showup:"shopSettlement"==a.from||"settlementGoods"==a.from||e.hasGoodsShop?!0:!1}),e.listenTo(e.minicart,"add",function(a){var b=e.$(".Box span.add");b.attr("_skuid")==a&&(b.addClass("AddCartAdd"),Ga(b[0]))}).listenTo(e.minicart,
"minus",function(a){var b=e.$(".Box span.reduce");b.attr("_skuid")==a&&(b.addClass("AddCartReduce"),ya(b[0]))}).listenTo(e.minicart,"clear",function(){e.$(".Box label").html("0").closest(".ei").removeClass("switchHide")}))}).fail(function(a){e.$(".content").html(h("fs")({msg:a&&a.msg}));e.$(".scrolling").removeClass("addBottom")})},addGoods:function(a){$(a.currentTarget).hasClass("tuijian")?ua(a,this.minicart):ua(a)},addGoodsNew:function(a){var b=$(a.currentTarget);b.addClass("hideAddCart");
b.siblings(".Box").find(".reduce").addClass("AddCartReduce");ua(a,this.minicart)},addGoodsAdd:function(a){$(a.currentTarget).addClass("AddCartAdd");ua(a,this.minicart)},addGoodsReduce:function(a){$(a.currentTarget).addClass("AddCartReduce");Sa(a,this.minicart)},weixinShare:function(){var a=A("channel")||"",a=window.location.protocol+"//"+window.location.host+"/activity/goodsShare/index.html?storeId="+this.storeId+"&orgCode="+this.orgCode+"&skuId="+this.skuId+"&channel="+a;fa({title:(this.goodsResult||
{}).name||"好友为你分享一个商品",desc:(this.goodsResult||{}).subtitle||"京东到家，为你而来，足不出户，即刻到家！",link:(this.goodsResult||{}).shareProductUrl||a,imgUrl:(this.goodsResult.image[0]||{}).share})},getStoreBanner:function(a){a=a||[];var b=this.$(".dz");b.html(h("aj")(a));setTimeout(function(){Ca(b,{indicator:!1,onStep:function(a){$(".gr .bigFont").html(a)}})},0)},showDetail:function(a){location.hash=kb("goodsDetailDescription")},toGoodsDetailPage:function(){$(window).scrollTop("0");
this.$(".scroller").scrollTop("0");this.$(".fi").show();this.$(".dx").hide()},toOriginalPage:function(){$(window).scrollTop("0");this.$(".scroller").scrollTop("0");this.$(".fi").hide();this.$(".dx").show()},leave:function(){clearTimeout(this.listInterval);this.closeAddressForm()},showCommentList:function(a){$(a.currentTarget).hasClass("no-comment-more")||x({hash:"detailCommentList/skuId:"+this.skuId+"/storeId:"+this.storeId})},returnData:function(){return!1}});
View.extend({name:"grabList",borrow:[Q.shareOperate],title:"秒杀活动",grabIndex:0,countTime:0,isFirst:!0,listInterval:"",events:{"tap .address_go":"closeAddressForm"},initialize:function(a){var b=this;b.isBackIn=!0;b.options=a;var c=(a||{}).queryParam||"",e=a.longitude||c.longitude||"";a=a.latitude||c.latitude||"";c=decodeURIComponent(c.city||"")||"";b.setContentView(h("dx")({loading:!0}));if(fenxiang&&"grabList"==sharePage)fenxiang=!1,b.getLocatePosition("","",function(){b.$(".content").html(h("fy")({msg:"没有获取到您的位置"}));
setTimeout(function(){x({hash:"#indexaddress"})},0)}).done(function(a){b.renderList(a,!0,!0)});else{if(!e||!a)return b.$(".content").html(h("fy")({msg:"没有获取到您的位置"})),!1;b.renderList({longitude:e,latitude:a,city:c,coordType:2},"")}},renderList:function(a,b,c){var e=this;e.data=_.extend(a,{coordType:2});e.$(".content").html(h("c9")({}));setTimeout(function(){e.getGrabList(b,c);e.isBackIn=!0},1)},from:{indexaddress:"indexaddress",newaddress:"newaddress",storeHome:"fromStoreHandler"},
fromStoreHandler:function(){var a=this;setTimeout(function(){window.scrollTo(1,1);a.initialize(a.options)},10)},indexaddress:function(a){this.isBackIn=!1;this.changeAddrInit();this.checkCityOpen(a,!1)},newaddress:function(){this.changeAddrInit();this.isBackIn=!1;var a=t.getLocalCurrent();this.checkCityOpen(a,!1)},changeAddrInit:function(){this.setContentView(h("dx")({loading:!0}));this.countTime=0;this.isFirst=!0;this.grabeTime=""},checkCityOpen:function(a,b){this.renderList(a,!0,b)},getGrabList:function(a,
b){var c=this,e=c.data,f=c.$(".grabWrap").addClass("grab_cur");r(c,{functionId:"grab/grabList",body:{longitude:e.longitude,latitude:e.latitude,coordType:2,timeId:e.timeId||"",city:e.city||""}}).done(function(e,l){if(e)if(c.$(".te").before(h("c5")()),e.grabBanners?(c.getBanner(e.grabBanners),c.hasBanner=!0):c.hasBanner=!1,e.miaoShaList&&0!=e.miaoShaList.length){for(var q=0,n=e.miaoShaList.length;q<n;q++)e.miaoShaList[q]=_.extend(e.miaoShaList[q],{newMiaoSha:!0});f.html(h("c8")(e));
c.$(".te").removeClass("loading");setTimeout(function(){c.goodsEnd()},0);a&&(c.editAddressHead(c,c.data.title,c.data.id,""),b&&"grabList"==sharePage&&c.checkTwoAddressDistence(c,c.data,""))}else f.html(h("fs")({msg:e.noProductMsg||"暂无优惠商品，去其它场次逛逛吧[0001]",other_tip_bg:"tf",btnHref:"#index",btnText:"返回首页刷新"}));else f.html(h("fs")({msg:l.msg,other_tip_bg:"tf",hideBtn:!0}))}).fail(function(b){a?c.setContentView(h("g0")({msg:b.msg||
"网络开小差，请稍后再试哦~[0001]",allPage:!0})):"network"==b.type||117==b.code?f.html(h("fs")({msg:b.msg||"网络开小差，请稍后再试哦~[0001]",btnHref:"#index",btnText:"返回首页刷新"})):f.html(h("fs")({msg:b.msg,other_tip_bg:"tf",btnHref:"#index",hideBtn:""==c.timeId?!1:!0,btnText:"返回首页刷新"}))})},goodsEnd:function(){var a=window.innerHeight-this.$(".td").height()-this.$(".tc").eq(this.grabIndex).height();this.$(".tr").eq(this.grabIndex).height()>a?this.$(".grab_cur").find('[node-type="seckillGoodsEnd"]').show():
this.$(".grab_cur").find('[node-type="seckillGoodsEnd"]').hide()},getBanner:function(a){a=a||[];var b=this.$(".ta");b.html(h("c6")(a)).css("min-height","inherit");Ca(b,{auto:3E3})},leave:function(){this.closeAddressForm()}});
View.extend({name:"helpCenter",title:"帮助中心",events:{"tap dt[biaoti]":"toggleList"},initialize:function(){var a=this;r(void 0,{functionId:"me/helpPage"},{cache:!0}).done(function(b){a.setContentView(h("dx")({insert:"az",
list:b}))})},toggleList:function(a){this.$("dl[neirong]").not($(a.currentTarget).parent("dl[neirong]").toggleClass("cur")).removeClass("cur")}});
View.extend({name:"homeCategorySearch",title:"分类",events:{"click .wu":"fetchTabList"},$contentWrap:null,initialize:function(a){this.setContentView(h("dx")({includefooter:!0,pagename:"homeCategorySearch"}));var b=this;b._hasLogin=!1;a=new J.searchBar({cateIndex:!0,outStore:!0,view:b});b.searchFragment=a;b.$el.prepend(a.el);b.$(".scrolling").addClass("hasSearch");
b.$(".content").html(h("b0")());$contentWrap=this.$(".x3");t.getCurrentUse().done(function(a){b.loadTabList(a)}).fail(function(a){b.$(".loading").remove();"network"==a.type||"117"==a.code?$contentWrap.html(h("fs")({msg:a.msg})):$contentWrap.html(h("fs")({msg:"附近没有发现门店，我们正在努力覆盖中[0001]",other_tip_bg:"xn",btnHref:"#index",btnText:"去首页定位"}))});pa()},addressHandler:function(a){a||(a={});this.loadTabList(a)},loadTabList:function(a){var b=
this,c=a.longitude,e=a.latitude,f=a.cityId||a.areaCode;a.cityId&&(b._hasLogin=!0);r(b,{functionId:"homeSearch/tabCateList",body:{longitude:c,latitude:e,cityId:f}},"GET").done(function(a,c){b.tabLists=a.firstTabCate||[];0<b.tabLists.length?(b.$(".scrolling").before(h("b1")(b.tabLists)),setTimeout(function(){b.$(".wv").trigger("click")},0)):$contentWrap.html(h("fs")({msg:"附近没有发现门店，我们正在努力覆盖中[0001]",other_tip_bg:"xn",btnHref:"#index",btnText:"去首页定位"}))}).fail(function(a){"network"==
a.type||"117"==a.code?$contentWrap.html(h("fs")({msg:a.msg})):500==a.code?$contentWrap.html(h("fs")({msg:"附近没有发现门店，我们正在努力覆盖中[0001]",other_tip_bg:"xn",btnHref:"#index",btnText:"去首页定位"})):$contentWrap.html(h("fs")({msg:a.msg||"附近没有发现门店，我们正在努力覆盖中[0001]",other_tip_bg:"xn",btnHref:"#index",btnText:"去首页定位"}))}).always(function(){b.$(".loading").remove()})},timer:null,fetchTabList:function(a){function b(){clearTimeout(this.timer);n<r&&(s<
t?(s++,n=Math.ceil(Za(s,v,u,t)),this.timer=setTimeout(b,25)):(s=t,clearTimeout(this.timer)));c.scrollTop(n)}var c=this.$(".ws"),e=c.scrollTop(),f=$(a.currentTarget);a=f.attr("homecateId");var g=this.tabLists,l=g.length,q=[];this.$(".loading").remove();this.$(".wu").removeClass("wv");f.addClass("wv");var n=f.index()*f.height(),q=c.height(),r=this.$(".wu").length*f.height()-q;clearTimeout(this.timer);var s=
0,t=25,v=e,u=n-v;b();if(g&&0<l)for(e=0;e<l;e++){if(g[e].catId==a){q=g[e].groupList;q.length?($(window).scrollTop(0),this.$(".wt").html(h("b2")(q))):$contentWrap.html(h("fs")({msg:"附近没有发现门店，我们正在努力覆盖中[0001]",other_tip_bg:"yi",btnHref:"#index",btnText:"去首页逛逛"}));break}}else $contentWrap.html(h("fs")({msg:"附近没有发现门店，我们正在努力覆盖中[0001]",other_tip_bg:"yi",btnHref:"#index",btnText:"去首页逛逛"}))}});
View.extend({name:"invoice",title:"发票",events:{"click .invoice":"contentClickHandle",
"input .enterprise.ac1":"inputInvoiceTitleHandle","input .person.ac1":"inputInvoiceTitleHandle","click .abw":"switchInvoiceTypeHandle","click .ac2":"clearDutyNoHandle","click .ac3":"saveInvoiceHandle","click .delete":"deleteInvoiceHandle","click .io":"dutyNoTipHandle","input textarea.ac1,.invoice-duty-no,.invoice-email-input":"changeHandle","focus textarea.ac1,.invoice-duty-no,.invoice-email-input":"focusHandle",
"blur textarea.ac1,.invoice-duty-no,.invoice-email-input":"blurHandle"},initialize:function(a){var b=this;a.data&&u.setItem("invoiceInfo",a.data);var c=u.getItem("tempInvoiceInfo")||{},e=a.data||u.getItem("invoiceInfo");this.invoiceType=e.titleType;this.invoiceInfo=e;this.type=a.queryParam.type;this.isAllow=u.getItem("isAllow")||"yes";this.prevIsDutyNo=!1;b.hash=location.hash;this.setContentView(h("bv")(_.extend(e,c)));setTimeout(function(){var a=b.$((1==e.titleType?".enterprise":
".person")+".ac1")||[];a[0].scrollHeight>a.height()&&a.height("40px")},100)},inputInvoiceTitleHandle:function(a){var b=$(a.currentTarget);0>=a.currentTarget.scrollTop&&b.height("20px");a.currentTarget.scrollHeight>b.height()&&b.height("40px")},clearDutyNoHandle:function(a){a=$(a.currentTarget);var b=a.prev();b.hasClass("invoice-duty-no")||b.hasClass("invoice-email-input")||(a.css("opacity",0),b.val(""))},inputEmailHandle:function(a){a=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;
var b=this.$(".invoice-email-input").val();return b&&!a.test(b)?(n("邮箱格式错误"),!1):!0},switchInvoiceTypeHandle:function(a){this.$(".abw").removeClass("checked");a=$(a.currentTarget);a.addClass("checked");1==(this.invoiceType=a.attr("invoiceType"))?(this.$(".enterprise").show(),this.$(".enterprise-clear").show(),this.$(".person").hide(),this.$(".person-clear").hide(),this.$(".ac0").show()):(this.$(".enterprise").hide(),this.$(".enterprise-clear").hide(),this.$(".person").show(),this.$(".person-clear").show(),
this.$(".ac0").hide());this.$(".ac2").css("opacity",0)},saveInvoiceHandle:function(a){var b=this,c="",c=1==this.invoiceType?this.$(".enterprise.ac1").val()||"":this.$(".person.ac1").val()||"";a=this.$(".invoice-duty-no").val()||null;var e=this.$(".invoice-email-input").val()||"",f="";c.trim()?1!=this.invoiceType||a?e.trim()?this.inputEmailHandle()&&(c={titleType:this.invoiceType,titleContent:c,userEmail:e},1==this.invoiceType&&(c.taxNum=a),this.invoiceInfo.invoiceId&&
(c.invoiceId=this.invoiceInfo.invoiceId),("insert"==this.type?Jd:Ld)(this,c).done(function(a){b.isAllow="yes";"insert"==b.type&&(b.invoiceId=a.invoiceId);L()}).fail(function(a){n(a.msg);lg("user_action","1.0",{clickid:"save",modifytype:"insert"==b.type?1:2,savechecktype:a.msg})})):f="请输入电子邮箱":f="请输入纳税人识别号":f=0==this.invoiceType?"请输入抬头名称":"请输入企业名称";f&&(n(f),lg("user_action","1.0",{clickid:"save",modifytype:"insert"==this.type?1:2,savechecktype:f}))},changeHandle:function(a){this.isAllow="no";a=$(a.currentTarget);
""==a.val()?a.next(".ac2").css("opacity",0):a.next(".ac2").css("opacity",1);a.hasClass("invoice-duty-no")&&this.$(".io").hide()},focusHandle:function(a){a=$(a.currentTarget);""==a.val()?(a.next(".ac2").css("opacity",0),a.hasClass("invoice-duty-no")&&this.$(".io").show()):(a.hasClass("invoice-duty-no")&&this.$(".io").hide(),a.next(".ac2").css("opacity",1))},blurHandle:function(a){a=$(a.currentTarget);a.next(".ac2").css("opacity",
0);a.hasClass("invoice-duty-no")&&this.$(".io").show();a.hasClass("invoice-email-input")},deleteInvoiceHandle:function(a){var b=this;Kd(this,{invoiceId:this.invoiceInfo.invoiceId}).done(function(a){b.isAllow="yes";b.invoiceInfo.invoiceId=b.invoiceId=null;L()}).fail(function(a){n(a.msg)})},dutyNoTipHandle:function(){var a=this.$(".io").attr("taxnumtip")||"[]";lg("user_action","1.0",{click_id:"seetaxidicon"});Pa({desc:JSON.parse(a)},"w")},leave:function(){var a=
this;if("no"==a.isAllow)return N({title:"提示",msg:"确认放弃填写发票信息吗？",button:[{text:"取消",callback:function(){a.isAllow="no";var b=a.$("textarea.ac1").val()||"",c=a.$(".invoice-duty-no").val()||null,e=a.$(".invoice-email-input").val()||"";u.setItem("tempInvoiceInfo",{titleType:a.invoiceType,titleContent:b,taxNum:c,userEmail:e});u.setItem("isAllow",a.isAllow);$(".c").unbind("click");location.assign(a.hash);lg("user_action","1.0",{clickid:"aborteditinvoice",type:0})}},{text:"确认",callback:function(){a.isAllow=
"yes";$(".c").unbind("click");lg("user_action","1.0",{clickid:"aborteditinvoice",type:1})}}]}),$(".c").bind("click",function(b){a.isAllow="no";$(".c").unbind("click")}),u.removeItem("tempInvoiceInfo"),u.removeItem("InvoiceInfo"),u.removeItem("isAllow"),a.isAllow||"no"},returnData:function(){return{isAllow:this.isAllow,invoiceId:this.invoiceId}},contentClickHandle:function(a){a=$(a.target);this.prevIsDutyNo&&a.hasClass("duty-no-clear")&&""!=a.prev().val()?
(a.prev().val(""),this.prevIsDutyNo=!1,this.prevIsEmail=a.hasClass("invoice-email-input")||a.hasClass("email-clear")):a.hasClass("duty-no-clear")?(this.$(".io").show(),this.dutyNoTipHandle(),this.prevIsDutyNo=!1,this.prevIsEmail=a.hasClass("invoice-email-input")||a.hasClass("email-clear")):this.prevIsEmail&&a.hasClass("email-clear")&&""!=a.prev().val()?(a.prev().val(""),this.prevIsEmail=!1,this.prevIsDutyNo=a.hasClass("invoice-duty-no")||a.hasClass("duty-no-clear")):this.prevIsEmail?
(a.hasClass("invoice-email-input")||a.hasClass("email-clear")||this.inputEmailHandle(),this.prevIsEmail=!1,this.prevIsDutyNo=a.hasClass("invoice-duty-no")||a.hasClass("duty-no-clear")):(this.prevIsDutyNo=a.hasClass("invoice-duty-no")||a.hasClass("duty-no-clear"),this.prevIsEmail=a.hasClass("invoice-email-input")||a.hasClass("email-clear"))}});
View.extend({name:"invoicelist",title:"发票",events:{"click .m5":"newInvoiceHandle","click .edit":"editInvoiceHandle","click .abv":"useIvoiceHandle",
"click .ms":"invoiceInfoAlert","click .y5":"fetch"},from:{invoice:"invoiceBack"},initialize:function(a){if(!a.data)return L();this.invoiceInfo=a.data;this.fetch()},fetch:function(){var a=this;a.setContentView(h("f7")());r(void 0,{functionId:"invoiceweb/getInvoiceInfo",body:{}},"GET").done(function(b){a.taxNumTip=b.taxNumTip;b.invoiceId=a.invoiceId||a.invoiceInfo.invoiceId;var c=h("bw")(_.extend(a.invoiceInfo,b));a.invoiceInfoVOList=b.invoiceInfoVOList||
[];a.setContentView(c)}).fail(function(b){a.setContentView(h("bw")(_.extend(a.invoiceInfo,b)))})},newInvoiceHandle:function(a){x({hash:"invoice/type:insert",data:{titleType:1,taxNumTip:this.taxNumTip}})},getOneInvoiceInfo:function(a){return this.invoiceInfoVOList.filter(function(b){return b.invoiceId==a})[0]},editInvoiceHandle:function(a){a=$(a.currentTarget).attr("invoiceId");x({hash:"invoice/type:update",data:_.extend(this.getOneInvoiceInfo(a),{taxNumTip:this.taxNumTip})})},
useIvoiceHandle:function(a){$(a.target).hasClass("edit")||(a=$(a.currentTarget),this.$(".ka").removeClass("checked"),a.find(".ka").addClass("checked"),L())},returnData:function(){var a=this.$(".ka.checked").attr("invoiceId"),b,c=0;a&&(b=this.getOneInvoiceInfo(a),c=0==b.titleType?1:2);lg("user_action","1.0",{click_id:"select",invoicetype:c});return b},invoiceInfoAlert:function(a){this.invoiceInfo&&N({title:"提示",msg:this.invoiceInfo.invoiceMoneyTip,button:[{text:"确认",callback:function(){}}]})},
invoiceBack:function(a){a=a||{};"yes"==a.isAllow&&(this.invoiceId=a.invoiceId||this.invoiceId,this.fetch())}});
View.extend({borrow:"AddressForm",name:"locateaddress",events:{"tap .yx":"chooseCity","tap .zh li":"changeCity","input .yy":"poiAddress","click .z7 li":"choosePoi","tap .z1 li":"chooseFujin"},initialize:function(a){var b=this;b.setContentView(h("dx")({insert:"r"}));v.bind("message",function(a){v.unbind("message");
var e=a.data;e&&"locationPicker"==e.module&&Fa({longitude:e.latlng.lng,latitude:e.latlng.lat,needMatch:1}).done(function(a){a.title="我的位置"==e.poiname?a.title:e.poiname;a=t.formatAddressData(a);t.manualSetCurrentUse(a);b.address=a;L()}).fail(function(){})},!1)},chooseCity:function(){this.$(".yv").addClass("none");this.$(".zf").removeClass("none")},changeCity:function(a){a=this.$(a.currentTarget);a.addClass("curr").siblings().removeClass("curr");this.cityName=a.attr("areaname");
this.$(".yx").html(this.cityName);this.$(".yv").removeClass("none");this.$(".zf,.z7").addClass("none");this.$(".yy").val("");this.$(".yz").removeClass("none")},poiAddress:function(a){var b=this;a=a.currentTarget.value.trim();a||b.$(".z7").hasClass("none")?a&&(b.$(".yz").addClass("none"),b.$(".z7").removeClass("none"),$b(b,b.cityName,a).done(function(a){b.$(".z7 ul").html(h("o")({result:a}))}).fail(function(a){b.$(".z7 ul").empty()})):
(b.$(".z7").addClass("none"),b.$(".yz").removeClass("none"))},choosePoi:function(a){a=this.$(a.currentTarget);a=W(a.attr("jsondata"));a.city=this.cityName;this.address=a;L()},chooseFujin:function(a){a=W(this.$(a.currentTarget).attr("jsondata"));a.city=this.cityName;this.address=a;L()},returnData:function(){return this.address},leave:function(){v.unbind("message")}});
View.extend({name:"loginError",events:{"tap .yj":"login"},initialize:function(a){var b=ea((a||
{}).query||"");a=b.code;(b=b.returnLink)&&(b=decodeURIComponent(b));this.returnLink=b;this.setContentView(h("dx")({}));this.$(".content").html(h("fs")({msg:"登录超时，请稍后再试！["+a+"]",btnText:"重新登录",other_tip_bg:"yr",hideBtn:!0,loginError:!0}))},login:function(){X(this.returnLink)}});
ViewMethod.define("memberStoreView",{events:{"click .xa":"toggleStoreActivity"},toggleStoreActivity:function(a){a=this.$(a.currentTarget);var b=a.prev().children('[node-type="index-storeActivityList"]').children("li");
a.find(".a2q").toggleClass("adx");b.each(function(a){1<a&&$(this).toggle()})},goToStore:function(a){var b=a.target;a=this.$(a.currentTarget);var c=a.attr("_href"),e="",f="",g="",l=f="",f="";if(-1!=b.className.indexOf("a2q")||-1!=$(b).parents().indexOf("xa")||-1!=b.className.indexOf("xa"))return!1;this.address.isApp?(-1!=b.className.indexOf("vj")||-1!=($(b).parents(".vj").attr("class")||
"").indexOf("vj")?(f=c.split("/")[1].split(":")[1]||"",g=c.split("/")[2].split(":")[1]||"",f={params:{storeId:f,orgCode:g,cartType:1},to:"store"},f=encodeURIComponent(JSON.stringify(f)),e="openApp.jddj://communication?body="+f):a.hasClass("adt")?(c=a.attr("_href"),l=c.split("/")[1].split(":")[1]||"",f=c.split("/")[2].split(":")[1]||"",g=c.split("/")[3].split(":")[1]||"",f={params:{storeId:f,orgCode:g,skuId:l,needAnchorSku:!0,cartType:0},to:"store"},f=encodeURIComponent(JSON.stringify(f)),
e="openApp.jddj://communication?body="+f):a.hasClass("s8")&&(f=c.split("/")[1].split(":")[1]||"",f={params:{storeId:f},to:"store"},f=encodeURIComponent(JSON.stringify(f)),e="openApp.jddj://communication?body="+f),window.location.href=e):(-1!=b.className.indexOf("vj")||-1!=($(b).parents(".vj").attr("class")||"").indexOf("vj")?c+="/hasGoods:true":$(b).parent().hasClass("adt")&&(c=$(b).parent().attr("_href")),
x({hash:c}))},initialize:function(a){this.setContentView(h("dx")({loading:!0}));$(window).scrollTop(0);this.initArguments(a)},initArguments:function(a){var b=ea((a||{}).query||"");a=b.cityId||"";var c=b.lng||0,e=b.lat||0,f,g=window.navigator.userAgent,b=A("djAppVersion",g)||"";if(this.isApp=g.match(/appName\=jdLocal/gi)||A("token")||A("pin")){if(E)try{f=getCommonParams()}catch(l){f=A("commonParams",g)}else ha&&(f=window.djJava.getCommonParams());f=JSON.parse(f);f=_.extend(f,{appVersion:b});
this.address={cityId:f.cityId,longitude:f.longitude,latitude:f.latitude,isApp:!0}}else this.address={cityId:a,longitude:c,latitude:e,isApp:!1};this.pushGoods()},indexGoStoreHome:function(a){var b=a.target;a=$(a.currentTarget).attr("_href");-1!=b.className.indexOf("vj")||-1!=($(b).parents(".vj").attr("class")||"").indexOf("vj")?a+="/hasGoods:true":$(b).parent().hasClass("adt")&&(a=$(b).parent().attr("_href"));x({hash:a})}});
View.extend({name:"message",title:"消息中心",events:{"click [message]":"updateMsgStatus"},initialize:function(){var a=this;a.setContentView(h("dx")({loading:!0}));a.address=t.getLocalCurrent()||{};setTimeout(function(){a.isKeFu()},10)},isKeFu:function(){var a=this;eb(a).done(function(b){b?a.fetch("on"):a.fetch("off")}).fail(function(){a.fetch("off")})},fetch:function(a){var b=this;ae(b,{cityId:b.address.cityId}).done(function(c){c||(c={});c&&0<c.length?b.$(".content").html(h("by")({msgList:c,
type:a})):Ka?b.$(".content").html(h("by")({msgList:[],type:a})):b.$(".content").html(h("fw")({msg:"暂无系统消息[0001]"}));b.unReadMessage()}).fail(function(a){Ka||(!a||"202"!=a.code&&"201"!=a.code?b.$(".content").html(h("fs")({msg:a&&a.msg})):b.$(".content").html(h("fr")({msg:a&&a.msg})))})},updateMsgStatus:function(a){var b=$(a.currentTarget).attr("msgType");ce(this,{cityId:this.address.cityId,msgType:b}).done(function(b){$(a.currentTarget).next("i").removeClass("show")}).fail(function(){})},
unReadMessage:function(){var a=this,b={djPin:C.getPDJPin(),cityId:a.address.cityId};rb(a,b).done(function(b){if(b&&b.length)for(var e=0,f=b.length;e<f;e++)a.$("[message]").each(function(){b[e].msgType==$(this).attr("msgType")&&(1==b[e].status?$(this).next("i").addClass("show"):$(this).next("i").removeClass("show"))})})},backin:function(){this.unReadMessage()}});
View.extend({name:"msgDetail",events:{},initialize:function(a){a=ea((a||{}).query||"").msgType;this.setContentView(h("dx")({loading:!0}));
this.address=t.getLocalCurrent()||{};this.msgType=a;this.pageIndex=0;this.hasNextPage=!0;this.isLoading=!1;this.fetch(!1);R(this,this.more,"ul li")},fetch:function(a){var b=this;if(b.isLoading||!b.hasNextPage)return!1;b.isLoading=!0;a||(b.pageIndex=0);be(b,{pageIndex:10*b.pageIndex,msgType:b.msgType,cityId:b.address.cityId}).done(function(c){c||(c={});a?b.$(b.getMsgContainer(b.msgType)).append(h(b.getMsgListTpl(b.msgType))({list:c})):c&&0<c.length?b.$(".content").html(h(b.getMsgTpl(b.msgType))({list:c})):
b.$(".content").html(h("fw")({msg:b.getMsgTip(b.msgType)}));if(!_.isArray(c)||10>c.length)b.hasNextPage=!1;b.isLoading=!1}).fail(function(a){b.$(".content").html(h("fs")({msg:a&&a.msg}))})},more:function(){this.hasNextPage&&!this.isLoading&&(this.pageIndex++,this.fetch(!0))},getMsgContainer:function(a){var b="";switch(K(a)){case 0:b=".a4g";break;case 1:b=".a4f";break;case 2:case 3:case 4:b=".a4h"}return b},getMsgTpl:function(a){var b=
"";switch(K(a)){case 0:b="bz";break;case 1:b="c3";break;case 2:case 3:case 4:b="c1"}return b},getMsgListTpl:function(a){var b="";switch(K(a)){case 0:b="c0";break;case 1:b="c4";break;case 2:case 3:case 4:b="c2"}return b},getMsgTip:function(a){var b="";switch(K(a)){case 0:b="暂无优惠促销[0001]";break;case 1:b="暂无系统通知[0001]";break;case 2:b="暂无物流通知[0001]";break;case 3:b="暂无我的资产[0001]";break;case 4:b=
"暂无售后通知[0001]"}return b}});
View.extend({name:"mineCollectStore",events:{'click [node-type="index-gotoStore"]':"indexGoStoreHome","click [deleteCart]":"deleteCart","click [node-type=index-checkStoreActivity]":"checkIndexStoreActivity","click [swipeMask]":"hideSwipe","swipeLeft .dr":"swipeLeft","swipeRight .dr":"swipeRight"},from:{storeHome:"reRender"},initialize:function(){var a=this;a.setContentView(h("dx")({loading:!0}));a.isLoading=!1;a.hasNextPage=!0;a.page=1;
a.$(".content").html(h("gg")());setTimeout(function(){a.$wrap=a.$(".vo");a.pushGoods()},0);R(a,a.more,".dr",!0)},indexGoStoreHome:function(a){var b=a.target;a=$(a.currentTarget).attr("_href");if(-1!=b.className.indexOf("a2q")||-1!=$(b).parents().indexOf("xa")||-1!=b.className.indexOf("xa"))return!1;$(b).parent().hasClass("adt")&&(a=$(b).parent().attr("_href"));
x({hash:a})},pushGoods:function(a){var b=this;if(b.isLoading||!b.hasNextPage)return!1;b.isLoading=!0;a||(b.page=1);Wd(b,{currentPage:b.page,pageSize:10}).done(function(c){c||(c={});a?b.$wrap.append(h("gi")({result:c,more:a})):b.$wrap.html(h("gh")({result:c}));b.hasNextPage=b.page>=(c.data?c.config.totalCount:0)/10?!1:!0;setTimeout(function(){b.hasNextPage?b.$(".ct").addClass("cv"):(b.$(".ct").removeClass("cv"),
1<=b.$(".dr").length&&0==b.$(".wd").length&&b.$wrap.append(h("ar")({showmsg:"没有更多门店了"})))},300)}).fail(function(a){1<b.page?n(a.msg||"网络开小差，请稍后再试哦~[0001]"):201==a.code?X():b.$(".content").html(h("fs")({msg:a&&a.msg}))}).always(function(){b.isLoading=!1})},more:function(){this.hasNextPage&&!this.isLoading&&(this.page++,this.pushGoods(!0))},reRender:function(){this.initialize();setTimeout(function(){window.scrollTo(0,0)},300)},swipeLeft:function(a){var b=
$(a.currentTarget),c=b.find("[deleteCart]"),e=b.find("[swipeMask]");if("none"==e.css("display"))return c.css({width:0}).animate({width:80},{duration:122,complete:function(){e.show()}}),a.preventDefault(),!1},swipeRight:function(a){var b=$(a.currentTarget),c=b.find("[deleteCart]"),b=b.find("[swipeMask]");if("none"!=b.css("display"))return this._hideSwipe(c,b),a.preventDefault(),!1},deleteCart:function(a){var b=this,c=$(a.currentTarget),e=c.closest(".dr");if(c.hasClass("isSending"))return!1;
c.addClass("isSending");a={isFollow:!1,storeId:c.attr("storeId")};Ia(b,a).done(function(a){e.remove();n("取消关注成功！");0==b.$(".dr").length&&b.$(".vh").html(h("fs")({msg:"您暂没有关注门店！",hideBtn:!0,other_tip_bg:"yu"}))}).fail(function(a){"network"==a.type?n("网络异常，请稍后再试[0001]"):n(a.msg);a=e.find("[swipeMask]");b._hideSwipe(c,a)}).always(function(){c.removeClass("isSending")})},hideSwipe:function(a){a=$(a.currentTarget);var b=a.closest("dr").find("[deleteCart]");
this._hideSwipe(b,a)},_hideSwipe:function(a,b){a.animate({width:0},{duration:122,complete:function(){b.hide()}})},checkIndexStoreActivity:function(a){a=this.$(a.currentTarget);var b=a.prev().children('[node-type="index-storeActivityList"]').children("li");a.find(".a2q").toggleClass("adx");b.each(function(a){1<a&&$(this).toggle()})}});
View.extend({name:"myComments",title:"我的评价",events:{"tap .a9p .storeTitle":"goToStoreHome","click .pingjiaShowBigImg":"showBigImg",
"click .bigImgWrapper":"bigImgWrapper"},from:{pingjia:"pingjiaBack"},leave:function(){$("html,body").css({height:"auto",overflow:"auto"});this.$(".bigImgWrapper").length&&this.$(".bigImgWrapper").remove();$(window).scrollTop(0)},initialize:function(a){this.startTime=0;this.page=1;this.hasNextPage=!0;this.isLoading=!1;this.setContentView(h("dx")({loading:!0}));this.pushGoods();R(this,this.more,".a9o .a9p")},more:function(){this.hasNextPage&&!this.isLoading&&(this.page++,
this.pushGoods(!0))},getWindowMinHeight:function(){return $(window).height()-80},goToStoreHome:function(a){var b=this.$(a.currentTarget);a=b.data("storeid");b=b.data("orgcode");w("#storeHome/storeId:"+a+"/orgCode:"+b)},pushGoods:function(a){var b=this;if(b.isLoading||!b.hasNextPage)return!1;b.isLoading=!0;a||(b.page=1);Vd(b,{page:b.page}).done(function(a){a||(a={});0==b.startTime?(b.$(".content").html(h("cm")({result:a})),b.startTime=1):b.$(".a9o").append(h("cl")({evaluateList:a.evaluateList||
""}));b.isLoading=!1;b.page>=a.config.totalCount/10&&(b.hasNextPage=!1,b.$(".a9o").after(h("ar")({showmsg:"暂无更多评价"})));b.hasNextPage?b.$(".ct").addClass("cv"):b.$(".ct").removeClass("cv")}).fail(function(a){201==(a||{}).code?X():b.$(".content").html(h("fs")({msg:(a||{}).msg||"网络开小差，请稍候再试哦～"}))})},pingjiaBack:function(a){a&&N({title:"友情提示",msg:a,button:[{text:"知道了",callback:function(){}}]})},
showBigImg:function(a){a=$(a.currentTarget).attr("_src");this.scrollT=$(window).scrollTop();this.documentH=$(document).height();var b=$(window).height();$("html,body").css({height:b,overflow:"hidden"});$(window).scrollTop(0);this.$el.append(h("g5")({url:a,del:!0}))},bigImgWrapper:function(){var a=this.scrollT,b=this.documentH;$("html,body").css({height:b+"px",overflow:"auto"});$(window).scrollTop(a);$(".bigImgWrapper").remove()}});
View.extend({name:"newMember",title:"新人专享",borrow:"memberStoreView",
pushGoods:function(a){var b=this;qd(b,{areaCode:b.address.cityId,longitude:b.address.longitude||0,latitude:b.address.latitude||0}).done(function(a){a=(a||{}).data||[];b.result=a;0==a.length?b.$(".content").html(h("fy")({fromHash:"newMember"})):b.$(".content").html(h("cn")({data:a}))}).fail(function(a){"90002"==a.code?b.$(".content").html(h("fy")({msg:a&&a.msg})):b.$(".content").html(h("fs")({msg:a&&a.msg}))})}});
View.extend({name:"newPay",title:"结算收银台",
events:{"tap .j9 button":"payState","tap .iu li":"changePayType","click .dai":"payState","click .jq":"closeMasker","tap .finish":"finishPay","tap .refresh":"refreshPay","click .k5":"freePay"},initialize:function(a){a||(a={});console.log("from:::"+a.from);var b=this;T("isToWX");T("newPayH5Url");T("newPayWxSdk");var c=a.queryParam,e=!1;c&&"token"in c&&"appFrom"in c&&"source"in c&&(e=!0);b.token=e?decodeURIComponent(c.token):A("payToken");b.appFrom=e?decodeURIComponent(c.appFrom):
A("from")||"";b.source=e?decodeURIComponent(c.source):A("paySource");b.isApp=O?!0:!1;b.payType="wx";b.isDada=!1;-1!=b.appFrom.indexOf("dada")&&(b.isDada=!0);var f="yes"==z("pay");a.from||z("wxPay");T("wxPay");b.setContentView(h("dx")({loading:!0}));oc({token:b.token}).done(function(a){a||(a={});if(a.countDownTime){b.lastTime=K(a.countDownTime);var c=b.getTime()}b.isVip="vip"==a.cashierType?!0:!1;b.isVip&&(a.stationName="VIP会员");b.setContentView(h("co")({channel:b.appFrom,result:a,isDada:b.isDada,
initTime:c||""}));b.returnLink=window.returnAppLink=a.notifyUrl;b.orderId=a.orderId;b.openId=a.openId||"";b.paySource=a.paySource;b.$(".iu li").eq(0).hasClass("jd")&&I&&"1"!=b.$(".iu li").eq(0).attr("freeTag")&&b.getPayDescribe();u.setItem("currentOrderId",a.orderId);"dashang"==b.appFrom&&O&&(window.returnAppLink="");(b.lastTime=b.countDownTime=a.countDownTime)&&-1!=a.countDownTime&&(b.start_time=(new Date).getTime(),b.startCalculateTime());f?(T("pay"),ma({token:b.token}).done(function(a,
c){c||(c={});if(0==c.code)if(20==a){if(-1==b.returnLink.indexOf("vipPayResult")){if(u.getItem("pay-token-not-need-jump")==b.token)return;b.toPaySuccess()}}else b.isApp&&(b.isDada||"container"==b.appFrom)&&b.render_to_repeat_pay();0==c.code&&20==a||u.setItem("pay-token-not-need-jump",b.token)}).fail(function(){})):u.setItem("pay-token-not-need-jump",b.token);"yes"==z("wxFreePay")&&(T("wxFreePay"),b.initialize())}).fail(function(a){"dashang"==b.appFrom&&lg("user_action","1.0",{clickid:"dashangInitFail",
user_pin:z("PDJ_H5_PIN")});b.setContentView(h("ft")({msg:a&&a.msg||""}));return!1})},changePayType:function(a){a=this.$(a.currentTarget);if("nbt"==a.attr("payType")||"dai"==a.attr("payType"))return!1;a.siblings().find("i").removeClass("checked");a.find("i").addClass("checked");this.payType=a.attr("payType");this.freeTag=a.attr("freeTag");var b=oa(A("djAppVersion",window.navigator.userAgent),10);"wx"==a.attr("payType")&&0==a.attr("freeTag")&&!a.hasClass("noFreePay")&&(P||O&&4.3<=b||
I)&&(a.toggleClass("noFreePay"),this.$(".k5").show());"jd"==a.attr("payType")&&I&&lg("user_action","1.0",{clickid:"to_jd_pay",orderid:this.orderId});"jd"==a.attr("payType")&&0!=a.attr("index")&&I&&"1"!=a.attr("freeTag")&&this.getPayDescribe()},submit:function(a){var b=this,c=b.$(a.currentTarget);if("no"!=c.attr("isSending")||c.hasClass("disable"))return!1;Y("pay","yes");c.attr("isSending","yes");b.payType=b.$(".checked").parent().attr("payType");if("wx"==b.payType){var e=z("openid_pdj_jd")||
b.openId||"";a=P&&e?"weixin":b.isApp?"dada"==b.appFrom||"andada"==b.appFrom?"dada":"daojia":I?"jd":"h5";lg("user_action","1.0",{clickid:"payPlat",orderid:b.orderId,user_pin:z("PDJ_H5_PIN"),plat:a});"dashang"==b.appFrom&&lg("user_action","1.0",{clickid:"dashangPay",orderid:b.orderId,user_pin:z("PDJ_H5_PIN")});P&&!e?(lg("user_action","1.0",{clickid:"lose_openid",order_id:(b.orderId||"0").toString(),user_pin:z("PDJ_H5_PIN")}),N({msg:"请在右上角打开浏览器进行微信支付",button:[{text:"知道了",callback:function(){c.attr("isSending",
"no")}}]})):pc({token:b.token,openid:e,orderId:b.orderId,freeTag:b.freeTag}).done(function(a){P&&e?"object"!=typeof a?b.getFreePayRecordStatus(!1):b.wxPay(a):b.isApp?"object"!=typeof a?b.getFreePayRecordStatus(!0):b.isDada||"container"==b.appFrom?b.h5Pay(a):b.appPay(a):"dada"==b.appFrom||"andada"==b.appFrom?b.dadaAppPay(a):"object"!=typeof a?b.getFreePayRecordStatus(!1):b.h5Pay(a)}).fail(function(a){a=a||{};lg("user_action","1.0",{clickid:"wxpayFail",orderid:b.orderId,user_pin:z("PDJ_H5_PIN"),msg:a&&
a.msg,code:a.code});n(a.msg||"网络开小差，请稍后再试哦~[0001]");a&&"906"==a.code&&setTimeout(function(){w(window.location.protocol+"//"+window.location.host+"/activity/vip/index.html")},1E3)}).always(function(){setTimeout(function(){c.attr("isSending","no")},2E3)})}else"jd"==b.payType?qc({token:b.token,orderId:b.orderId}).done(function(a){a||(a={});if(a.orderId)if(I)try{JDPaySDK.jdPay({type:"thirdPay",param:a,returnType:"callJS",success:function(a){lg("user_action","1.0",{clickid:"jdSDKPay",data:JSON.stringify(a),
orderId:b.orderId});"string"==typeof a?-1!=a.indexOf("JDP_PAY_SUCCESS")?ma({token:b.token}).done(function(a,c){0==c.code&&20==a&&b.toPaySuccess()}):-1==a.indexOf("JDP_PAY_CANCEL")&&(a.indexOf("JDP_PAY_FAIL"),b.render_to_repeat_pay()):"object"==typeof a?"JDP_PAY_SUCCESS"==a.payStatus?ma({token:b.token}).done(function(a,c){0==c.code&&20==a&&b.toPaySuccess()}):"JDP_PAY_CANCEL"!=a.payStatus&&b.render_to_repeat_pay():b.render_to_repeat_pay()}})}catch(e){b.render_to_repeat_pay()}else b.$(".iu").append(h("d1")(a)),
$("#batchForm").submit();else E&&I?x({hash:"#jdpayiframe",data:a}):(b.$(".iu").append(h("d1")(a)),$("#batchForm").submit());setTimeout(function(){c.attr("isSending","no")},2E3)}).fail(function(a){a=a||{};lg("user_action","1.0",{clickid:"jdpayFail",orderid:b.orderId,user_pin:z("PDJ_H5_PIN"),msg:a&&a.msg,code:a.code});n(a.msg||"网络开小差，请稍后再试哦~[0001]");c.attr("isSending","no")}):"bt"==b.payType?Od({token:b.token,orderId:b.orderId}).done(function(a){b.$(".iu").append(h("d1")(a));
$("#batchForm").submit();setTimeout(function(){c.attr("isSending","no")},2E3)}).fail(function(a){a=a||{};lg("user_action","1.0",{clickid:"btpayFail",orderid:b.orderId,user_pin:z("PDJ_H5_PIN"),msg:a&&a.msg,code:a.code});n(a.msg||"网络开小差，请稍后再试哦~[0001]");c.attr("isSending","no")}):"zfb"==b.payType&&rc({token:b.token,orderId:b.orderId}).done(function(a){"dada"==b.appFrom||"andada"==b.appFrom?b.dadaAlipay(a):b.$(".iu").append(h("d2")(a));$("#zfbForm").submit();setTimeout(function(){c.attr("isSending",
"no")},5E3)}).fail(function(a){a=a||{};lg("user_action","1.0",{clickid:"zfbpayFail",orderid:b.orderId,user_pin:z("PDJ_H5_PIN"),msg:a&&a.msg,code:a.code});n(a.msg||"网络开小差，请稍后再试哦~[0001]");c.attr("isSending","no")})},wxPay:function(a){var b=this;WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:a.appid,timeStamp:a.timestamp,nonceStr:a.noncestr,"package":"prepay_id="+a.prepayid,signType:"MD5",paySign:a.sign},function(a){"get_brand_wcpay_request:ok"==a.err_msg?b.toPaySuccess():n("微信支付失败")})},
appPay:function(a){if(E)wa?window.webkit.messageHandlers.MobileNavi.postMessage({method:"toWXPay",params:JSON.stringify({timestamp:a.timestamp,packageValue:"Sign=WXPay",appid:a.appid,sign:a.sign,partnerid:a.partnerid,prepayid:a.prepayid,noncestr:a.noncestr}),callBackName:null,callBackId:null}):toWXPay(a.timestamp,"Sign=WXPay",a.appid,a.sign,a.partnerid,a.prepayid,a.noncestr);else try{djJavaJSPay.toWXPay(a.timestamp,"Sign=WXPay",a.appid,a.sign,a.partnerid,a.prepayid,a.noncestr)}catch(b){lg("user_action",
"1.0",{clickid:"androidWXPay",data:JSON.stringify(a),error:JSON.stringify(b)})}},dadaAppPay:function(a){var b={appid:a.appid,partnerId:a.partnerid,prepayId:a.prepayid,nonceStr:a.noncestr,timeStamp:a.timestamp,packageValue:"Sign=WXPay",sign:a.sign},c=JSON.stringify(b);if("andada"==this.appFrom)window.nativeCode.androidWXPay(c);else{a={paySource:this.source,payType:"10",payInfo:b};try{window.connectWebViewJavascriptBridge(function(b){b.callHandler("ios_js_payment_center",a,function(a){a=JSON.parse(a).resultCode;
0==a?w(window.returnAppLink):-1==a?n("抱歉，网络开小差，请稍后重试"):-2==a?n("您已取消支付，若需继续支付请重新发起"):-3==a?n("抱歉，此订单支付失败，请您重新发起支付"):-4==a?n("抱歉，网络开小差，请稍后重试"):-5==a?n("您尚未安装微信APP，暂时无法支付，请安装后重试"):n("微信支付异常，请稍后再试，或选择其他支付方式")})})}catch(e){}}},dadaAlipay:function(a){if("andada"==this.appFrom)window.nativeCode.androidAliPay('_input_charset="'+a._input_charset+'"&body="'+a.body+'"&it_b_pay="'+a.it_b_pay+'"&notify_url="'+a.notify_url+'"&out_trade_no="'+a.out_trade_no+'"&partner="'+a.partner+'"&payment_type="'+a.payment_type+
'"&seller_id="'+a.seller_id+'"&service="'+a.service+'"&subject="'+a.subject+'"&total_fee="'+a.total_fee+'"&sign="'+a.sign+'"&sign_type="'+a.sign_type+'"');else{a={paySource:this.source,payType:"40",payInfo:a};try{window.connectWebViewJavascriptBridge(function(b){b.callHandler("ios_js_payment_center",a,function(a){a=JSON.parse(a).resultCode;9E3==a?w(window.returnAppLink):8E3==a?n("正在支付中，请您耐心等待"):4E3==a?n("抱歉，此订单支付失败，请您重新发起支付"):6001==a?n("您已取消支付，若需继续支付请重新发起"):6002==a?n("抱歉，网络开小差，请稍后重试"):n("支付宝支付异常，请稍后再试，或选择其他支付方式")})})}catch(b){}}},
h5Pay:function(a){if(!this._paying){var b=this;if(!a)return n("接口错误");if((O||E&&I)&&!P){T("isToWX");Y("wxPay","yes");Y("newPayWxSdk",a.mweburl);Y("newPayH5Url",window.location.href);var c=document.createElement("iframe");c.style.display="none";c.src="jdWxPayIframe.html";c.onload=function(){b.done_load?(setTimeout(function(){$(c).remove()},3200),b.render_to_repeat_pay()):(delete b._paying,b.done_load=!0)};document.body.appendChild(c);setTimeout(function(){b.render_to_repeat_pay()},1500)}else E||!I||
P?w(a.mweburl+"&redirect_url="+encodeURIComponent(window.location.href)):(Y("wxPay","yes"),w(a.mweburl),b.render_to_repeat_pay());setTimeout(function(){delete b._paying},999)}},render_to_repeat_pay:function(){var a=this;setTimeout(function(){a.$(".j9").addClass("none");a.$(".j8").removeClass("none")},500)},startCalculateTime:function(){var a=this;clearInterval(a.paytimeCountDown);a.paytimeCountDown=setInterval(function(){a.renderPaytimeText(a.lastTime)},1E3)},renderPaytimeText:function(){var a=
this;a.now_time=(new Date).getTime();a.lastTime=a.countDownTime-(a.now_time-a.start_time);if(0>=a.lastTime)return a.$(".ix").html("00:00"),a.$(".j9 button").addClass("disable"),clearInterval(a.paytimeCountDown),a.clearOrderData(),N({title:"支付超时",msg:"您的订单因超时未支付已取消，请重新下单。",button:[{text:"知道了",callback:function(){lg("user_action","1.0",{clickid:"cashier_countdown_20160908"});a.isApp?"container"==a.appFrom?E?L():window.location.href="openapp.jddj://communication/closeWeb":window.location.href=
"openapp.jddj://communication/closeWeb":L()}}]}),!1;a.$(".ix").html(a.getTime())},getTime:function(){var a=new Date(this.lastTime),b=1==a.getMinutes().toString().length?"0"+a.getMinutes():a.getMinutes(),a=1==a.getSeconds().toString().length?"0"+a.getSeconds():a.getSeconds();return b+":"+a},payState:function(a){var b=this;b.isGoPay=!0;var c=b.$(a.currentTarget),e=c.attr("class");if(null!=c.attr("isSending")&&""!=c.attr("isSending")&&("no"!=c.attr("isSending")||c.hasClass("disable")))return!1;
ma({token:b.token}).done(function(f,g){if(0==g.code)if(20==f)b.clearOrderData(),n("该订单已成功支付"),setTimeout(function(){O?"container"==b.appFrom?w(b.returnLink):window.location.href="openapp.jddj://communication/closeWeb":b.isDada||"container"==b.appFrom?w(b.returnLink):w("#orderlist")},1E3);else if(c.hasClass("dai")){lg("user_action","1.0",{order_id:(b.orderId||"0").toString(),click_name:"other_pay"});var l=c.attr("title"),h=c.attr("desc"),r=c.attr("link");b.toShare(l,h,r)}else b.submit(a);else{if(g&&
"网络开小差，请稍后再试哦~[0001]"==g.msg&&"finish"!=e&&"refresh"!=e)return!1;n(g.msg)}}).fail(function(a){a=a||{};if("网络开小差，请稍后再试哦~[0001]"==a.msg&&"finish"!=e&&"refresh"!=e)return!1;n(a.msg)})},toShare:function(a,b,c){var e=this,f=c||pb(window.location.protocol+"//"+window.location.host+"/html/index.html?token="+encodeURIComponent(e.token)+"&orderId="+e.orderId+"#daiPay");a=a||"土豪大大，跪求代付～";b=b||"我在京东到家上挑好了商品，快帮我付个款吧～";setTimeout(function(){fa({title:a,desc:b,link:f,imgUrl:"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png"})},
10);P?(e.$(".jo").show(),setTimeout(function(){e.closeMasker()},5E3)):I?(c={title:a,content:b,shareUrl:f,imageUrl:"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png",iconUrl:"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png",shareActionType:"P",channel:"Wxfriends,Wxmoments"},E?(c.shareUrl=encodeURIComponent(c.shareUrl),c.category="jump",c.des="share",c.type="111",c.isCallBack="Y",window.location.href="openApp.jdmobile://virtual?params="+JSON.stringify(c)):(c.callback=
"Y",c.eventId="",shareHelper.initShare(JSON.stringify(c)))):O&&(E?toPayShare(a,b,f):window.djJava.toPayShare(a,b,f))},closeMasker:function(){this.$(".jo").hide()},finishPay:function(){var a=this;ma({token:a.token}).done(function(b,c){0==c.code?20==b?"dashang"==a.appFrom&&I?n("打赏成功"):a.toPaySuccess():a.isVip?n("您还未完成支付，请重新支付"):n("您的订单还未完成支付，请重新支付"):n(c.msg)}).fail(function(a){n(a.msg)})},refreshPay:function(a){this.payState(a)},clearOrderData:function(){u.removeItem("settlementData");u.removeItem("currentOrderId")},
freePay:function(){var a=this;sc({paySource:a.paySource,payWay:10}).done(function(a){Y("wxFreePay","yes");O?E?getWXFree(a):window.djJava.getWXFree(a):w(a)}).fail(function(b){b&&"1000"==b.code&&a.initialize()})},getFreePayRecordStatus:function(a){var b=this;b.$(".k7").show();setTimeout(function(){tc({token:b.token,orderId:b.orderId,paySource:b.paySource}).done(function(c){b.$(".k7").hide();c=c||"";"SUCCESS"==c?a?w(window.returnAppLink):b.toPaySuccess():"PAY_FAIL"==c?N({msg:"余额不足，请选择其他支付方式",
button:[{text:"确定",callback:function(){b.$(".j9 button").attr("isSending","no").removeClass("disable")}}]}):a?window.location.href="openApp.jddj://communication?body={'params':{},'to':'orderList'}":w("#orderlist")}).fail(function(){b.$(".k7").hide();a?window.location.href="openApp.jddj://communication?body={'params':{},'to':'orderList'}":w("#orderlist")})},2E3)},toPaySuccess:function(){T("pay");clearInterval(this.paytimeCountDown);w(this.returnLink)},getPayDescribe:function(){var a=
this;uc({token:a.token,orderId:a.orderId}).done(function(b){b&&0!=b.length&&(a.$(".k9").html(b).show(),a.$("li.jd").addClass("jdFreePay"))}).fail(function(){})},leave:function(){clearInterval(this.paytimeCountDown)}});
View.extend({name:"jdpayiframe",title:"京东支付",events:{},initialize:function(a){a||(a={});var b=a.data;if(!b||"newPay"!==a.from||a.entrancepage)return setTimeout(function(){history.go(-2)},0);window._removeOrderResultPage=function(a){$("#jdpay_iframe").remove();x({hash:"#orderopresult/"+
(a||"")})};a='<iframe frameborder="0" id="jdpay_iframe" src="javascript:;" style="width:100%;height:'+v.height()+'px;"></iframe>';this.$el.append(a);setTimeout(function(){var a=h("d1")(b),e=document.getElementById("jdpay_iframe");try{var f=e.contentWindow.document;f.write(a);setTimeout(function(){f.getElementById("batchForm").submit()},9)}catch(g){n("支付失败")}},0)},backin:function(){history.go(-2)}});
View.extend({name:"newStore",title:"新店尝鲜",borrow:"memberStoreView",pushGoods:function(a){var b=
this;rd(b,{areaCode:b.address.cityId,longitude:b.address.longitude||0,latitude:b.address.latitude||0}).done(function(a){a=(a||{}).data||[];b.result=a;0==a.length?b.$(".content").html(h("fy")({})):b.$(".content").html(h("ct")({data:a}))}).fail(function(a){"90002"==a.code?b.$(".content").html(h("fy")({msg:a&&a.msg})):b.$(".content").html(h("fs")({msg:a&&a.msg}))})}});
View.extend({name:"orderdetail",title:"订单详情",borrow:"orderView",events:{"tap .pay":"pay",
"tap .cancel":"cancel","tap .p4":"cancelOrderBlank","click .order-detail-fugou-button":"orderFugouBtn","tap .goToShop":"goToShop","tap .nt":"goToOrderState","click .pc":"faHongbao","click .pn":"closeWeixinYindao","tap .q0,.cancelOrderTel":"closeCancelMenu","click .pz":"closeCancelMenu","tap .o7":"handleMoreSwitch","click .nv":"goToProductList","click [orderService]":"openPhoneList",
"click [freightRule]":"freightRule","click [receiveConfirm]":"receiveConfirm","click [orderRemove]":"deleteOrder","click [urgeOrder]":"urgeOrder","click [payForDelay]":"toPayForDelay","click [btnMore]":"switchMoreBtn","click [complaint]":"toComplaintPage","click [afterSales]":"toAfterSales","click .of":"handleCopyOrderId","click .mw":"closeMoreBtn","click .oe":"handleViewInvoice"},initialize:function(a){if(!C.hasAuthCookie())return this.setContentView(h("dx")({insert:"fr",
msg:"登录后才能查看订单哦",includefooter:!1,pagename:"orderList"})),!1;a=a||{};a=(a=a.queryParam)||{};this.orderId=a.orderId;this.singleData={};this.fugouData={};this.setContentView(h("dx")({title:"订单详情",loading:!0}));this.loadData(this.orderId)},loadData:function(a){var b=this;sb(b,a).done(function(a){a=a||{};b.orderInfo=_.extend(a,{tradeName:a.orderProductList[0].name});eb().done(function(e){b.orderInfo.kefu=e?a.kefu="on":a.kefu="off"}).fail(function(){b.orderInfo.kefu=a.kefu="off"}).always(function(){b.productList=
a.orderProductList||[];b.setContentView(h("db")(a));1==a.isSowMap&&b.loadOrderMapImg(b.orderInfo);b.weixinFlag=P;b.appInfo=b.jdAppShareHongbao();(b.weixinFlag||b.appInfo)&&b.shareHongbao(b.orderId);1==a.showPay&&(clearInterval(b.paytimeCountDown),b.timeLeft=a.payEndTime-a.serverTime,0>=b.timeLeft?b.$(".pay-time-left").parent().html("支付失效").addClass("p0"):(b.renderDetailPaytimeText(),b.startRenderPaytime()))})}).fail(function(a){b.$(".content").html(h("fs")({msg:a.msg}))})},
goToShop:function(a){this.goShop(this.$(a.currentTarget))},goToOrderState:function(a){/^a/i.test(a.target.tagName)||("q2"==a.target.className?this.goOrderMap():0>a.target.className.indexOf("nm")&&x({hash:"#orderState/orderId:"+this.orderId}))},goToProductList:function(a){"pu"==a.target.className||0<$(a.target).parent(".pu").length||x({hash:"#settlementGoods/orderId:"+this.orderId,data:{products:this.orderInfo.orderProductList,orderId:this.orderId,
orgCode:this.orderInfo.orgCode,storeId:this.orderInfo.storeId}})},shareHongbao:function(a){var b=this,c={};c.orderId=a;c.source="2";fc(b,c).done(function(a,c){a=a||{};"0"==c.code&&(b.$(".scrolling").append(h("do")()),b.weixinTitle=a.shareTitle,b.weixinDetail=a.shareDetail,b.weixinImg=a.shareImg,b.weixinUrl=a.baseUrl,b.weixinFlag&&setTimeout(function(){fa({title:b.weixinTitle,desc:b.weixinDetail,link:b.weixinUrl,imgUrl:b.weixinImg,isPacket:!0,success:function(){b.$(".pn").remove()},
cancel:function(){n("取消分享");b.$(".pn").remove()}})},1E3))}).fail(function(a){})},faHongbao:function(){if(this.weixinFlag)this.$(".scrolling").append(h("dp")());else{var a={title:this.weixinTitle,content:this.weixinDetail,shareUrl:this.weixinUrl,imageUrl:this.weixinImg,iconUrl:this.weixinImg,shareActionType:"P",channel:"Wxfriends,Wxmoments"};E?(a.shareUrl=encodeURIComponent(a.shareUrl),a=_.extend(a,{category:"jump",des:"share",type:"111",isCallBack:"Y"}),a="openApp.jdmobile://virtual?params="+
JSON.stringify(a),window.location.href=a):(a=_.extend(a,{callback:"N",eventId:""}),shareHelper.initShare(JSON.stringify(a)))}},jdAppShareHongbao:function(){var a=Ea();return-1!=a.indexOf("jdapp")&&"5.0"<=a.split(";")[2]?!0:!1},closeWeixinYindao:function(){this.$(".pn").remove()},freightRule:function(a){var b=$(a.currentTarget).attr("freightRule"),c=$(a.currentTarget).attr("totalMoney").replace(/(¥|￥)/,""),e=$(a.currentTarget).attr("titleTipTitle")||"运费说明";a=$(a.currentTarget).attr("childMoneyList");
Pa({title:e,desc:b,childMoneyList:JSON.parse(a),totalMoney:c})},handleMoreSwitch:function(a){a=$(a.currentTarget);var b=a.html(),c=this.$(".pq"),e=this.$(".o9");a.toggleClass("open");a.html(b.replace("查看更多","点击收起"));a.hasClass("open")?(c.show().removeClass("ps").addClass("pr"),setTimeout(function(){e.css("maxHeight","1000px")},500)):(c.removeClass("pr").addClass("ps"),a.html(b.replace("点击收起","查看更多")),setTimeout(function(){e.css("maxHeight",
"120px");c.hide()},500))},handleOrderChange:function(a){a.isDelete?(this.orderId=a.orderId,this.isDelete=a.isDelete,L()):a.orderId&&this.loadData(a.orderId)},toPayForDelay:function(a){a=$(a.currentTarget).attr("payForDelay");location.href=a||"https://daojia.jd.com/activity/payForDelay/index.html"},handleCopyOrderId:function(a){var b=$(a.currentTarget);b.addClass("checked");setTimeout(function(){b.removeClass("checked")},500);if(a=b.prev("input")[0]){a.focus();a.select();try{document.execCommand("selectAll"),
document.execCommand("copy")}catch(c){}}},handleViewInvoice:function(a){a=$(a.currentTarget).attr("titleNodeList")||"[]";Pa({desc:JSON.parse(a)},"w")}});
View.extend({borrow:"orderView",name:"orderlist",title:"订单列表",className:"a7",events:{"click  .my":"goToShop","click  .n1":"goToOrderDetail","click  .J_order_fugou":"fuGou","click  .pay":"pay","click .pv":"toComment","click .item-mask":"closePopupOrder"},initialize:function(a){var b=
this;b.saveOrderProduct=[];b.orderPayTimeLeft=[];if(C.hasAuthCookie())b.setContentView(h("dx")({includefooter:!0,pagename:"orderList",loading:!0})),b.singleData={},b.fugouData={},b.fetch(0),b.NoComment(),R(b,b.more,"li[orderId]");else return b.setContentView(h("dx")({insert:"fr",msg:"登录后才能查看订单哦",includefooter:!0,pagename:"orderList"})),!1;setTimeout(function(){$a(b.$(".scroller")[0])},800);pa()},fetch:function(a){var b=this;b._isFetch||!1===b.hasNextPage||b.notLoad||(a=_.isNumber(a)?
a:b.$("li[orderId]").length,b._isFetch=!0,r(b,{functionId:"order/list",body:{startIndex:a,dataSize:10}},{timeout:6E4}).done(function(c){c=c||[];b.notLoad=!1;b._isFetch=!1;0>=b.$(".content").length?"0"==a?b.setContentView(h("dx")({insert:"d3",list:c,startIndex:a,hasComment:b.hasComment,includefooter:!0,pagename:"orderList"})):setTimeout(function(){b.$(".content").append(h("d3")({list:c,startIndex:a,hasComment:b.hasComment}))},500):b.$(".content").append(h("d3")({list:c,
startIndex:a,hasComment:b.hasComment}));10>c.length&&(b.hasNextPage=!1);$.each(c,function(a,c){b.saveOrderProduct.push({order:c.orderId,productList:c.productList});if(1==c.showPay){var g=c.payEndTime-c.serverTime;b.orderPayTimeLeft.push({orderId:c.orderId,timeLeft:g,timeLeftStart:g});0>=g?b.$(".pay-time-left[orderId='"+c.orderId+"']").parent().html("支付失效").addClass("p0"):b.renderPaytimeText(c.orderId,g)}1==c.isSowMap&&(b.orderInfo=c,b.loadOrderMapImg(c))});0<b.orderPayTimeLeft.length&&b.startCalculateTimeLeft()}).fail(function(c){b.notLoad=
!0;b._isFetch=!1;c&&"202"==c.code?b.setContentView(h("dx")({insert:"fr",msg:c&&c.msg,includefooter:!0,pagename:"orderList"})):"0"==a&&b.setContentView(h("dx")({insert:"fs",msg:c&&c.msg,includefooter:!0,pagename:"orderList"}))}).always(function(){b.$(".loading").remove()}))},goToShop:function(a){var b=this.$(a.currentTarget).parents("li").attr("orderId");$(a.target).hasClass("n0")?x({hash:"#orderState/orderId:"+b}):(a=this.$(a.currentTarget),
a.hasClass("goToShop")&&this.goShop(a.parent()))},goToOrderDetail:function(a){if(!/^a/i.test(a.target.tagName)&&!$(a.target).hasClass("pay-time-left")){var b=this.$(a.currentTarget).parent().attr("orderId");a=$(a.target);a.hasClass("q2")?this.goOrderMap():a.hasClass("n6")||a.hasClass("np")||0<a.parents(".np").length?x({hash:"#orderState/orderId:"+b}):x({hash:"#orderdetail/orderId:"+b})}},fuGou:function(a){a=this.$(a.currentTarget).parents("li");
this.orderFuGou({orderId:a.attr("orderId"),orgCode:a.attr("orgCode"),storeId:a.attr("storeid")})},pay:function(a){a=this.$(a.currentTarget);a.hasClass("p0")||this.goPay({orderId:a.parents("li").attr("orderId"),tradeName:a.attr("tradeName"),tradeDescription:a.attr("tradeName"),merchantUserId:a.attr("venderId"),merchantOrderNum:a.parents("li").attr("orderId")},a)},startCalculateTimeLeft:function(){clearInterval(this.paytimeCountDown);this.startTime=Date.now();0!==this.orderPayTimeLeft.length&&
(this.paytimeCountDown=setInterval(function(){0===this.orderPayTimeLeft.length?clearInterval(this.paytimeCountDown):this.orderPayTimeLeft.map(this.refreshOrderItem.bind(this))}.bind(this),1E3))},renderPaytimeText:function(a,b){var c=new Date(b-1);this.$(".pay-time-left[orderId='"+a+"']").text("(还剩"+c.getMinutes()+"分"+c.getSeconds()+"秒)")},renderOrderListItem:function(a){sb(this,a).done(function(b){b=b||{};if(1!=b.showPay){var c=h("d5")({orderItem:b});this.$(".mx[orderId='"+
a+"']").replaceWith(c);b.isSowMap&&this.loadOrderMapImg(b)}}.bind(this)).fail(function(a){})},refreshOrderItem:function(a,b){var c=Date.now()-this.startTime;a.timeLeft=a.timeLeftStart-c;0>=a.timeLeft?(this.orderPayTimeLeft.splice(b,1),this.$(".pay-time-left[orderId='"+a.orderId+"']").parent().html("支付失效").addClass("p0"),this.renderOrderListItem(a.orderId)):this.renderPaytimeText(a.orderId,a.timeLeft);return a},handleOrderChange:function(a){if(a&&a.isDelete){var b=this.$(".mx[orderId='"+
a.orderId+"']");b.addClass("remove-ease");setTimeout(function(){b.remove()},500)}else a&&a.orderId&&this.renderOrderListItem(a.orderId)},removeTapOrder:function(){this.closePopupOrder();dc(this,this.orderId).done(function(a){var b=this.$(".mx[orderId='"+this.orderId+"']");b.addClass("remove-ease");setTimeout(function(){b.remove()},500)}.bind(this)).fail(function(a){n(a.detail||a.msg||"删除失败")})},more:function(a){this.fetch()},NoComment:function(){var a=this;r(this,{functionId:"order/isExistsComment",
body:{startIndex:0,dataSize:10}},"GET").done(function(b){b&&(a.hasComment=!0,a.$("[noCommentOrderCount]").css("display","block").show())})},toComment:function(a){$(a.target).hasClass("nj")?$("[noCommentOrderCount]").addClass("pw"):x({hash:"#uncommentorderlist"})}});
View.extend({borrow:"orderView",name:"uncommentorderlist",title:"未评价订单",className:"px",events:{"click  .orderListMask":"closeMask","click .my":"goToShop","click .n1":"goToOrderDetail"},
initialize:function(a){var b=this;b.setContentView(h("dx")({insert:"d3",loading:!0}));C.getLoginStatus(function(a){if(!1===a)return b.$(".content").html(h("fr")({msg:"登录后才能查看订单哦"})),!1;b.fetch(0);R(b,b.more,"li[orderId]")})},fetch:function(a){var b=this;b._isFetch||!1===b.hasNextPage||b.notLoad||(a=_.isNumber(a)?a:b.$("li[orderId]").length,b._isFetch=!0,r(b,{functionId:"order/getCommentList",body:{startIndex:a,dataSize:10}},"GET").done(function(c){c=c||[];b.notLoad=!1;
b._isFetch=!1;b.$("ul.list").addClass("hasOrderData").append(h("d4")({list:c,startIndex:a}));if(!_.isArray(c)||10>c.length)b.hasNextPage=!1}).fail(function(c){b.notLoad=!0;b._isFetch=!1;b.$(".content").html(h("fs")({msg:c&&c.msg}));var e=c.type;"unlogin"==e&&(b.hasNextPage=!1);b.$(".content").append(h("d4")(_.extend({error:!0,startIndex:a,type:e},c)))}).always(function(){b.$(".loading").remove()}))},goToShop:function(a){var b=this.$(a.currentTarget).parents("li").attr("orderId");
$(a.target).hasClass("n0")?x({hash:"#orderState/orderId:"+b}):(a=this.$(a.currentTarget),a.hasClass("goToShop")&&this.goShop(a.parent()))},goToOrderDetail:function(a){if(!/a/i.test(a.target.tagName)){var b=this.$(a.currentTarget).parent().attr("orderId");a=$(a.target);a.hasClass("q2")?this.goOrderMap():a.hasClass("n6")||a.hasClass("np")||0<a.parents(".np").length?x({hash:"#orderState/orderId:"+b}):x({hash:"#orderdetail/orderId:"+
b})}},more:function(a){this.fetch()}});
View.extend({name:"orderMap",title:"查看地图",events:{"click .n9":"orderMapBack","click .na":"orderMapRefresh","click .nb":"orderMapTipPopup"},initialize:function(a){var b=this;this.options=a;if(window.qq){a=this.data=a.queryParam;var c=h("ds")();$(".q5").remove();b.setContentView(c);try{b.createMap(a)}catch(e){b.initialize(b.options)}b.loadData(a);b.$(".q5").css("height",$(window).height());
clearInterval(b.mapInterval);b.mapInterval=setInterval(function(){b.initialize(b.options)},18E4)}else setTimeout(function(){b.initialize(b.options)},500)},loadData:function(a){var b=this;r(b,{functionId:"order/coordinate",body:a},"GET").done(function(a){b.data.buyerLat=a.buyerLat;b.data.buyerLng=a.buyerLng;b.data.deliveryManlat=a.deliveryManlat;b.data.deliveryManlng=a.deliveryManlng;b.data.stateId=a.stateId;b.drawMap(a);b.tipCopy=a.tipCopy}).fail(function(a){a=h("fs")({});b.setContentView(a)})},
backin:function(){this.initialize()},createMap:function(a){a=new qq.maps.LatLng(a.deliveryManlat||39.916527,a.deliveryManlng||116.397128);this.map=new qq.maps.Map(this.$(".q5")[0],{center:a,zoom:15,disableDoubleClickZoom:!0,disableDefaultUI:!0});a=new qq.maps.Size(23,23);var b=new qq.maps.Point(11,11),c=new qq.maps.Size(23,23),e=new qq.maps.Point(0,0);this.start_icon=new qq.maps.MarkerImage("//static-o2o.360buyimg.com/daojia/new/images/order/merchant@2x.png",c,e,b,a);this.user_icon=
new qq.maps.MarkerImage("//static-o2o.360buyimg.com/daojia/new/images/order/merchant@2x.png",c,e,b,a);a=new qq.maps.Size(48,55);c=new qq.maps.Size(48,55);b=new qq.maps.Point(23,60);this.merchantHeadFrame_icon=new qq.maps.MarkerImage("//static-o2o.360buyimg.com/daojia/new/images/order/bus_user@2x.png",c,e,b,a);this.userHeadFrame_icon=new qq.maps.MarkerImage("//static-o2o.360buyimg.com/daojia/new/images/order/bus_user@2x.png",c,e,b,a);a=new qq.maps.Size(17,17);c=new qq.maps.Size(17,17);b=new qq.maps.Point(8,
8);this.end_icon=new qq.maps.MarkerImage("//static-o2o.360buyimg.com/daojia/new/images/order/deliveryman_coor@2x.png",c,e,b,a);a=new qq.maps.Size(66,75);c=new qq.maps.Size(66,75);b=new qq.maps.Point(33,80);this.deliveryman_icon=new qq.maps.MarkerImage("//static-o2o.360buyimg.com/daojia/new/images/order/deliveryman@2x.png",c,e,b,a);a=new qq.maps.Size(105,31);c=new qq.maps.Size(105,31);b=new qq.maps.Point(53,110);this.deliveryman_bubble_icon=new qq.maps.MarkerImage("//static-o2o.360buyimg.com/daojia/new/images/order/bubble@2x.png",
c,e,b,a)},drawMap:function(a){var b=this,c,e=[],f,g,l,h,n,r,s,t=[],v=new qq.maps.LatLng(a.buyerLat,a.buyerLng);new qq.maps.Marker({icon:b.user_icon,map:b.map,position:v});var u=a.userLogo||"//static-o2o.360buyimg.com/daojia/new/images/user/bg_head_new_light.png",w=a.storeLogo||"//static-o2o.360buyimg.com/daojia/new/images/order/merchant_head@2x.png",x=new qq.maps.Size(38,38),z=new qq.maps.Size(38,38),p=new qq.maps.Point(19,58),A=new qq.maps.Point(0,0),u=new qq.maps.MarkerImage(u,z,A,p,x),D=new qq.maps.MarkerImage(w,
z,A,p,x);new qq.maps.Marker({icon:u,map:b.map,position:v});new qq.maps.Marker({icon:b.userHeadFrame_icon,map:b.map,position:v});var y=new qq.maps.LatLng(a.storelat,a.storelng),C=new qq.maps.LatLng(a.deliveryManlat,a.deliveryManlng),w=new qq.maps.DrivingService({complete:function(p){var u=p.detail.start,w=p.detail.end;f&&f.setMap(null);g&&g.setMap(null);l&&l.setMap(null);h&&h.setMap(null);n&&n.setMap(null);r&&r.setMap(null);s&&s.setMap(null);for(var x;x=t.pop();)x.setMap(null);f=new qq.maps.Marker({icon:b.start_icon,
position:u.latLng,map:b.map,zIndex:1});g=new qq.maps.Marker({icon:D,position:u.latLng,map:b.map,zIndex:1});l=new qq.maps.Marker({icon:b.merchantHeadFrame_icon,position:u.latLng,map:b.map,zIndex:1});h=new qq.maps.Marker({icon:b.end_icon,position:w.latLng,map:b.map,zIndex:1});n=new qq.maps.Marker({icon:b.deliveryman_icon,position:w.latLng,map:b.map,zIndex:1});r=new qq.maps.Marker({icon:b.deliveryman_bubble_icon,position:w.latLng,map:b.map,zIndex:1});70==a.stateId&&(u=qq.maps.geometry.spherical.computeDistanceBetween(y,
C),w=1E3<=u?(u/1E3).toFixed(2)+"km":u.toFixed(2)+"m",w=w.replace(".00",""),s=new qq.maps.Label({position:C,map:b.map,content:1>=u?"已到店":'距离商家: <span style="color: #ff5757;">'+w+"</span>",zIndex:9}),s.setStyle({border:"none",zIndex:99,fontSize:"11px",width:"90px",textAlign:"center",webkitTransform:"translate(-47px, -107px)",transform:"translate(-47px, -107px)"}));c=p.detail.routes;u=[];for(w=0;w<c.length;w++){var z=c[w];x=z;b.map.fitBounds(p.detail.bounds);x=x.steps;polyline=new qq.maps.Polyline({path:z.path,
strokeColor:"#fc4646",strokeWeight:3,map:b.map});t.push(polyline);for(z=0;z<x.length;z++){var A=x[z];e.push(A.placemarks);var E;switch(A.turning.text){case "左转":E="0px 0px";break;case "右转":E="-19px 0px";break;case "直行":E="-38px 0px";break;case "偏左转":case "靠左":E="-57px 0px";break;case "偏右转":case "靠右":E="-76px 0px";break;case "左转调头":E="-95px 0px";break;default:mg_position=""}u.push('<p onmouseover=this.style.background="#eee" onmouseout=this.style.background="#fff" style="margin:5px 0px;cursor:pointer" ><b>'+
(z+1)+".</b>"+('&nbsp;&nbsp;<span style="margin-bottom: -4px;display:inline-block;background:url(img/turning.png) no-repeat '+E+';width:19px;height:19px"></span>&nbsp;')+A.instructions)}}b.map.setZoom(14);b.map.panTo(C);80==a.stateId&&(u=qq.maps.geometry.spherical.computeDistanceBetween(C,v)||0,w=1E3<=u?(u/1E3).toFixed(2)+"km":u.toFixed(2)+"m",w=w.replace(".00",""),s=new qq.maps.Label({position:C,map:b.map,content:1>=u?"已到达":'距您: <span style="color: #ff5757;">'+w+"</span>",zIndex:9}),s.setStyle({border:"none",
zIndex:99,fontSize:"11px",width:"90px",textAlign:"center",webkitTransform:"translate(-47px, -107px)",transform:"translate(-47px, -107px)"}))}});w.setPolicy(qq.maps.DrivingPolicy.LEAST_DISTANCE);w.search(y,C)},orderMapBack:function(){L()},orderMapRefresh:function(){this.initialize(this.options)},orderMapTipPopup:function(a){ia({title:"提示",desc:this.tipCopy})},leave:function(){clearInterval(this.mapInterval)}});
View.extend({name:"orderMark",title:"订单备注",events:{"click .mp":"saveOrderMark"},
initialize:function(a){a=(a.data||{}).remark||"";this.setContentView(h("du")({inputNumber:a.length,remark:a}))},saveOrderMark:function(){this.remark=this.$(".mo").val();L()},inputHandle:function(a){console.log();a=$(a.currentTarget).val()||"";30<=a.length&&n("最多输入30字");this.$(".mn").html(a.length+"/30")},returnData:function(){return this.remark}});
View.extend({name:"orderopresult",title:"下单成功",followData:{attention:1},events:{"click [node-type='checkStoreActivity']":"checkStoreActivity",
"click .p8":"goStoreHome","click .pe,.ph":"closeShareHongbao","click .pf,.pm":"shareFriendsHongbao","click .pn":"closeWeixinYindao","click .om":"handleFollowStore"},initialize:function(a){a||(a={});u.removeItem("settlementData");u.removeItem("currentOrderId");if(window.parent&&window.parent!==window&&window.parent._removeOrderResultPage)return window.parent._removeOrderResultPage(a.query);var b=
this,c=a.queryParam;a=c.result;if("success"==a){var e=c.orderId;-1!=e.indexOf("?")&&(e=e.split("?")[0]);b.followData.orderId=e;a=A("token");var f=A("tradeNum");a&&Nd(b,JSON.stringify({token:a,tradeNum:f}));sb(b,e).done(function(a){var f=a||(a={});b.followData.storeId=b.storeId=f.storeId;b.followData.orgCode=b.orgCode=f.orgCode;a=c.payType;var q=c.groupPay,r=c.settleType;b.setContentView(h("dx")({insert:"dq",data:f,payType:a,groupPay:q,settleType:r,isJDApp:I}));b.weixinFlag=P;
b.appInfo=b.jdAppShareHongbao();if(b.weixinFlag||b.appInfo)f={},f.orderId=e,f.source="1",fc(b,f).done(function(a,c){a=a||{};"0"==c.code&&(b.weixinTitle=a.shareTitle,b.weixinDetail=a.shareDetail,b.weixinImg=a.shareImg||"http://static-o2o.360buyimg.com/daojia/new/images/icon/pdj.png",b.weixinUrl=a.baseUrl,b.$(".orderSuccess").append(h("dr")(a)),b.weixinFlag&&setTimeout(function(){fa({title:b.weixinTitle,desc:b.weixinDetail,link:b.weixinUrl,imgUrl:b.weixinImg,isPacket:!0,
success:function(){b.$(".pn").remove()},cancel:function(){n("取消分享");b.$(".pn").remove()}})},1E3))}).fail(function(a){});b.callFollowStore(!0)});I||r(b,{functionId:"order/finish/recommendList20",body:{orderId:e}},"GET").done(function(a){JSON.stringify(a);b.$(".p5").html(h("ff")({insert:"ff",store:a,storeDate:"ordersuccess_tj_store"}))}).fail(function(a){b.$(".p5").hide()});b.finishWxCoupon()}else f=
c.failtype,b.setContentView(h("dx")({insert:"dq",result:a,failtype:f}))},checkStoreActivity:function(a){a=this.$(a.currentTarget);var b=a.prev().children('[node-type="storeActivityList"]').children("li");a.find(".r6").toggleClass("r7");b.each(function(a){1<a&&$(this).toggle()})},goStoreHome:function(a){a=$(a.currentTarget).attr("_href");x({hash:a})},closeShareHongbao:function(){this.$(".pd").remove()},handleFollowStore:function(a){$(a.currentTarget).hasClass("checked")?
this.followData.attention=0:this.followData.attention=1;this.callFollowStore();lg("user_action","1.0",{click_name:"store_focus_20160815_"+(0===this.followData.attention?2:1),order_id:this.followData.orderId,store_id:this.followData.storeId})},callFollowStore:function(a){var b=this;a?delete b.followData.storeId:b.followData.storeId=b.storeId;return r(b,{functionId:"other/store/watch/toggle",body:b.followData},"POST").done(function(c){a&&1==c.show&&(b.$(".ol").show(),c.watch&&b.$(".om").addClass("checked"),
c.storeName&&b.$(".ol").find("label").text(c.storeName));a||b.$(".om").toggleClass("checked");c.midTelShow&&b.$(".qn").text(c.midTelDesc).show()}).fail(function(b){!a&&b.msg&&n(b.msg)})},shareFriendsHongbao:function(){if(this.weixinFlag)this.$(".pd").remove(),this.$(".scrolling").append(h("dp")()),$(window).bind("touchmove.orderShare",function(a){a.preventDefault()});else{var a={title:this.weixinTitle,content:this.weixinDetail,
shareUrl:this.weixinUrl,imageUrl:this.weixinImg,iconUrl:this.weixinImg,shareActionType:"P",channel:"Wxfriends,Wxmoments"};E?(a.shareUrl=encodeURIComponent(a.shareUrl),a=_.extend(a,{category:"jump",des:"share",type:"111",isCallBack:"Y"}),a="openApp.jdmobile://virtual?params="+JSON.stringify(a),window.location.href=a):(a=_.extend(a,{callback:"N",eventId:""}),shareHelper.initShare(JSON.stringify(a)))}},jdAppShareHongbao:function(){var a=Ea();return-1!=a.indexOf("jdapp")&&"5.0"<=a.split(";")[2]?!0:!1},
closeWeixinYindao:function(){this.$(".pn").remove();$(window).unbind("touchmove.orderShare")},leave:function(a){$(window).unbind("touchmove.orderShare")},finishWxCoupon:function(){var a=this;Dd({orderId:a.followData.orderId}).done(function(b){var c=b.couponMoney;b.returnCoupon&&(a.$(".qp span").html(c),a.$(".jdCoupon").show())}).fail(function(){})}});
View.extend({name:"vipPayResult",initialize:function(a){$("#container .loading").remove();this.setContentView(h("dv")())}});
View.extend({name:"orderState",title:"订单状态",borrow:"orderView",events:{"tap .pay":"pay","tap .cancel":"cancel","tap .p4":"cancelOrderBlank","click .order-detail-fugou-button":"orderFugouBtn","tap .q0,.cancelOrderTel":"closeCancelMenu","click .pz":"closeCancelMenu","click [orderService]":"openPhoneList","click [receiveConfirm]":"receiveConfirm","click [orderRemove]":"deleteOrder","click [urgeOrder]":"urgeOrder","click [btnMore]":"switchMoreBtn",
"click [complaint]":"toComplaintPage","click [afterSales]":"toAfterSales","click .q2":"goOrderMap","click .mw":"closeMoreBtn"},initialize:function(a){a=a||{};a=(a=a.queryParam)||{};this.orderId=a.orderId;if(!C.hasAuthCookie())return this.setContentView(h("dx")({insert:"fr",msg:"登录后才能查看订单哦",includefooter:!1,pagename:"orderList"})),!1;this.setContentView(h("dx")({title:"订单状态",loading:!0}));this.loadData(this.orderId)},loadData:function(a){var b=
this;r(b,{functionId:"order/state",body:{orderId:a}},"GET").done(function(a){a=a||{};b.orderInfo=_.extend(a,{tradeName:a.orderProductList[0].name});eb().done(function(e){b.orderInfo.kefu=e?a.kefu="on":a.kefu="off"}).fail(function(){b.orderInfo.kefu=a.kefu="off"}).always(function(){b.productList=a.orderProductList||[];b.setContentView(h("di")(a));1==a.isSowMap&&(a.orderStateList.forEach(function(a){console.log(a);1==a.isShowStaticMap&&(b.orderInfo.stateId=a.stateId)}),b.loadOrderMapImg(b.orderInfo));
1==a.showPay&&(clearInterval(b.paytimeCountDown),b.timeLeft=a.payEndTime-a.serverTime,0>=b.timeLeft?b.$(".pay-time-left").parent().html("支付失效").addClass("p0"):(b.renderDetailPaytimeText(),b.startRenderPaytime()))})}).fail(function(a){b.$(".content").html(h("fs")({msg:a.msg}))})}});
ViewMethod.define("orderView",{from:{orderState:"handleOrderChange",orderdetail:"handleOrderChange",pingjia:"pingjiaBack"},goShop:function(a){var b=this,c=a.attr("storeId");a.attr("storeName");var e=
a.attr("orgCode");zd(b,{storeId:c}).done(function(a){"2"==a?b.alertMsg("此门店已下线，<br/>去其它门店逛逛吧。"):x({hash:"#storeHome/storeId:"+c+"/orgCode:"+e+""})}).fail(function(a){n(a.msg)})},goPay:function(a,b){if(!b.hasClass("sending")){var c=this,e=a.orderId;b.addClass("sending");ic(c,a).done(function(a,b,l){ta?a?Pd(a,e):Qa(orderResult):l?(z("o2o_m_h5_sid"),a?Mb(a):w("#orderopresult/result:success/payType:pay/orderId:"+e)):a?(c.$(".scrolling").append(h("d0")(a)),c.$("form").submit()):n("支付信息验证失败")}).fail(function(a){n((a||
{}).msg||"网络错误")}).always(function(){b.removeClass("sending")})}},orderFuGou:function(a){var b=a.storeId,c=a.orgCode;a=a.orderId;this.fugouData={cartUuid:this.uuid(),storeId:b};this.singleData={orgCode:c,settlementMethod:2,storeId:K(b)};this.singleProduct({cartUuid:this.uuid(),orderId:a})},singleProduct:function(a){var b=this;r(b,{functionId:"rePurchase/singleProductNew",body:a},"POST").done(function(a){"1"==a?x({hash:"singleSettlement",data:b.singleData}):"2"==a?b.alertMsg("该商品已下架，<br/>可到门店查看其它相似商品。"):
"3"==a?b.alertMsg("该商品已售罄商家正在补货，<br/>请稍后购买。"):"4"==a?b.alertMsg("此门店已下线，<br/>去其它门店逛逛吧。"):x({hash:"#storeHome/storeId:"+b.singleData.storeId+"/orgCode:"+b.singleData.orgCode+"/hasGoods:true"})}).fail(function(a){n(a.msg)})},alertMsg:function(a){var b=this;b.isShowMsg||(b.isShowMsg=!0,$(window).bind("touchmove",function(a){a.preventDefault()}),N({title:"温馨提示",msg:a,button:[{text:"知道啦",callback:function(){b.isShowMsg=!1;$(window).unbind("touchmove")}}]}))},uuid:function(){return"C6A0707D39D000018AC7DFA031FE1C8A"},
closeMask:function(a){$(a.currentTarget).addClass("none");$(window).unbind("touchmove")},returnData:function(){return{orderId:this.orderId,isDelete:this.isDelete}},pingjiaBack:function(a){a&&N({title:"友情提示",msg:a,button:[{text:"知道了",callback:function(){}}]})},leave:function(){clearInterval(this.paytimeCountDown);this.closeMoreBtn();this.closePopupOrder&&this.closePopupOrder()},pay:function(a){this.closeMoreBtn();a=this.$(a.currentTarget);a.hasClass("p0")||this.goPay({orderId:this.orderId,tradeName:this.orderInfo.tradeName,
tradeDescription:this.orderInfo.tradeName,merchantUserId:this.orderInfo.orgCode,merchantOrderNum:this.orderId},a)},cancel:function(a){this.closeMoreBtn();$(a.currentTarget).hasClass("disabled")?this.orderCancelHandle():1==this.orderInfo.cancelSwitchNew?this.selectOptions():2==this.orderInfo.cancelSwitchNew&&this.cancelMsg()},cancelMsg:function(){var a=this.orderInfo,b="",c=a.phoneCancelTip,b=a.servicePhone;if(1==a.phoneNumType){if(c=a.phoneCancelTipForH5,b="<a href='tel:"+b+"'>"+b+"</a>","on"==this.orderInfo.kefu){var b=
Ea(),e="";-1!=b.indexOf("jdapp")?"4.4.0"<=b.split(";")[2]&&(c=a.phoneCancelTip,e='openApp.jdMobile://virtual?params={"category":"jump","des":"im","entry":"jd_phone_jddaojia"}'):ta?e="https://chat.jd.com/jdchat/custom.action?entry=sq_M_jddj":P&&(e="https://chat.jd.com/jdchat/custom.action?entry=wx_M_jddj");b="<a href="+e+">联系在线客服</a>"}}else b=a.deliveryManMobileNew||b,b="<a href='tel:"+b+"'>"+b+"</a>";this.$el.append(h("dm")({title:c,tel:b}))},openPhoneList:function(){this.closeMoreBtn();
var a=this.orderInfo,b="on"==this.orderInfo.kefu?!0:!1;this.$el.append(h("dn")({isJDAPP:b,contactList:a.contactList}))},deleteOrder:function(a){var b=this;b.closeMoreBtn();N({title:"提示",msg:"是否删除该订单？",button:[{text:"取消",callback:function(){$(window).unbind("touchmove")}},{text:"确定",callback:function(){dc(b,b.orderId).done(function(a){b.isDelete=!0;L()}).fail(function(a){n(a.msg||"删除失败")});$(window).unbind("touchmove")}}]});$(window).bind("touchmove",function(a){a.preventDefault()});
lg("user_action","1.0",{clickid:"delete_order",order_id:b.orderId})},cancelOrderBlank:function(){this.$(".order-newCancelBox").hide()},orderFugouBtn:function(a){this.closeMoreBtn();a=$(a.target);this.orderFuGou({orgCode:a.attr("orgCode"),storeId:a.attr("storeId"),orderId:a.attr("orderId")})},selectOptions:function(){var a=this;return $.Deferred(function(b){var c=new ctrl.selectmenu({confirmText:"确定",title:"订单取消原因",cancelText:"取消"});b=[];for(var e=a.orderInfo.orderCancelReasons,f=0;f<e.length;f++)"99"!=
e[f].code&&b.push({value:e[f].code,key:e[f].text});c.viewModel={code:b};c.addEventListener("confirm",function(b){ec(a,{orderId:a.orderId,code:this.selectedValue["val-code"]}).done(function(b,c){"2222"==c.code||"2223"==c.code?ia({desc:c.msg}):n(c.msg||"订单取消成功！");setTimeout(function(){a.loadData(a.orderId)},500)}).fail(function(b){b=b||{};"2222"==b.code||"2223"==b.code?(ia({desc:b.msg}),setTimeout(function(){a.loadData(a.orderId)},500)):n(b.msg)});setTimeout(function(){c.remove()},500)});c.addEventListener("cancel",
function(a){setTimeout(function(){c.remove()},500)});a.$el.append(c.root);c.show()})},orderCancelHandle:function(){var a=this;ec(this,{orderId:this.orderId,code:""}).done(function(b,c){"2222"==c.code||"2223"==c.code?ia({desc:c.msg}):n(c.msg||"订单取消成功！");setTimeout(function(){a.loadData(a.orderId)},500)}).fail(function(a){a=a||{};"2222"==a.code||"2223"==a.code?ia({desc:a.msg}):n(a.msg)})},closeCancelMenu:function(a){"q0"==a.currentTarget.className?this.$(".cancelOrderWrapper").remove():
setTimeout(function(){this.$(".cancelOrderWrapper").remove()}.bind(this),1500)},renderDetailPaytimeText:function(){this.timeLeft=Math.abs(this.timeLeft-1);var a=new Date(this.timeLeft);this.$(".pay-time-left").html("(还剩"+a.getMinutes()+"分"+a.getSeconds()+"秒)")},startRenderPaytime:function(){var a=Date.now();this.timeLeftStart=this.timeLeft;this.paytimeCountDown=setInterval(function(){var b=Date.now()-a;this.timeLeft=this.timeLeftStart-b;0>=this.timeLeft?(clearInterval(this.paytimeCountDown),this.$(".pay-time-left").parent().html("支付失效").addClass("p0"),
this.loadData(this.orderId)):this.renderDetailPaytimeText()}.bind(this),1E3)},receiveConfirm:function(a){var b=this.orderInfo.noReceiveGoodList;if(b){a=b[0]||{};var c=[],e=this;e.closeMoreBtn();3==b.length?b.forEach(function(a,b){10==a.code?c.push({text:'<a style="color: #0078ff;" clstag = "pageclick|keycount|order_mancontact_click_20160713|1" href="tel:'+a.phoneNum+'">联系配送员</a>'}):30==a.code&&c.push({text:'<span clstag = "pageclick|keycount|order_complainman_click_20160713|1">投诉配送员</span>',callback:function(){xd(e,
{orderId:e.orderInfo.orderId}).done(function(a){"1"==a?n("您已投诉"):n("我们已经收到您的投诉申请")}).fail(function(a){n((a||{}).msg)})}})}):(b=b[1],c=[{text:'<a style="color: #0078ff;font-weight: bold;" clstag = "pageclick|keycount|order_shopcontact_click_20160713|1" href="tel:'+b.phoneNum+'">'+b.text+"</a>"}]);N({type:"order",isBlankClose:!0,msg:a.text,button:c})}},urgeOrder:function(a){var b=$(a.currentTarget),c=this;if(!c.sending){c.closeMoreBtn();var e=c.urgeData||c.orderInfo.urgeOrder;"0"==e.canClick?ia({desc:e.tip}):
(c.sending=!0,vd(c,{orderId:c.orderInfo.orderId}).done(function(a){c.sending=!1;ia({desc:e.tip});c.urgeData=a;b.css("color",a.color).text(a.content)}).fail(function(a){c.sending=!1}))}},loadOrderMapImg:function(a){var b=this;wd(b,{orderId:a.orderId,deliveryManlng:a.deliveryManlng,deliveryManlat:a.deliveryManlat,stateId:a.stateId||a.orderStateMap.stateId}).done(function(a){b.$(".q2").attr("src","data:image/png;base64,"+a)}).fail(function(a){})},goOrderMap:function(){var a=this.orderInfo;
x({hash:"#orderMap/orderId:"+a.orderId+"/storeId:"+a.storeId+"/buyerLng:"+a.buyerLng+"/buyerLat:"+a.buyerLat+"/deliveryManlng:"+a.deliveryManlng+"/deliveryManlat:"+a.deliveryManlat+"/stateId:"+(a.stateId||a.orderStateMap.stateId)})},toComplaintPage:function(){var a=A("channel")||"";w(window.location.protocol+"//"+window.location.host+"/activity/report/reportMerchant.html?pageType=complaint&orderId="+this.orderId+"&storeId="+this.orderInfo.storeId+"&appVersion="+appVersion+"&channel="+a)},toAfterSales:function(){var a=
A("channel")?"?channel="+A("channel")+"&h5hash=":"?h5hash=";w(window.location.protocol+"//"+window.location.host+"/activity/afterSales/index.html"+a+"mode/orderId:"+this.orderId)},switchMoreBtn:function(a){var b=this,c=this.$(".no");0==c.css("opacity")?(c.show(),c.css("opacity",1),b.isOpenMoreBtn=!0):(c.css("opacity",0),setTimeout(function(){c.hide();b.isOpenMoreBtn=!1},200))},closeMoreBtn:function(a){a=$((a||{}).target);!this.isOpenMoreBtn||a.hasClass("order-btn-more")||a.hasClass("nn")||
(this.$(".no").css("opacity",0).hide(),this.isOpenMoreBtn=!1)}});
View.extend({name:"pingjia",title:"评价",events:{"click [tijiao]":"tijiao","tap [star_text]":"star","focus .hl .ho":"textareaOnfocus","blur .hl .ho":"textareaOnBlur","click .h8 .hp .hr":"commentFinger","click .h8 .hh .star":"starsClick","click .h8 .hj .piece":"commentMarkClick","click .h8 .hc .hf":"timePikerAwake",
"click .hs":"submitCommentClick"},leave:function(){$("html,body").css({height:"auto",overflow:"auto"});this.$(".bigImgWrapper").length&&this.$(".bigImgWrapper").remove();$(window).scrollTop(0)},initialize:function(a){this.textareaVal="写下对配送员的评价吧~";this.fingerNum=0;this.flagComment=!1;this.commentType=this.badShowed=0;this.peisongActiveArr={1:[],2:[],3:[],4:[],5:[]};this.shangpinActiveArr={1:[],2:[],3:[],4:[],5:[]};this.editComment=a.queryParam.editComment?!0:!1;var b,c;this.operationType=
this.editComment?"2":"1";b=this.orderId=a.queryParam.orderId;c=this.operationType;this.$el.html(h("dx")({loading:!0}));var e=this;yd(e,a.queryParam).done(function(a,g){if("-1"==g.code)return e.errorMsg=g.msg,L();r(e,{functionId:"order/productCommentNew",body:{orderId:b,operationType:c}}).done(function(a){a||(a={});e.result=a;e.$(".content").html(h("dw")({result:a,editComment:e.editComment}));var b=a.productModifyFlag;if(a.deliveryModifyFlag&&e.editComment){var c=a.deliveryCommentContent;
c&&e.$('[data-value="peisongArea"]').val(c);e.starsActiveFun(a.deliveryServiceScore,"peisong")}b&&e.editComment&&(b=a.productCommentContent,e.starsActiveFun(a.productServiceScore,"shangpin"),b&&a.oldCommentContentTip&&(2<a.productServiceScore?e.$('[data-value="shangpinArea"]').val(b):(e.$('[data-value="shangpinArea"]').attr("data-type","请输入新的评价内容～"),e.$('[data-value="shangpinArea"]').attr("placeholder","请输入新的评价内容～"))));e.imagesUrls=[];a=new J.uploadImage({view:e});$(".commentListUploadImage").prepend(a.el)}).fail(function(a){e.$(".content").html(h("fs")({msg:(a||
{}).msg||"出错啦"}))})}).fail(function(a){e.errorMsg=a.msg;return L()})},starsActiveFun:function(a,b){var c=parseInt(a),c=this.$("[data-type="+b+"]").siblings(".star")[c-1],c=$(c);this.starsPublic(c)},commentFinger:function(a){a=this.$(a.currentTarget);a.closest(".list");if(a.hasClass("haoPing")||a.hasClass("haoPingActive"))a.toggleClass("haoPingActive"),a.siblings(".hr").hasClass("chaPingActive")?a.siblings(".hr").removeClass("chaPingActive"):a.hasClass("haoPingActive")?this.fingerNum++:
this.fingerNum--;else if(a.hasClass("chaPing")||a.hasClass("chaPingActive"))a.toggleClass("chaPingActive"),a.siblings(".hr").hasClass("haoPingActive")?a.siblings(".hr").removeClass("haoPingActive"):a.hasClass("chaPingActive")?this.fingerNum++:this.fingerNum--},textareaOnfocus:function(a){a=this.$(a.currentTarget);a.val()||a.addClass("holderColor")},textareaOnBlur:function(a){a=this.$(a.currentTarget);a.val()||a.removeClass("holderColor")},starsPublic:function(a){var b=this,
c=a.siblings(".hi"),e=a.siblings(".star"),f=a.closest(".hg"),g=a.closest(".hb"),l=a.siblings(".fontTitle").data("type"),h=a.parent().siblings(".hj"),n=[],r="0",s=b.result.uploadThresold||{};"peisong"==l?n=b.result.deliveryStarTipList:"shangpin"==l&&(n=b.result.productStarTipList);var t=function(a){c.html(n[a])},u=function(c){var f=c+"";$.each(e,function(a,b){a<c-1?$(this).addClass("active"):$(this).removeClass("active")});a.addClass("active");if("peisong"==
l&&b.result.tagContentMap){var g=v(c);g&&g.deliveryMap&&(h.html(""),$.each(g.deliveryMap,function(a,e){var l="";g.deliveryCodes&&b.result.deliveryServiceScore==c&&$.each(g.deliveryCodes,function(a,b){e==b?l="active":""});$.each(b.peisongActiveArr[f],function(a,b){e==b?l="active":""});h.append('<span class="piece '+l+'">'+e+"</span>")}))}else if("shangpin"==l&&b.result.productServiceTagContentMap){r=s[c];b.editComment||"1"!=r?b.$(".commentListUploadImage").removeClass("hn"):b.$(".commentListUploadImage").addClass("hn");
var n=w(c);n&&n.productMap&&(h.html(""),$.each(n.productMap,function(a,e){var g="";n.productCodes&&b.result.productServiceScore==c&&$.each(n.productCodes,function(b,c){a==c?g="active":""});$.each(b.shangpinActiveArr[f],function(a,b){e==b?g="active":""});h.append('<span class="piece '+g+'" data-type="'+a+'">'+e+"</span>")}))}},v=function(a){var c={};b.editComment&&b.result.deliveryCommentTags&&(c.deliveryCodes=b.result.deliveryCommentTags);c.deliveryMap=b.result.tagContentMap[a];return c},w=function(a){var c=
{};b.editComment&&b.result.productCommentTagCodes&&(c.productCodes=b.result.productCommentTagCodes);c.productMap=b.result.productServiceTagContentMap[a];return c};switch(a.index()){case 1:u(1);t(0);break;case 2:u(2);t(1);break;case 3:u(3);t(2);break;case 4:u(4);t(3);break;case 5:u(5),t(4)}f.addClass("hk");g.addClass("hm");b.editComment&&"0"==b.result.deliveryModifyFlag&&"0"==b.result.productModifyFlag?b.$(".hs").removeClass("ht"):
b.$(".hs").addClass("ht")},starsClick:function(a){a=this.$(a.currentTarget);this.starsPublic(a)},commentMarkClick:function(a){var b=this,c=b.$(a.currentTarget);a=c.siblings(".active");var e=c.html(),f=c.closest(".hj").siblings(".hh"),g=f.find(".fontTitle").data("type"),l=f.find("i.active").length.toString();0<a.length&&$.each(a,function(a,c){var e=$(c).html();"peisong"==g?-1<b.peisongActiveArr[l].indexOf(e)?"":b.peisongActiveArr[l].push(e):
"shangpin"==g&&(-1<b.shangpinActiveArr[l].indexOf(e)?"":b.shangpinActiveArr[l].push(e))});a=function(a){c.hasClass("active")?a?(b.peisongActiveArr[l]&&(a=b.peisongActiveArr[l].indexOf(e),b.peisongActiveArr[l].splice(a,1)),b.result.deliveryCommentTags&&(a=b.result.deliveryCommentTags.indexOf(e),b.result.deliveryCommentTags.splice(a,1))):(b.shangpinActiveArr[l]&&(a=b.shangpinActiveArr[l].indexOf(e),b.shangpinActiveArr[l].splice(a,1)),b.result.productCommentTagCodes&&(a=b.result.productCommentTagCodes.indexOf(e),
b.result.productCommentTagCodes.splice(a,1))):a?b.peisongActiveArr[l].push(e):b.shangpinActiveArr[l].push(e)};"peisong"==g?a(!0):"shangpin"==g&&a(!1);c.toggleClass("active")},timePikerAwake:function(a){var b=this,c=b.result.dates||{},e=b.result.defaultSelectedDate||{},f=b.result.defaultSelectedHour||{};a=b.result.defaultSelectedMinute||{};for(var g=new ctrl.selectmenu({confirmText:"完成",title:"",cancelText:"取消"}),l=[],h=[],n=[],r=function(a,b,c,e){a.push({selected:e,value:b,key:c})},s=0;s<c.length;s++){var t=
c[s].realDate.split("-")[0],u=c[s].realDate.split("-")[1],t=("00"+t).substr(-2),u=("00"+u).substr(-2);yearMouthDay=c[s].year+"-"+t+"-"+u;c[s].realDate==e?r(l,yearMouthDay,c[s].date,!0):r(l,yearMouthDay,c[s].date,!1)}for(c=0;24>c;c++)c==f?r(h,c,c,!0):r(h,c,c,!1);for(f=0;60>f;f++)f=("00"+f).substr(-2),f==a?r(n,f,f,!0):r(n,f,f,!1);setTimeout(function(){$(".ctrlSelectmenuPicker").addClass("hu");$('[data-type="Hour"]').css("position","relative").append('<span class="appendFont">时</span>');
$('[data-type="Minute"]').css("position","relative").append('<span class="appendFont">分</span>')},100);g.viewModel={MMDD:l,Hour:h,Minute:n};g.addEventListener("confirm",function(a){a=this.selectedValue["key-MMDD"];var c=this.selectedValue["key-Hour"],e=this.selectedValue["key-Minute"],f=this.selectedValue["val-MMDD"];b.$(".he").html(a+"&nbsp;&nbsp;"+c+"："+e).attr("data-year",f).attr("data-hour",c).attr("data-minute",e);lg("user_action","1.0",{clickid:"evaluate_time_pick_20161013",order_id:""+
b.result.orderId+""})});g.addEventListener("cancel",function(a){setTimeout(function(){g.remove()},500)});b.$el.append(g.root);g.show()},goodsCommentCheck:function(a){var b=this,c=b.$(".h8").find(".list").length;0<c?c>b.fingerNum?function(){N({title:"还有商品未评价",msg:"确定提交吗？您的评价对商家很重要",button:[{text:"继续评价",callback:function(){}},{text:"确定",callback:function(){b.submitCommentAPI(a)}}]})}():b.submitCommentAPI(a):b.submitCommentAPI(a)},goodsServiceCheck:function(){var a=this,b=function(a){a=
$("[data-type="+a+"]").siblings(".star");var b=[];$.each(a,function(a,c){b.push(!$(this).hasClass("active"))});return _.every(b,_.identity)},c=function(){0<a.$('[data-type="shangpin"]').length&&(b("shangpin")?(a.flagComment=!1,e("还没有评价商品服务","您的评价对商家很重要")):a.flagComment=!0)},e=function(b,c){N({title:b,msg:c,button:[{text:"继续评价",callback:function(){lg("user_action","1.0",{clickid:"evaluate_man_20161013",order_id:""+a.result.orderId+""})}}]})};0<a.$('[data-type="peisong"]').length?b("peisong")?e("还没有评价配送服务",
"您的评价对配送员很重要"):c():c()},badCommentCheck:function(a,b){var c=this,e=c.result.commitTip?c.result.commitTip[b]:"针对您的差评，会对配送员或商家产生相应处罚，确认提交？";this.badShowed=1;N({className:"l",msg:e,button:[{text:"再想想",callback:function(){lg("user_action","1.0",{clickid:"evaluate_bad_cancel",order_id:""+c.result.orderId+"",store_id:""+c.result.storeId+""})}},{text:"提交评价",callback:function(){lg("user_action","1.0",{clickid:"evaluate_bad_submit",order_id:""+c.result.orderId+"",store_id:""+c.result.storeId+
""});c.commentType=1;c.submitCommentAPI(a)}}]})},checkLowThreeStar:function(){var a={peisongLen:0,productLen:0};0<this.$('[data-type="peisong"]').length&&(a.peisongLen=this.$('[data-type="peisong"]').siblings(".active").length);0<this.$('[data-type="shangpin"]').length&&(a.productLen=this.$('[data-type="shangpin"]').siblings(".active").length);return a},submitCommentClick:function(a){var b=this;if(b.$(a.currentTarget).hasClass("ht")){b.goodsServiceCheck();var c=!1,e=!1,f=b.checkLowThreeStar();
if(f.peisongLen&&"9966"!=b.result.carrier&&b.result.modifyDeliverySubmitTip[f.peisongLen])N({title:!1,className:"pingjiaAlertWrap",msg:b.result.modifyDeliverySubmitTip[f.peisongLen],button:[{text:"确定",callback:function(){}}]});else{c=!0;if(f.productLen){if(b.result.modifyProductSubmitTip[f.productLen]){N({title:!1,className:"pingjiaAlertWrap",msg:b.result.modifyProductSubmitTip[f.productLen]||"只可以修改为四星或五星好评哟",button:[{text:"确定",callback:function(){}}]});return}e=!0}b.editComment&&c&&e&&b.submitCommentAPI(a);
c=function(c,e,f){e=b.$("[data-type="+e+"]").siblings(".active").length;c>=e?b.badCommentCheck(a,f):b.goodsCommentCheck(a)};e=function(){var c;c=function(){if(b.result.deliveryStarThreshold){var a=b.$("[data-type=peisong]").siblings(".active").length;return b.result.deliveryStarThreshold>=a?!0:!1}};var e=function(){if(b.result.productStarThreshold){var a=b.$("[data-type=shangpin]").siblings(".active").length;return b.result.productStarThreshold>=a?!0:!1}};c()||e()?(c=c()?0:1,b.badCommentCheck(a,c)):
b.goodsCommentCheck(a)};if(!b.editComment&&b.result.tipPolicy&&!0==b.flagComment)switch(b.result.tipPolicy){case 1:b.result.deliveryStarThreshold&&c(b.result.deliveryStarThreshold,"peisong",0);break;case 2:b.result.productStarThreshold&&c(b.result.productStarThreshold,"shangpin",1);break;case 3:e()}}}},submitCommentAPI:function(a){var b=this,c=$(a.currentTarget);if(!c.hasClass("sending")&&!c.hasClass("disabled")){if(a=b.$('[data-type="peisong"]')){var e=a.siblings(".active").length,f=b.$('[data-value="peisongArea"]').val();
a=a.parent().siblings(".hj");var g=[];$(".piece",a).each(function(){$(this).hasClass("active")&&g.push($(this).html())})}var l=b.$('[data-type="shangpin"]'),h=l.siblings(".active").length;a=b.$('[data-value="shangpinArea"]').val();var s={},l=l.parent().siblings(".hj");$(".piece",l).each(function(){if($(this).hasClass("active")){var a=$(this).data("type");s[a]=$(this).html()}});if(b.$(".he").data("year"))var l=b.$(".he").data("year"),t=b.$(".he").data("hour"),
u=b.$(".he").data("minute"),t=k=("00"+t).substr(-2),l=l+" "+t+":"+u;else l="";var v=[];b.$(".hp .list").each(function(){var a=$(this).data("sku");$(".hr",this).hasClass("haoPingActive")?v.push({skuId:a,vote:!0}):$(".hr",this).hasClass("chaPingActive")&&v.push({skuId:a,vote:!1})});e={orderId:this.result.orderId,deliveryScore:e||"",deliveryCommentContent:f||"",tagContents:g||[],serviceScore:h,productCommentContent:a||"",modifyTime:l||"",skus:v||[],productServiceTags:s||
{},operationType:this.operationType,imgList:b.$(".commentListUploadImage").hasClass("hn")?b.imagesUrls:[]};c.addClass("sending").html("提交中...");window.logData.url_page_par.type=b.editComment?2:1;f=0;this.result.productCommentContent&&b.editComment&&a&&(f=1);lg("user_action","1.0",{clickid:"click_commit",order_id:""+b.result.orderId+"",store_id:""+b.result.storeId+"",badShowed:""+b.badShowed+"",commentType:""+b.commentType+"",type:+f});r(this,{functionId:"order/orderSkuBatchCommentNew",
body:e},"POST").done(function(a){b.editComment?n("评价修改成功"):n("评价成功");L();setTimeout(function(){window.location.reload()},99)}).fail(function(a){n((a||{}).msg||"提交失败");b.editComment?c.removeClass("sending").html("确认修改"):c.removeClass("sending").html("提交评价")})}},returnData:function(){return this.errorMsg}});
View.extend({name:"purchTickets",title:"券购",events:{"click .ge,.go,.storeSearchCart":"addGoods","click .reduce":"cutGoods"},initialize:function(a){var b=this;a=
a.queryParam;b.couponId=a.couponId;b.stationNo=a.stationNo;Xd(b,{couponId:b.couponId,stationNo:b.stationNo}).done(function(a){a=a||{};a.searchResultVOList=[];0<a.productInfoList.length&&$.map(a.productInfoList,function(b,f){b.imgUrl=b.imageList[0];b.skuPrice&&(b.vipPrice=b.skuPrice.vipPrice,b.vipPriceColorCode=b.skuPrice.vipPriceColorCode,b.vipPriceIcon=b.skuPrice.vipPriceIcon,b.realTimePrice=b.skuPrice.realTimePrice,b.basicPrice=b.skuPrice.basicPrice,b.mkPrice=b.skuPrice.mkPrice,b.promotion=b.skuPrice.promotion,
b.newExclusivePrice=b.skuPrice.newExclusivePrice);b.userActionSku='{"venderId":'+a.venderId+',"skuId":'+b.skuId+',"storeId":'+a.stationNo+"}";a.searchResultVOList.push(b)});b.setContentView(h("e0")({includefooter:!0,pagename:"purchTickets",skuDate:"storegoods_search_sku",cartaddDate:"click_add",cartreduceDate:"click_reduce",result:a,purTickets:!0,loading:!0}));b.insertGoShopFragment(a,function(){b.$(".a0x").addClass("a1c")})}).fail(function(a){"network"==a.type?
b.setContentView(h("fs")({msg:a&&a.msg})):201==a.code?X():n(a.msg)})},insertGoShopFragment:function(a,b){var c=this,e=document.createElement("div");this.$el.append(e);c.minicart=new J.minicart({el:e,storeId:a.stationNo,orgCode:a.venderId,showup:!1,storeName:a.stationName,openJPIndustry:a.industry,view:c});c.listenTo(c.minicart,"add",function(a){c._cart_changed_=!0;c.$(".ri li").each(function(b,c){$(c).attr("_goodsid")==a&&Ga($(c).find(".add")[0])})}).listenTo(c.minicart,
"minus",function(a){c._cart_changed_=!0;c.$(".ri li").each(function(b,c){$(c).attr("_goodsid")==a&&ya($(c).find(".reduce")[0])})}).listenTo(c.minicart,"clear",function(){c._cart_changed_=!0;c.$(".Box").each(function(a,b){$(b).find(".reduce").removeClass("show").addClass("hide");$(b).find("label").removeClass("show").addClass("hide").html("0")})})},addGoods:function(a){this.timeTag=(new Date).getTime();ua(a,this.minicart)},cutGoods:function(a){this.timeTag=(new Date).getTime();Sa(a,this.minicart)}});
ViewMethod.define("searchView",{page:1,hasNextPage:!0,isLoading:!1,sortType:"1",sortIndex:0,getGoodList:function(a,b,c,e,f){var g=this;e||(g.startTime=0,g._title="",g.industryTags=[],g._catIds=[],g.promotLabels="",g.discountRange="",g.hasSession=!1,g.cateName="",g.catIdstring="",g.sortType="1",g.sortIndex=0,g.sortNodeType="all",g.$("#sort_2").remove(),g.refreshSearch=!0,g.$("li[nodeType=all]").addClass("active").siblings("li").removeClass("active"),g.$("[storePrice]").attr("_type","4").removeClass("store-sort-price-down store-sort-price-up"),
g.serviceNo=(new Date).getTime());g.page=1;g.hasNextPage=!0;g.isLoading=!1;var l=function(){g.key=a;g.gotoTop();"storeGoodsSearchNew"==g.name&&(g.newStore=!0,setTimeout(function(){history.pushState(null,document.title,location.href+"/newStore:true")},0));"searchByGoods"!=g.name&&"searchByStore"!=g.name||e?(e||g.$(".content").html(h("dx")({loading:!0})),g.pushGoods()):x({hash:"#indexSearchToStore/keyword:"+encodeURIComponent(a)});f||(b&&c?location.replace(location.hash.split("/")[0]+"/keyword:"+
encodeURIComponent(a)+"/storeId:"+b+"/orgCode:"+c):g.indexPlaceHolder&&g.indexSearchWord?e?location.replace(location.hash.split("/")[0]):location.replace(location.hash.split("/")[0]+"/keyword:"+encodeURIComponent(a)+"/indexPlaceHolder:"+encodeURIComponent(g.indexPlaceHolder)+"/indexSearchWord:"+encodeURIComponent(g.indexSearchWord)):e?location.replace(location.hash.split("/")[0]):location.replace(location.hash.split("/")[0]+"/keyword:"+encodeURIComponent(a)));Ma()};b&&c&&"searchByStoreToMore"==g.name&&
!f?w("#storeGoodsSearch/keyword:"+encodeURIComponent(a)+"/storeId:"+b+"/orgCode:"+c):l()},addHistoryPublic:function(){var a=this;setTimeout(function(){a.hasSession||a._title?a.setTitle(a._title):a.cateName?(a.setTitle("分类"),a.$("#store-keyword").val(a.cateName)):(a.setTitle("搜索"),a.$("#store-keyword").val(a.key),a.searchFragment.addHistory(a.key))},0)},more:function(){!this.hasNextPage||this.isLoading||this.$(".wg").hasClass("block")||(this.page++,this.pushGoods(!0))},insertBar:function(a){this.searchFragment=
a=new J.searchBar(a);this.$el.prepend(a.el);this.$(".scrolling").addClass("hasSearch")},initArguments:function(a){null!=a.data&&u.setItem("keysInfo",a.data);var b=ea((a||{}).query||"");a=decodeURIComponent(b.keyword||"");var c=decodeURIComponent(b.indexPlaceHolder||""),e=decodeURIComponent(b.indexSearchWord||""),f=this.catIdstring=b.catIds||"";this.cateName=decodeURIComponent(b.cateName||"");var g=b.industryTags||"",l=b.title||"",h=b.promotLabels||"",n=b.discountRange||"",r=b.sortType||1,s=[],t=b.storeId||
"",v=b.orgCode||"",w=b.newStore||!1,x=b.pagetype||1,z=b.hasGoods||"";if(a||f){if(b=f&&f.split("&"),b.length)for(var f=0,A=b.length;f<A;f++){var p=b[f].split("=");s.push({categoryId:p[0],level:p[1]})}}else if(b.keysInfo)x=b.keysInfo,x=decodeURIComponent(x),x=JSON.parse(x),a=x.keyWords||"",l=x.title||"",s=x.catIds||[],g=x.industryTags||[],h=x.promotLabels||"",n=x.discountRange||"",t=x.storeId||"",v=x.orgCode||"",x=x.pagetype;else if(b=u.getItem("keysInfo"))this.hasSession=!0,a=b.keyWords||"",l=b.title||
"",s=b.catIds||[],g=b.industryTags||[],h=b.promotLabels||"",n=b.discountRange||"",t=b.storeId||"",v=b.orgCode||"",x=b.pagetype;this.key=a;this.indexPlaceHolder=c;this.indexSearchWord=e;this._title=l;this.promotLabels=h;this.discountRange=n;this.industryTags=_.isString(g)?g?g.split(","):[]:g;this._catIds=s;this.startTime=0;this.storeId=t;this.orgCode=v;this.storeIds=[];this.storeIds.push(t);this.sortType=r;this.newStore=w;this.pagetype=x;this.hasGoodsShop=z;a=window.location.href;if(this.hasSession){if(this._catIds.length)for(var C=
[],c=0,e=this._catIds.length;c<e;c++)C.push(this._catIds[c].categoryId+"="+this._catIds[c].level);C=(this.sortType?"/sortType:"+this.sortType:"")+(this.industryTags.length?"/industryTags:"+this.industryTags.join(","):"")+(this.promotLabels?"/promotLabels:"+this.promotLabels:"")+(this.discountRange?"/discountRange:"+this.discountRange:"")+(this.orgCode?"/orgCode:"+this.orgCode:"")+(this.storeId?"/storeId:"+this.storeId:"")+(this._catIds.length?"/catIds:"+C.join("&"):"")+(this._title?"/title:"+encodeURIComponent(this._title):
"")+(this.key?"/keyword:"+encodeURIComponent(this.key):"");fa({link:a+C})}else Ma();this.pushGoods()},gotoTop:function(a){function b(){clearTimeout(h);if(e<f){e++;var a=Math.ceil(Za(e,g,l,f)),h=setTimeout(b,10)}else e=f,clearTimeout(h);c.scrollTop(a)}var c=v,e=0,f=10,g=c.scrollTop(),l=(a?a:0)-g;b()},getCoords:function(){var a=this;return $.Deferred(function(b){a.address?b.resolve(a.address):t.getCurrentUse().done(function(c){a.longitude=c.longitude;a.latitude=c.latitude;a.address=c;b.resolve(c)}).fail(function(){b.reject()})})},
renderFailPage:function(a,b){1<a.page?(n(b.msg||"网络开小差，请稍后再试哦~[0001]"),a.$(".ct").removeClass("cv")):500==b.code?a.$(".content").html(h("fy")({msg:b&&b.msg})):a.$(".content").html(h("fs")({msg:b&&b.msg}));a.hasNextPage=!1},initMiniCart:function(a){var b=this,c=document.createElement("div");b.$el.append(c);b.minicart=new J.minicart({el:c,view:b,storeId:b.storeId,orgCode:b.orgCode,storeName:a,openJPIndusty:b.industryTags,showup:b.hasGoodsShop});
b.listenTo(b.minicart,"add",function(a){b.$(".ri li").each(function(){$(this).attr("_goodsid")==a&&Ga($(this).find(".add")[0])})}).listenTo(b.minicart,"minus",function(a){b.$(".ri li").each(function(){$(this).attr("_goodsid")==a&&ya($(this).find(".reduce")[0])})}).listenTo(b.minicart,"clear",function(){b.$(".Box").each(function(){$(this).find(".reduce").removeClass("show").addClass("hide");$(this).find("label").removeClass("show").addClass("hide").html("0")})})},initView:function(a,
b,c){a.setContentView(h("dx")({loading:!0}));a.options=b;a.timeTag=(new Date).getTime();a.initArguments(b);b={searchResult:!0,inStore:!0,storeId:a.storeId,view:a};if("searchByStoreToMore"==c||"storeGoodsSearch"==c||"storeGoodsSearchNew"==c)b=_.extend(b,{orgCode:a.orgCode});a.insertBar(b);"storeGoodsSearchNew"!=c&&(a.$(".scrolling").before(h("search-sort-tpl")({sortType:a.sortType})),a.$("#sort_1").addClass("sort1_fixed"));"storeGoodsSearchNew"==c?R(a,a.more,"ul.ri li","moreData"):
R(a,a.more,"ul.ri li")},maiDian:function(a){"string"==typeof a&&(a=W(a));try{a.click_id="store_result_from_allsearch_20160714_1",lg("user_action","1.0",a||{})}catch(b){}},addGoods:function(a){ua(a,this.minicart)},cutGoods:function(a){Sa(a,this.minicart)}});
View.extend({borrow:"searchView",name:"searchIndex",title:"搜索",events:{"click .js-hot-search":"searchGoods","click .wc":"clearHistory"},initialize:function(){this.setContentView(h("dx")({loading:!0}));var a=
this.searchFragment=new J.searchBar({searchGlobal:!0,view:this});this.$(".content").html(a.el);this.$(".content").append(h("am")());a.hotWords()},searchGoods:function(a){this.searchFragment.searchGoods(a)},clearHistory:function(){this.searchFragment.clearHistory()},leave:function(){this.searchFragment.clearSearch()},backin:function(){this.searchFragment.getHistory()}});
View.extend({borrow:"searchView",name:"storeGoodsSearchNew",title:"搜索",events:{"click .xb .ri li .Box span.add":"addGoods",
"click .xb .ri li .Box span.reduce":"cutGoods","click .xc":"goStoreAll"},initialize:function(a){this.initView(this,a,"storeGoodsSearchNew");this.hasSession||this.$("#store-keyword").val(this.key);this.initArguments(a);this.backin=!1},from:{shopSettlement:"settleErrorHandler",settlementGoods:"settleErrorHandler"},settleErrorHandler:function(a,b){this.minicart&&this.minicart.settleErrorHandler(a,b)},pushGoods:function(a){var b=this;if(b.isLoading||
!b.hasNextPage)return!1;b.isLoading=!0;a||(b.page=1,b.addHistoryPublic());a={key:b.key,sortType:b.sortType||"",page:b.page,timeTag:b.timeTag,industryTags:b.industryTags,promotLabels:b.promotLabels,discountRange:b.discountRange,catIds:b._catIds||[]};a=b.newStore?_.extend(a,{storeId:b.storeId}):_.extend(a,{storeIds:b.storeIds});(b.newStore?vc:Fd)(b,a).done(function(a){a.showCart&&0==b.startTime&&b.initMiniCart(a.storeName);if(0==b.startTime){var e={result:a,key:b.key,storeid:b.storeId,orgcode:b.orgCode,
skuDate:"storegoods_search_sku",cartaddDate:"click_add",cartreduceDate:"click_reduce",pagetype:b.pagetype},e=h("ax")(e);b.$(".content").html(e);$(window).scrollTop(0);b.startTime=1}else e={List:a.searchResultVOList,skuDate:"storegoods_search_sku",cartaddDate:"click_add",cartreduceDate:"click_reduce",isCart:a.showCart||!0},e=h("aw")(e),b.$(".ri").append(e);b.isLoading=!1;b.page>=a.count/10&&(b.hasNextPage=!1,b.backin||b.$(".ri").after(h("ar")({showmsg:"已经到底啦"})));
b.hasNextPage?b.$(".ct").addClass("cv"):b.$(".ct").removeClass("cv")}).fail(function(a){b.renderFailPage(b,a)})},backin:function(a){this.backin=this.hasNextPage=!0;"shopSettlement"!=a.from&&"settlementGoods"!=a.from&&this.initialize(this.options)},goStoreAll:function(a){var b=$(a.currentTarget);a=b.attr("_storeId");b=b.attr("_orgCode");w("#storeHome/storeId:"+a+"/orgCode:"+b)},returnData:function(){return!1}});
View.extend({borrow:"searchView",
name:"indexSearchToStore",title:"搜索",events:{"click .x4 .singleStore .moreAll":"showMore","click [node-type=index-checkStoreActivity]":"checkIndexStoreActivity","click .xz":"closePoupGift","click [skipByKeys]":"skipWithKeys"},initialize:function(a){this.options=a;this.setContentView(h("dx")({loading:!0}));$(window).scrollTop(0);this.insertBar({searchResult:!0,outStore:!0,view:this});this.serviceNo=(new Date).getTime();this.initArguments(a);this.resizeEvt="orientationchange"in
window?"orientationchange":"resize";R(this,this.more,".wrapRepeat .storeBox","moreData")},eventObj:function(){var a="ontouchstart"in window;return{start:a?"touchstart":"mousedown",move:a?"touchmove":"mousemove",end:a?"touchend touchcancel":"mouseup mouseout"}},bindResize:function(){var a=document.documentElement,b=function(){a.style.fontSize=a.clientWidth/750*100+"px"};$(window).bind(this.resizeEvt,b);b()},unbindResize:function(){$(window).unbind(this.resizeEvt)},getAjaxGift:function(){var a=this,
b=C.getPDJPin(),c=a.key,e=(new Date).getTime();r(a,{functionId:"wordCommandGameService/getRedPacketByWordCommandGame",body:{userPin:b,passWord:c,transId:e}},{type:"POST"}).done(function(b,c){b||(b={});if(b.couponList&&0<b.couponList.length){var e=h("ay")({result:b});a.$(".content").append(e);a.bindResize();$("body").css("overflow-y","hidden")}}).fail(function(a){})},closePoupGift:function(a){this.$(".xp").hide();$("body").css("overflow-y","inherit")},leave:function(){this.unbindResize();
$("body").css("overflow-y","inherit")},apiSearchByStore:function(a){var b=this;a.cls=b.options.queryParam&&"search"==b.options.queryParam.res_type?"below_search_bar":null;r(b,{functionId:"homeSearch/searchByStorePostV_230",body:{longitude:a.longitude,latitude:a.latitude,type:2,key:a.key,industryTags:a.industryTags||[],catIds:a.catIds||[],sortType:a.sortType,page:a.page,pageSize:a.pageSize||10,storeIds:a.storeIds||[],promotLabels:a.promotLabels,discountRange:a.discountRange,serviceNo:a.serviceNo,areaId:a.cityId,
cls:a.cls}},"POST").done(function(c){b.promptWord=c.promptWord||"";if(0==b.startTime){var e=h("av")({result:c,key:b.key,address:a});b.$(".content").html(e);b.getAjaxGift();b.startTime=1}else e=h("at")({storeSkuList:c.storeSkuList}),b.$(".wrapRepeat").append(e);b.isLoading=!1;b.page>=Math.ceil(c.storeCount/5)&&(b.hasNextPage=!1,b.$(".wrapRepeat").after(h("ar")({showmsg:"已经到底啦"})));b.hasNextPage?b.$(".ct").addClass("cv"):
b.$(".ct").removeClass("cv")}).fail(function(a){b.renderFailPage(b,a)})},pushGoods:function(a){var b=this;if(b.isLoading||!b.hasNextPage)return!1;b.isLoading=!0;a||(b.page=1,b.addHistoryPublic());var c={key:b.key==b.indexPlaceHolder?b.indexSearchWord:b.key,sortType:b.sortType,page:b.page,pageSize:5,industryTags:b.industryTags,promotLabels:b.promotLabels,discountRange:b.discountRange,catIds:b._catIds||[],serviceNo:b.serviceNo};b.getCoords().done(function(a){b.apiSearchByStore(_.extend(c,
a))}).fail(function(){b.$(".content").html(h("fy")({msg:"无法获取您的位置信息[0001]"}))})},showMore:function(a){a=$(a.currentTarget);var b=a.find(".moreFont").data("lg"),c=a.find(".slideUpFont").data("lg"),e=a.closest(".storeBox");e.hasClass("hideThreeLi")?(e.removeClass("hideThreeLi"),a.attr("onclick",'lg("user_action","1.0",{"clickid":"'+c+'"})')):(e.addClass("hideThreeLi"),a.attr("onclick",'lg("user_action","1.0",{"clickid":"'+b+'"})'))},checkIndexStoreActivity:function(a){a=this.$(a.currentTarget);
var b=a.prev().children('[node-type="index-storeActivityList"]').children("li");a.find(".a2q").toggleClass("adx");b.each(function(a){1<a&&$(this).toggle()})},returnData:function(){return!1},skipWithKeys:function(a){this.keysInfo=$(a.currentTarget).attr("keySkipData")},onhashchange:function(){this.keysInfo&&this.initialize({data:W(this.keysInfo)})}});
View.extend({name:"cuidan",title:"催单",className:"addBg",initialize:function(a){this.setContentView(h("eg")())}});
View.extend({name:"cancelOrder",title:"取消订单",className:"addBg",initialize:function(a){this.setContentView(h("eh")())}});
View.extend({name:"shouhou",title:"售后",className:"addBg",initialize:function(a){this.setContentView(h("ei")())}});
View.extend({name:"tuikuan",title:"退款",className:"addBg",initialize:function(a){this.setContentView(h("ej")())}});
View.extend({name:"rewrite",title:"修改订单",className:"addBg",initialize:function(a){this.setContentView(h("ek")())}});
View.extend({name:"youhui",
title:"优惠",className:"addBg",initialize:function(a){this.setContentView(h("el")())}});
View.extend({name:"settleaddresslist",title:"订单结算",events:{"click .it":"toNewAddressPage","click .jh,.ji":"selectAddress","click .edit":"toEditAddressPage","click .y5":"refreshAddresslist"},from:{editaddress:"saveAddress",newaddress:"saveAddress"},initialize:function(a){this.options=a;if(!a.data)return L();var b=this.data=a.data||{},c=this;!this.address||this.address.superzone&&
!b.isWaimai||(b.address=this.address);var e=this.address=b.address||{};c.setContentView(h("dx")({loading:!0}));vb({storeId:b.storeId,needCheckDelivery:1}).done(function(a){c.addresslist=a;var g=!1;a.forEach(function(a){if(!a.canDelivery)return g=!0,!1});!c.address||c.address.superzone&&!b.isWaimai||a.forEach(function(a){c.address.id==a.id&&(c.address=a,c.address.superzone=!1)});c.setContentView(h("dx")({insert:"em",addresslist:a,addressId:e.id,needCheckDelivery:1,hasNoDelivery:g}));
setTimeout(function(){c.$(".jg.over li").first().removeClass("h")},200)}).fail(function(a){a=a||{};a=h("fs")({msg:a.msg,btnHref:"javascript:void(0);"});c.setContentView(a)})},toNewAddressPage:function(){if(20<=this.addresslist.length)n("收货地址已到最大数量");else{var a={addr_type:"settle"};this.data.hasAddress&&(a.address=this.data.address);this.data.isWaimai?x({hash:"#newaddress",data:a}):x({hash:"#newaddress/storeId:"+this.data.storeId,data:a})}},toEditAddressPage:function(a){var b=
$(a.currentTarget).attr("addressId"),c={};this.addresslist.forEach(function(a){a.id==b&&(c=a)});a={address:c,addr_type:"settle"};c.canDelivery||(a.superzone=!0);x({hash:"#editaddress/storeId:"+this.data.storeId,data:a})},selectAddress:function(a){a=$(a.currentTarget);var b=a.attr("addressId");if(0<a.parents(".over").length)n("该地址超出配送范围");else{var c={};this.addresslist.forEach(function(a){a.id==b&&(c=a)});this.address=c;L()}},saveAddress:function(a){a&&(this.address=a);this.initialize(this.options)},
refreshAddresslist:function(){this.initialize(this.options)},returnData:function(){return this.address}});
ViewMethod.define("SettlementView",{className:"Settlement",title:"订单结算",isWaimai:!1,events:{"click .account-address-box, .kx, .ks, .kn":"toAddressPage","click [invoiceInfo]":"toInvoiceListPage","click [sub_mit], .m4":"submit","click [freight]":"showFreight","click .kb":"switchPlatPointsFlag","click [platPoints]":"showPlatPoints",
"click .ma":"ktVip","click .freight-marginTop":"freightTipHandle","click .freight-tip-tag":"freightTipHandleTag","click .l5":"selectDeliverType","click .l6":"deliverTimePicker","click .lf,.ll":"switchMoreProductInfo","click .lp":"getCouponInfoList","click .orderMark":"toOrderMark","click .mq":"stockConfigPicker","click .coupon-UNAVAILABLE":"couponNoUseReason","click input[name=buyer_mobile]":"changeBuyerMobile",
"click .lr":"discountCheckHandler","input input[name=buyer_mobile]":"inputBuyerMobile","input input[name=buyer_name]":"inputBuyerName","click .m7":"scrollToVipHandle"},from:{newaddress:"switchAddressBack",settleaddresslist:"switchAddressBack",vip:"vipBack",invoicelist:"invoicelistBack",orderMark:"orderMarkBack",cashier:"cashierBack"},initialize:function(a){var b=this,c=u.getItem("settlementData"),e=u.getItem("currentOrderId");if(a.data||c)c?(b.resetAccount(c),
e?(b.backoutLoading=!0,b.initRender(b.modules,!0),$(window).bind("touchmove",function(a){a.preventDefault()}),b.orderBackout(e),b.$(".unready").removeClass("unready")):b.account(!0)):(a.oldHash&&(b.oldHash=-1<a.oldHash.indexOf("#")?a.oldHash:"#"+a.oldHash),b.resetAccount({}),b.queryParam=a.queryParam||{},b.initData=_.extend(b.initData,a.data),b.loadingRender());else return L();$(window).bind("scroll",function(a){a=$(a.currentTarget).scrollTop();b.scrollTop=a;50<=a?($(".kn").removeClass("kp"),
b.$(".m7").addClass("md"),b.vipHide=!0):$(".kn").addClass("kp")})},resetAccount:function(a){this.initData=a.initData||{orderPayType:"first",fromSource:2,jingBeansNum:0,source:2,channelType:ta?"1":"0"};this.couponCount=a.couponCount||0;this.submitData=a.submitData||{};this.bookInfoData=a.bookInfoData||{};this.vipHide=a.vipHide||!1;this.payTimeData=a.payTimeData||void 0;this.discountData=a.discountData||void 0;this.serviceArtistList=
a.serviceArtistList||void 0;this.artistData=a.artistData||void 0;this.currentAritstInfo=a.currentAritstInfo||void 0;this.validateBookInfo=a.validateBookInfo||!1;this._accountData=a._accountData||{};this.modules=a.modules||[];this._address=a._address||{};this.remark=a.remark||"";this.invoiceInfoData=a.invoiceInfoData||void 0;this.currStockConfig=a.currStockConfig||0;this.backoutLoading=!1;this.voucherListVO=a.voucherListVO||void 0},loadingRender:function(){var a=this;a.setContentView(h("f7")());
a.getUserInfo("render").always(function(b){a.setInitData(b);a.account(!0)});a.sending=!1;a.hasNextPage=!0;a.pageNo=0},initRender:function(a,b){var c=this.payTimeData||{},e=a.deliverTime.data.noPushTime||{};"newSettlement"==this.name&&(e=a.deliverTime.data||{});var f=a.receiptAddress.data||{},g=f.bindPhoneVO||{};(f=f.addressVo)?(this._address.id=f.addressId,this._address.fullAddress=f.addressName,this._address.name=f.name,this._address.mobile=f.phone):(this._address=this._address||{},this._address.superzone=
!0);b||this.bookInfoData.buyerMobile||(this.bookInfoData.initMobile=g.bindNewPhone||"");a.conponInfo?(this.discountData=(g=a.conponInfo.data.voucherCode)?{op:"use",type:"youhuiquan",value:{couponCode:g}}:void 0,this.initData.voucherCode=g||""):a.couponInfo&&(this.discountData=(g=(a.couponInfo.data.vouVO||{}).vourcherCode)?{op:"use",type:"youhuiquan",value:{couponCode:g}}:void 0,this.initData.voucherCode=g||"");b||!e.pushTimeFlag&&void 0!==e.pushTimeFlag||this.payTimeData||(c=this.getDeliveryTimelist(a),
c=this.payTimeData=this.getDefaultTime(c));e=375>=v.width()?3:4;console.log(this.vipHide);c=_.extend({address:this._address,provider:this.provider,showFreightTip:this.showFreightTip,remark:this.remark,invoiceInfoData:this.invoiceInfoData,currStockConfig:this.currStockConfig,stockConfigContent:this.stockConfigContent,couponCount:this.couponCount,discountData:this.discountData,backoutLoading:this.backoutLoading,bookInfoData:this.bookInfoData||{},scrollTop:this.scrollTop||0,voucherListVO:this.voucherListVO,
codeListSuccessFlag:this.codeListSuccessFlag,defaultTime:c||{},maxLength:e,isSpread:this.isSpread,vipHide:this.vipHide},this.queryParam,this.initData,a,this.restaurantInfo,this._accountData);b&&(c.defaultTime=this.payTimeData,c.bookInfoData=this.bookInfoData);"shopSettlement"==this.name?this.setContentView(h("shopSettlement-tpl")(c)):this.setContentView(h("ep")(c));this.showFreightTip=!1},backin:function(a){var b=this,c=b.scrollTop;setTimeout(function(){$(window).scrollTop(c)},200);
if(a&&"newPay"==a.from)return L();$(window).bind("scroll",function(a){a=$(a.currentTarget).scrollTop();b.scrollTop=a;50<=a?($(".kn").removeClass("kp"),b.$(".m7").addClass("md"),b.vipHide=!0):$(".kn").addClass("kp")});setTimeout(function(){window.addressHide?$(".kn").addClass("kp"):$(".kn").removeClass("kp");$(window).scrollTop(b.scrollTop)},
500)},vipBack:function(){var a=this;a.isBack=!0;a.initData.promiseStartTime=void 0;a.initData.promiseEndTime=void 0;a.initData.promiseDate=void 0;a.initData.voucherCode=void 0;a.initData.firstPlaceVoucherCode=void 0;a.initData.deliveryClerkFeeId=void 0;a.initData.orderPayType="first";a.voucherListVO=void 0;a.payTimeData=void 0;a.currentDate=void 0;a.currentTime=void 0;a.couponPos=0;a.pageNo=0;a.couponCount=void 0;a.hasNextPage=!0;window.clearInterval(a._scroll_IntervalId);a.getUserInfo("render").always(function(b){a.account(!0)})},
setInitData:function(a){this.initData.storeId=K(this.initData.storeId);this.initData.addressType=a.id?!1:!0;this.submitData.produceStationNo=this.initData.storeId;this.submitData.deliveryStationNo=this.initData.storeId;this.submitData.stationName=this.storeName=this.initData.storeName||this.queryParam.storeName;this.initData=_.extend(this.initData,{cityCode:a.cityId,longitude:a.longitude,latitude:a.latitude,addressId:a.id})},account:function(a,b){var c=this;c.isBack?c.isBack=!1:c.couponPos=c.$(".ln").scrollLeft();
var e=_.clone(c.initData);"2"==c.initData.deliverType&&(e.deliveryClerkFeeId=void 0);c.getAccountAPI()(c,e).done(function(e){c.render(e,a);b&&"function"==typeof b&&b(c._accountData)}).fail(function(e){c.settlementMsg((e||{}).msg);b&&"function"==typeof b&&b("error");a&&L()}).always(function(){c.$("div[sub_mit]").removeClass("disabled");c.$("div[sub_mit]").removeClass("sending");setTimeout(function(){c.$(".ln").scrollLeft(c.couponPos)},0)})},render:function(a,b){var c=this,e={},f=
[];$.each(a.modules||a.newModules,function(a,b){var c=b.moduleKey;f.push({moduleKey:c,group:b.group});e[c]=b});a.modules=f;c.modules=e;e.platPoints&&e.platPoints.data&&lg("user_action","1.0",{clickid:"havingpoint",havepoint:e.platPoints.data.onOffFlag?1:0});c._accountData=a;var g=(c.modules.receiptAddress.data||{}).addressVo;g?(c._address.id=g.addressId,c._address.fullAddress=g.addressName,c._address.name=g.name,c._address.mobile=g.phone,c._address.superzone=!1):(c._address=c._address||{},c._address.superzone=
!0);g=c.modules.conponInfo||c.modules.couponInfo||{};b&&(c.initData.orderPayType=c.modules.payMethod?c.modules.payMethod.data.payTypeDefault:"4",g.data&&(c.initData.firstPlaceVoucherCode=(g.data.vouVO||{}).firstPlaceVoucherCode,c.voucherListVO=c.voucherListVO||c.modules.couponInfo.data.voucherListVO,c.codeListSuccessFlag=g.data.codeListSuccessFlag,c.defaultCodeSuccessFlag=g.data.defaultCodeSuccessFlag),c.modules.outOfStockConfig&&c.modules.outOfStockConfig.show&&lg("user_action","1.0",{clickid:"settlement_load_flag_20160713_1"}),
c.modules.conponInfo&&c.modules.conponInfo.show&&!c.modules.conponInfo.data.description&&c.modules.conponInfo.data.voucherVO.addItemNoticeOne&&lg("user_action","1.0",{clickid:"coupon_recommend"}));g.data&&(c.initData.firstPlaceVoucherCode=c.initData.firstPlaceVoucherCode||(g.data.vouVO||{}).firstPlaceVoucherCode,c.initData.mostDiscountFlag=c.initData.mostDiscountFlag||g.data.mostDiscountFlag);"shopSettlement"==c.name&&(c.remark=c.$("textarea[name=blessing]").val());c.validateBookInfo=c.modules.bookInfo||
"6"==c.initData.openJPIndustry||"13"==c.initData.openJPIndustry?!0:!1;c.initRender(c.modules);g=g.data||{};g.defaultCodeSuccessFlag||g.codeListSuccessFlag||g.vouVO?(c.codeListSuccessFlag||c.voucherListVO)&&10<=c.voucherListVO.length&&setTimeout(function(){R(c,c.fetchYouhuiquan,".lr",!0,!0)},500):c.fetchSaveCountYouhuiquan(b);setTimeout(function(){var a=c.$(".freight-tip-tag.active").attr("feeId");c.initData.deliveryClerkFeeId&&a&&(c.initData.deliveryClerkFeeId=a);c.$(".unready").removeClass("unready")},
50)},renderReceiptAddress:function(a){var b=this.$(".account-address");a=h("account-receiptAddress-tpl")({receiptAddress:a.receiptAddress||{},address:this._address});b.replaceWith(a)},renderGoodslist:function(a){var b=this.$(".ih");a=h("account-productInfo-tpl")({provider:this.provider,maxLength:360>=v.width()?3:4,productInfo:a.productInfo,totalWeight:this._accountData.totalWeight});b.replaceWith(a)},toAddressPage:function(a){window.addressHide=$(".kn").hasClass("kp");
a=$(a.currentTarget).hasClass("no-address")?!0:!1;var b=this.modules.receiptAddress.data||{},c="2"==b.status?!0:!1,e="2"==b.type?1:0,b="1"==b.type?1:0,f={};a?(f={storeId:this.initData.storeId,addr_type:"settle"},c&&(f.address=this._address),lg("user_action","1.0",{click_id:"settlement_adressnew_click_20160729",delivery_aear_flag:e}),x({hash:"#newaddress/storeId:"+this.initData.storeId,data:f})):(f={storeId:this.initData.storeId,address:this._address,addr_type:"settle",hasAddress:c},lg("user_action",
"1.0",{click_id:"settlement_adresslist_click_20160729",area_show:b}),x({hash:"#settleaddresslist",data:f}))},discountHandle:function(a){this.discountData=a.value?a:this.discountData;if(a&&"notModified"!=a.op){var b=a.op;"youhuiquan"==a.type&&("use"==b?this.accountYouhuiquan(a.value):"cancel"==b&&this.accountYouhuiquan({}))}},fetchSaveCountYouhuiquan:function(a){var b=this,c=b._accountData.unique,e=b.$("[couponCount]");return r(b,{functionId:"voucher/getUsableVoucherCountFive",body:{unique:c}},{cache:!0}).done(function(c,
g){b.couponCount=b.initData.availableVoucherNum=c;0<c?(e.html(c+" 张可用"),a&&!b.discountData&&e.show(),b.$(".rebate.without").hide()):(b.couponCount=0,e.hide(),g.detail?b.$(".rebate.without").hide():b.$(".rebate.without").show())}).fail(function(){e.hide();b.$(".rebate.without").hide()})},accountYouhuiquan:function(a){var b=this;a.couponCode?b.initData.voucherCode=a.couponCode:(b.initData.voucherCode="",b.discountData=void 0);b.initData.jingBeansNum=0;b.getUserInfo("render").always(function(a){b.account(!1,
function(a){"error"==a&&b.resetYouhui()})})},resetYouhui:function(a){this.initData.discountCode="";this.initData.voucherCode="";this.discountData=void 0;a||(0<this.couponCount&&this.$("[couponCount]").show(),this.$("i.rebate").hide())},deliverTimeCheckHandle:function(a){if(a){var b=this;b.payTimeData=a;b.initData.promiseStartTime=a.startTime;b.initData.promiseEndTime=a.endTime;b.initData.promiseDate=a.sendDate;b.getUserInfo("render").always(function(a){b.account()})}},showFreight:function(a){var b=
$(a.currentTarget);a=b.attr("freight");var c=b.attr("freighttitle")||"运费说明",e=b.attr("totalMoney").replace(/(¥|￥)/,""),b=b.attr("childMoneyList");Pa({title:c,desc:a,childMoneyList:JSON.parse(b),totalMoney:e},"v")},getDeliveryTimelist:function(a){return(a.deliverTime.data.promiseServerResp||{}).data},getDefaultTime:function(a){var b=(a||[])[0],c={deliveryTime:"",sendTime:"",onTime:0};b&&b.promiseTimeRespItems&&(a=b.promiseTimeRespItems[0],b=b.promiseDate+" ",c={sendTime:b+a.promiseStartTime+
":00",deliveryTime:b+a.promiseEndTime+":00",onTime:a.dingshida?1:0,expectedDeliveryTime:b+a.promiseEndTime+":00",deliveryTip:a.deliveryTip,expectedDeliveryBeginTime:b+a.promiseStartTime+":00"},0===c.onTime&&a.expectedDeliveryTime&&16<a.expectedDeliveryTime.length&&(c.expectedDeliveryTime=a.expectedDeliveryTime.replace(/\d{2}:\d{2}-/,"")+":00",c.expectedDeliveryBeginTime=a.expectedDeliveryTime.replace(/-\d{2}:\d{2}/,":00")));return c},selectDeliverType:function(a){a=$(a.currentTarget);var b=this;$(window).unbind("touchmove");
a=JSON.parse(a.attr("deliverTypeItem"));b.initData.deliverType!=a.type&&(b.initData.deliverType=a.type,b.initData.promiseStartTime=void 0,b.initData.promiseEndTime=void 0,b.initData.promiseDate=void 0,b.initData.voucherCode=void 0,b.initData.firstPlaceVoucherCode=void 0,b.initData.orderPayType="first",b.voucherListVO=void 0,b.couponPos=0,b.pageNo=0,b.couponCount=void 0,b.hasNextPage=!0,b.currentDate=void 0,b.currentTime=void 0,b.$(".ln").scrollLeft(0),window.clearInterval(b._scroll_IntervalId),
b.$("div[sub_mit]").addClass("sending"),b.getUserInfo("render").always(function(a){b.payTimeData=void 0;b.account(!0)}))},getUserInfo:function(a){var b=this;return $.Deferred(function(c){function e(e){switch(a){case "render":case "account":return c.resolve(e);case "reaccountforsubmit":case "submit":if(b.validateBookInfo){var g=b.$("input[name=buyer_mobile]"),h=g.val();if(!b.bookInfoData.initMobile&&1>g.length&&!b.bookInfoData.buyerMobile||1<=g.length&&!h)return b.settlementMsg("订购人手机号不能为空哦"),c.reject()}return c.resolve(e)}}
b._address&&b._address.longitude?e(b._address):t.getCurrentUse().done(function(a){b._address=_.clone(a)||{};e(b._address)}).fail(function(a){e({})})})},getUserTyped:function(a){a=this.$("em.buyer_mobile");var b,c,e=this.$("textarea[name=blessing]").val().trim(),f=this.$(".account-stock-config>h3").text()||"",g=this.$("p.user-selected").text()||"",h,n;1<=a.length&&(b=a.text().trim(),c=this.$("em.buyer_name").text().trim());this.validateBookInfo&&b?(h=c||"匿名",n=b):this.validateBookInfo&&(h="匿名",n=this.bookInfoData.buyerMobile||
this.bookInfoData.initMobile);this.remark=e;return{Remark:e,ordererName:h,ordererMobile:n,stockOutOption:""+f+g}},submit:function(a,b,c){if(this.backoutFail){var e=u.getItem("currentOrderId");this.submitData.validateOrderId=e}a=a?$(a.currentTarget):$("[sub_mit]");if(a.hasClass("sending")||a.hasClass("disabled"))return!1;this.submitData.validateCode=b?b:void 0;this.getSubmitData(a,c)},getSubmitData:function(a,b){var c=this,e=c._accountData,f=c.getUserTyped(c._accountData);!c.payTimeData&&c.modules.deliverTime.data&&
"mass"!=c.provider?setTimeout(function(){c.deliverTimePicker("firstSelectable")},0):c.getUserInfo("submit").done(function(g){g=g||{};a.addClass("disabled");g={buyerCity:g.cityId||0,buyerCityName:g.city||"",countryId:g.districtCode||0,countryName:g.district||"",poi:g.title||"",addressId:g.id||0,buyerFullName:g.name||g.address||"",buyerFullAddress:g.fullAddress||"",buyerMobile:g.mobile,addressDetail:g.addressDetail,generalAddress:g.generalAddress?1:0,longit:g.longitude||1,dimen:g.latitude||1,coordType:g.coordType||
2,buyerProvince:0,unique:e.unique,signatureKey:e.serverSign||e.signatureKey,key:e.publicKey,orderPayType:K(c.initData.orderPayType)||4,orgCode:c.initData.orgCode,orderPlatform:"H5",terminalType:2,clientVersion:"2.1",jdBeansCount:K(c.initData.jingBeansNum)||void 0,sendTime:c.payTimeData.sendTime||void 0,deliveryTime:c.payTimeData.deliveryTime||void 0,onTime:c.payTimeData.onTime&&"0"!=c.payTimeData.onTime?1:0,expectedDeliveryTime:c.payTimeData.expectedDeliveryTime||void 0,deliveryTip:c.payTimeData.deliveryTip||
void 0,expectedDeliveryBeginTime:c.payTimeData.expectedDeliveryBeginTime,coupon:c.initData.voucherCode||void 0,deliveryClerkFeeId:c.initData.deliveryClerkFeeId,deliveryClerkFeeTipId:c.initData.deliveryClerkFeeTipId,stockOutOption:f.stockOutOption||void 0,orderBuyerRemark:f.Remark||void 0,ordererMobile:f.ordererMobile,ordererName:f.ordererName,deliveryType:c.initData.deliverType||1,fromSource:da?3:2,source:2,platformPoints:c.initData.usePlatPointsFlag?1:0,purchaseVip:c.initData.purchaseVip,purchaseVipTypeId:c.initData.purchaseVipTypeId};
var h=c.invoiceInfoData,n={};h?(n=(c.modules.invoiceInfo||c.modules.invoice).data,n={orderInvoiceOpenMark:1,orderInvoiceType:h.titleType,orderInvoiceTitle:h.titleContent,orderInvoiceContent:n.invoiceStoreRemark,orderInvoiceFormType:n.invoiceEType,orderInvoiceMail:h.userEmail,orderInvoiceDutyNo:h.taxNum,orderInvoiceMoneyDetail:n.invoiceMoneyTip}):n={orderInvoiceOpenMark:2};c.submitData=_.extend(c.submitData,g,n);c.currentAritstInfo&&c.currentAritstInfo.artistId&&(c.submitData.artist={artistId:c.currentAritstInfo.artistId,
artistName:c.currentAritstInfo.artistName,artistPhoto:c.currentAritstInfo.artistIcon});c.submitConfirm(b)})},submitConfirm:function(a){var b=this,c=b.submitData;!c.addressId||b._address.superzone?b.settlementMsg("请选择地址"):b.submitOrderAPI(b,c).done(function(e){try{u.setItem("settlementData",b),u.setItem("currentOrderId",e.orderId),lg("user_action","1.0",{click_name:"to_order",orderid:e.orderId})}catch(f){}a&&a.close();b.orderResultHandler(e,c)}).fail(function(a){Da("tidan_fail","提单失败");a=a||{};50001==
a.code?ia({desc:"<p style='text-align:center;font-weight:bold;'>"+(a.msg||"门店休息中, 暂不接受新订单")+"</p>"}):50002==a.code?(lg("user_action","1.0",{click_name:"verification_get_voice",ref_page_get:"1"}),ia({title:"提示",desc:"当前账号首次在此设备下单",btn:"绑定手机，获取语音验证码",className:"bind-phone",oldHash:b.oldHash})):50003==a.code?(lg("user_action","1.0",{click_name:"verification_get_voice",ref_page_get:"1"}),ia({title:"提示",desc:a.msg,btn:"获取语音验证码",className:"verification",callback:b.verification,context:b})):50046==a.code?
(b.clearOrderData(),x({hash:"#orderlist"})):50047==a.code?(b.settlementMsg(a.msg),b.initData.usePlatPointsFlag=!1,b.getUserInfo("render").always(function(a){b.account()})):b.settlementMsg(a.msg);b.$("div[sub_mit]").removeClass("disabled").removeClass("sending");b.$(".m4").removeClass("disabled").removeClass("sending")})},orderResultHandler:function(a,b){var c=this,e=a.orderId;Rc(e);var f=b.orderPayType||b.orderMain.orderPayType,g=c.$(".in").find("i").text(),l={result:"success",
orderId:e,payType:1==f?"ordercreate":"pay",paymentType:f,sendTime:g,grossAmount:c._accountData.totalMoney,settleType:c._accountData.settleType||0};(function(){b=b||{};Da("start_pay_1",e);if(4==f){Da("start_pay_2",e);var a=c.modules&&c.modules.productInfo&&c.modules.productInfo.data&&c.modules.productInfo.data[0]&&c.modules.productInfo.data[0].name||b.stationName,a={tradeName:a,tradeDescription:a,merchantOrderNum:e,merchantUserId:b.produceStationNo,paySuccessUrl:void 0};Da("start_pay_3",e);ic(c,a).done(function(a,
b,f){Da("pay_succ",e);if(f)z("o2o_m_h5_sid"),a?Mb(a):"mass"==c.provider?w(void 0):Qa(l);else if(f=h("d0")(a),"0"==b.code&&a)c.$el.append(f),$("#payForm").submit();else if("0"==b.code)return Qa(l),!1}).fail(function(a){Da("pay_fail",e);Qa({result:"fail",failtype:"pay"})})}else Da("not_online_pay",e),Qa(l)})()},leave:function(){this.couponPos=this.$(".ln").scrollLeft();window.addressHide=$(".kn").hasClass("kp");/storeHome|goodsDetails|storeGoodsSearchNew/gi.test(location.hash)&&
this.clearOrderData();this.$("input").blur();$(window).unbind("touchmove");$(window).unbind("scroll")},switchAddressBack:function(a){var b=this;b.isBack=!0;a&&(this._address=a,this.setInitData(a),this.account(!1,function(){if("shopSettlement"==b.name){var a=h("account-deliverTime-tpl")({deliverTime:b.modules.deliverTime});b.$(".account-deliverTime").replaceWith(a);b.$(".account-artistInfo").hide()}setTimeout(function(){$(window).scrollTop(b.scrollTop)},0);b.$(".unready").removeClass("unready")}))},
verification:function(a,b){Hb().done(function(c){b.close();Pc({title:"手机验证",desc:"您的手机("+c.mobile+")首次在此设备下单，正在拨打您的手机，请注意以下来电",fromPhone:c.caller,context:a})}).fail(function(b){a.settlementMsg(b.msg)})},orderBackout:function(a){var b=this;b.$el.append(h("f8")());Hd(b,{orderId:a}).done(function(a){b.closeBackoutLoading();b.backoutFail=!1;b.clearOrderData()}).fail(function(c){b.closeBackoutLoading();50046==c.code?(b.clearOrderData(),x({hash:"#orderlist"})):(b.backoutFail=!0,N({title:!1,
msg:'<p style="padding:30px 0 10px 0;">订单刷新失败</p>',button:[{text:"取消"},{text:"重试",callback:function(){this.$(".k3").show();b.orderBackout(a)}}]}))})},closeBackoutLoading:function(){$(window).unbind("touchmove");this.$(".k3").hide();this.backoutLoading=!1},clearOrderData:function(){$(window).unbind("touchmove");u.removeItem("settlementData");u.removeItem("currentOrderId")},vipPurchaseEntrance:function(a){try{this.initData.orderPayType="first","shopSettlement"==this.name&&
(this.remark=this.$("textarea[name=blessing]").val().trim()),u.setItem("settlementData",this)}catch(b){}x({hash:"#vip"})},switchPlatPointsFlag:function(a){var b=this;$(a.currentTarget).toggleClass("checked");b.initData.usePlatPointsFlag=!b.initData.usePlatPointsFlag;lg("user_action","1.0",{clickid:"point_status",type:b.initData.usePlatPointsFlag?"on":"off"});b.getUserInfo("render").always(function(a){b.account()})},showPlatPoints:function(a){a=$(a.currentTarget).attr("platPoints")||"[]";Pa({desc:JSON.parse(a)},
"w")},toInvoiceListPage:function(a){a=(this.modules.invoiceInfo||this.modules.invoice).data;"0"==a.enableInvoice?N({title:"提示",msg:"订单金额为0元，商家无法开具发票。如需开具包装费和运费发票请联系客服解决：4000020020",button:[{text:"我知道了",callback:function(){}}]}):(a.invoiceId=this.invoiceInfoData?this.invoiceInfoData.invoiceId:void 0,lg("user_action","1.0",{click_id:"createinvoice",hasinvoiceheader:a.invoiceId?1:0}),x({hash:"#invoicelist",data:a}))},freightTipHandle:function(a){var b=this,c=$(a.currentTarget);a=c.find(".ka");
c=c.siblings().find("li.active");b.showFreightTip=!0;var e=0;a.hasClass("checked")?this.initData.deliveryClerkFeeId=void 0:(this.initData.deliveryClerkFeeId=c.attr("feeId"),e=1);this.initData.deliveryClerkFeeTipId=c.attr("feeId");lg("user_action","1.0",{clickid:"paydelivertip",status:e});b.getUserInfo("render").always(function(a){b.account(!1)})},freightTipHandleTag:function(a){var b=this;a=$(a.currentTarget);this.initData.deliveryClerkFeeId=a.attr("feeId");lg("user_action","1.0",{clickid:"select_deliver_tip_amt",
money:this.initData.deliveryClerkFeeId/100});b.getUserInfo("render").always(function(a){b.account(!1)})},ktVip:function(a){var b=this;a=$(a.currentTarget);a.hasClass("checked")?(this.initData.checkVipFlag=0,this.initData.purchaseVip=!1,this.initData.purchaseVipTypeId=void 0):(this.initData.checkVipFlag=1,this.initData.purchaseVip=!0,this.initData.purchaseVipTypeId=a.attr("vipid"));lg("user_action","1.0",{clickid:"select_buy_vip",status:this.initData.checkVipFlag});b.getUserInfo("render").always(function(a){b.account(!1)})},
invoicelistBack:function(a){this.isBack=!0;a?(this.invoiceInfoData=a,this.$(".jm").text(a.titleContent)):(this.invoiceInfoData=void 0,this.$(".jm").text("我要开发票"))},settlementMsg:function(a){"newSettlement"==this.name&&lg("user_action","1.0",{click_name:"faile",msg:a});n(a)},cashierBack:function(){this.initialize({})}});
View.extend({name:"settlementGoods",title:"订单结算",borrow:"orderView",events:{"click .it":"confirmOk","click .ii":"toGoodDetail"},
initialize:function(a){if(!a.data)return L();this.data=a.data;this.setContentView(h("eo")(a.data))},confirmOk:function(){u.removeItem("settlementData");u.removeItem("currentOrderId");L("prev",-2)},toGoodDetail:function(a){if(this.data.orderId){var b=this.$(a.currentTarget).attr("sku"),c=this.data.storeId,e=this.data.orgCode;Ad(this,{storeId:c,sku:b}).done(function(a){switch(a){case 0:x({hash:"#goodsDetails/skuId:"+b+"/storeId:"+c+"/orgCode:"+e+""});break;case 1:x({hash:"#goodsDetails/skuId:"+
b+"/storeId:"+c+"/orgCode:"+e+""});break;case 2:this.alertMsg("此商品所在门店已下线，<br/>去其它门店逛逛吧。");break;case 3:this.alertMsg("门店中此商品已不存在，<br/>去其它门店逛逛吧")}}.bind(this)).fail(function(a){n(a.msg)})}}});
View.extend({borrow:"SettlementView",name:"newSettlement",submitOrderAPI:function(a,b){return r(a,{functionId:"order/submit34",body:b},{type:"POST",timeout:6E4})},getAccountAPI:function(){return Gd},getUserTyped:function(a){a=this.$("input[name=buyer_mobile]");var b,c,e,f;1<=a.length&&(b=a.val().trim(),c=this.$("input[name=buyer_name]").val().trim());
this.validateBookInfo&&b?(e=c||"匿名",f=b):this.validateBookInfo&&(e="匿名",f=this.bookInfoData.buyerMobile||this.bookInfoData.initMobile);b="";this.stockConfigContent?b="如遇缺货："+this.stockConfigContent:this.modules.outOfStockConfig&&this.modules.outOfStockConfig.data&&(b="如遇缺货："+this.modules.outOfStockConfig.data[0]);return{Remark:this.remark,ordererName:e,ordererMobile:f,stockOutOption:b}},deliverTimePicker:function(a){var b=this,c=this.modules.deliverTime.data.promiseDateRespItems;console.log(c);if(c){b.currentDate=
b.currentDate||c[0].promiseDateText;b.currentTime=b.currentTime||(c[0].promiseTimeRespItems[0]||{}).promiseTimeText;var e=function(b,e){var f=!0,g=!1;return(b?c.filter(function(a){return a.promiseDateText==b})[0]:c[0]).promiseTimeRespItems.map(function(b){var c=b.statusTip?b.promiseTimeText+"  "+b.statusTip:b.promiseTimeText;"firstSelectable"==a?1==b.status&&f?(g=!0,f=!1):g=!1:g=e==b.promiseTimeText?!0:!1;return{selected:g,key:c,value:b.promiseTimeText}})},f=function(a){return c.map(function(b){return{selected:a==
b.promiseDateText?!0:!1,key:b.promiseDateText,value:b.promiseDateText}})}(b.currentDate),g=e(b.currentDate,b.currentTime),h=new ctrl.selectmenu({confirmText:"完成",title:"",cancelText:"取消"});g.length?h.viewModel={dateList:f,timeList:g}:h.viewModel={dateList:f};h.addEventListener("select",function(a){a=this.selectedValue["val-dateList"];var c=this.selectedValue["val-timeList"];if(a!=b.currentDate||c&&c!=b.currentTime)b.currentDate=a,b.currentTime=c,"dateList"==this.currentColName&&this.linkage("timeList",
e(a))});h.addEventListener("confirm",function(a){a=this.selectedValue["val-dateList"];var e=this.selectedValue["val-timeList"];v.unbind("touchmove");b.parsePayTimeData(c,a,e)});h.addEventListener("cancel",function(a){setTimeout(function(){v.unbind("touchmove");h.remove()},500)});b.$el.append(h.root);h.show();$(window).bind("touchmove",function(a){$(a.target).hasClass("ctrlSelectmenuWrapper")||0<$(a.target).closest(".ctrlSelectmenuWrapper").length||a.preventDefault()});lg("user_action","1.0",{click_name:"select_delivered_time",
trigger_type:"firstSelectable"===a?"to_order_trigger":"user_select",deliverytype:b.modules.deliverType?b.modules.deliverType.data.defaultType:1})}},parsePayTimeData:function(a,b,c){var e=a.filter(function(a){return a.promiseDateText==b})[0];a=(e.promiseTimeRespItems||[]).filter(function(a){return a.promiseTimeText==c})[0]||{};if(2!=a.status){var f=e.promiseDate,g=a.promiseStartTime,h=a.promiseEndTime,e=a.expectedDeliveryTime,n=f&&g?f+" "+g+":00":"",r=f&&h?f+" "+h+":00":"";a={sendDate:f,onTime:a.dingshida?
1:0,startTime:g,endTime:h,sendTime:n,deliveryTime:r,deliveryTip:a.deliveryTip||""};0===a.onTime&&e&&16<e.length?(a.expectedDeliveryTime=e.replace(/\d{2}:\d{2}-/,"")+":00",a.expectedDeliveryBeginTime=e.replace(/-\d{2}:\d{2}/,":00")):(a.expectedDeliveryBeginTime=n,a.expectedDeliveryTime=r);this.deliverTimeCheckHandle(a)}},switchMoreProductInfo:function(a){var b=this.modules.productInfo.data;a=$(a.currentTarget);var c=1,e=this.$(".lf");2<b.length&&(e.toggleClass("more"),
e.hasClass("more")?(c=0,this.isSpread=!0,this.$(".lf").css("maxHeight",70*b.length)):(this.isSpread=!1,this.$(".lf").css("maxHeight",140)),this.$(".ll").toggleClass("up"));a.hasClass("ll")?lg("user_action","1.0",{click_name:"goods_extend",status:c}):lg("user_action","1.0",{click_name:"click_skulist",status:c})},getDeliveryTimelist:function(a){return a.deliverTime.data.promiseDateRespItems||[]},getCouponInfoList:function(a){var b=
this;a&&(b.pageNo=0,b.voucherListVO=void 0,window.clearInterval(b._scroll_IntervalId));a=1;b.codeListSuccessFlag||b.defaultCodeSuccessFlag?b.codeListSuccessFlag||(a=2):a=3;lg("user_action","1.0",{click_name:"see_coupons",type:a,msg:b.$(".coupon-discount").text()});this.fetchYouhuiquan();setTimeout(function(){R(b,b.fetchYouhuiquan,".lr",!0,!0)},500)},fetchYouhuiquan:function(){var a=this;a.voucherListVO&&0==a.pageNo&&(a.pageNo=1);a.hasNextPage?(a.pageNo++,a.sending=!0,Id(a,{unique:a._accountData.unique,
pageNo:a.pageNo,addItemVoucherCode:(a.modules.couponInfo&&a.modules.couponInfo.data.vouVO||{}).addItemVoucherCode,firstPlaceVoucherCode:a.initData.firstPlaceVoucherCode,mostDiscountFlag:a.initData.mostDiscountFlag}).done(function(b){a.voucherListVO=(a.voucherListVO||[]).concat(b);1==a.pageNo&&0>=b.length?(a.$(".lo").hide(),a.codeListSuccessFlag=!0,a.$(".settlement-moneyInfo-coupon").append("<p>暂无优惠券</p>")):(a.sending=!1,a.$(".m0").remove(),a.$(".ln").append(h("f3")({voucherListVO:b,
voucherCode:a.initData.voucherCode,settlement:!0,pageNo:a.pageNo})),a.$(".lp").remove(),10>b.length&&(a.hasNextPage=!1,window.clearInterval(a._scroll_IntervalId),a.$(".m0").text("暂无更多")))}).fail(function(b){a.sending=!1;1==a.pageNo&&a.settlementMsg(b.msg);a.pageNo--})):(setTimeout(function(){a.$(".m0").text("暂无更多")},0),window.clearInterval(a._scroll_IntervalId))},toOrderMark:function(){window.addressHide=$(".kn").hasClass("kp");
lg("user_action","1.0",{click_name:"click_note",type:this.remark?"change":"add"});x({hash:"#orderMark",data:{remark:this.remark}})},orderMarkBack:function(a){this.remark=a;this.isBack=!0;a?(this.$(".mk").text(a),this.$(".ml").show()):(this.$(".mk").text("添加订单备注"),this.$(".ml").hide())},stockConfigPicker:function(){var a=this,b=new ctrl.selectmenu({confirmText:"完成",title:"",cancelText:"取消"}),c=this.modules.outOfStockConfig.data.map(function(b,c){return{selected:c==
a.currStockConfig,key:b,value:c}});b.viewModel={configList:c};b.addEventListener("confirm",function(b){a.currStockConfig=this.selectedValue["val-configList"];a.stockConfigContent=this.selectedValue["key-configList"];a.$(".mr").text(a.stockConfigContent);lg("user_action","1.0",{click_name:"stock_select",type:a.currStockConfig+1});v.unbind("touchmove")});b.addEventListener("cancel",function(a){setTimeout(function(){v.unbind("touchmove");b.remove()},500)});a.$el.append(b.root);b.show();
v.bind("touchmove",function(a){$(a.target).hasClass("ctrlSelectmenuWrapper")||0<$(a.target).closest(".ctrlSelectmenuWrapper").length||a.preventDefault()})},couponNoUseReason:function(a){var b=a.clientX+130>v.width()?v.width()-130:a.clientX;120>b&&(b=120);var c=$(a.currentTarget).attr("unavailableReason");a=v.scrollTop()+a.clientY-15;$(".ly").remove();this.$el.append(h("f5")({top:a,left:b,unavailableReason:c}));v.bind("click touchmove",function(a){$(a.target).hasClass("coupon-UNAVAILABLE")||
$(".ly").remove()})},changeBuyerMobile:function(a){a=$(a.currentTarget);a.val()==this.bookInfoData.initMobile&&a.val("")},discountCheckHandler:function(a){var b="use";a=$(a.currentTarget);if(!a.hasClass("UNAVAILABLE")){this.quan_for_return=void 0;var c;this.$(".lr.ls")[0]==a[0]?(c=0,b="cancel"):c=1;lg("user_action","1.0",{click_id:"get_coupon",staus:c});a=W(a.attr("quandata"));this.discountHandle({type:"youhuiquan",op:b,value:a&&a.couponCode?
a:""})}},inputBuyerMobile:function(a){this.bookInfoData.buyerMobile=$(a.currentTarget).val()},inputBuyerName:function(a){this.bookInfoData.buyerName=$(a.currentTarget).val()},scrollToVipHandle:function(a){this.vipHide=!0;$(window).scrollTop(9999);this.$(".m7").addClass("md")}});
View.extend({name:"shopCartList",title:"购物车",events:{"click [deleteCart]":"deleteCart","click [swipeMask]":"hideSwipe","swipeLeft a[swipeArea]":"swipeLeft","swipeRight div[storeId]":"swipeRight",
"click a[toLoginPage]":"toLoginPage"},initialize:function(a){this.$el.html(h("dx")({loading:!0,pagename:"cartList",includefooter:!0}));var b=this;t.getCurrentUse().done(function(a){b.address=a;C.getLoginStatus(function(e){gd(b,a).done(function(f){b.render(f,a,e)}).fail(function(a){a||(a={});b.$(".content").html(h("fs")({msg:a.msg}))})});hd(b,a).done(function(e,f){e||(e={});e.address=a;b.$el.append(h("fd")(e));var g;b.$el.bind("touchmove",function(a){clearTimeout(g);
"a6o"!=a.target.id&&b.$(".a6o").removeClass("a6p").addClass("a6q")}).bind("touchend",function(a){"a6o"!=a.target.id&&(g=setTimeout(function(){b.$(".a6o").removeClass("a6q").addClass("a6p")},1E3))})}).fail(function(a){})}).fail(function(a){b.$(".content").html(h("ft")({msg:"没有获取到位置"}))});pa()},from:{storeHome:"refresh"},refresh:function(a){a&&a._cart_changed_&&this.initialize()},render:function(a,b,c){a||(a={});this.$(".content").html(h("f9")({result:a,
address:b||this.address,hasLogin:c}));b=!(((a||{}).otherLocationStores||{}).cartResults||[]).length;!(((a||{}).currentLocationStores||{}).cartResults||[]).length&&b&&this.$(".a6j").css({backgroundColor:"#fff"})},swipeLeft:function(a){var b=$(a.currentTarget),c=b.closest("div[storeId]"),e=c.find("[deleteCart]"),f=c.find("[swipeMask]");if("none"==f.css("display"))return e.css({width:0}).animate({width:60},{duration:122,complete:function(){f.show()}}),setTimeout(function(){b.add(c.find("[goodsList]")).animate({left:-60},
{duration:166})},50),a.preventDefault(),!1},swipeRight:function(a){var b=$(a.currentTarget),c=b.find("[deleteCart]"),b=b.find("[swipeMask]");if("none"!=b.css("display"))return this._hideSwipe(c,b),a.preventDefault(),!1},deleteCart:function(a){var b=this,c=$(a.currentTarget),e=c.closest("[storeId][orgCode]"),f=b.address||{};a=f.longitude;var g=f.latitude;nd(b,e.attr("storeId"),e.attr("orgCode"),a,g).done(function(a){C.getLoginStatus(function(c){b.render(a,f,c)})}).fail(function(a){n((a||{}).msg||"删除失败");
a=e.find("[swipeMask]");b._hideSwipe(c,a)})},hideSwipe:function(a){a=$(a.currentTarget);var b=a.closest("[storeId][orgCode]").find("[deleteCart]");this._hideSwipe(b,a)},_hideSwipe:function(a,b){a.animate({width:0},{duration:122,complete:function(){b.hide()}});setTimeout(function(){a.closest("[storeId][orgCode]").find("a[swipeArea],[goodsList]").animate({left:0},{duration:166})},9)},toLoginPage:function(){X(location.href)}});
View.extend({borrow:Q.ColumbusActivity,name:"storeActivityPage",events:{"click .js-store-act-extend":"changeFocus",
"click .reduce":"cutGoods","click .add":"addGoods","click [couponCode]":"activityCoupons"},initialize:function(a){var b=this;a||(a={});var c=a.queryParam,e=c.activityId,f=c.actFrom||"",g=c.storeId,l=c.longitude,c=c.latitude;b.currentPage=1;b.hasNextPage=!0;b.isLoading=!1;b.options=a;b.setContentView(h("dx")({loading:!0}));b.data={activityId:e,currentPage:b.currentPage};fenxiang&&"storeActivityPage"==sharePage?(fenxiang=!1,b.isShare=!0,sa(!1).done(function(a){a.needMatch=1;Fa(a).done(function(a){a=
t.formatAddressData(a);t.saveLocalCurrent(a);b.data=_.extend(b.data,{longitude:a.longitude,latitude:a.latitude,storeId:g,shareFlag:!0});b.getActInfo(b.data)}).fail(function(a){b.data=_.extend(b.data,{storeId:g});b.getActInfo(b.data)})}).fail(function(){b.data=_.extend(b.data,{storeId:g});b.getActInfo(b.data)})):(b.data="store"==f?_.extend(b.data,{storeId:g}):"address"==f?_.extend(b.data,{longitude:l||"",latitude:c||""}):_.extend(b.data,{longitude:l||"",latitude:c||"",storeId:g}),b.getActInfo(b.data));
R(b,b.more,"div[floor]",!0)},getActInfo:function(a){var b=this;if(b.isLoading||!b.hasNextPage)return!1;b.isLoading=!0;r(b,{functionId:"act/storeActPage",body:{longitude:a.longitude||"",latitude:a.latitude||"",activityId:a.activityId,store_id:a.storeId,currentPage:a.currentPage,shareFlag:a.shareFlag||""}}).done(function(a){a||(a={});b.result=a;b.storeInfo=a.storeInfo||{};b.storeId=b.storeInfo.storeId||(b.storeInfo.params||{}).storeId;b.orgCode=b.storeInfo.orgCode||(b.storeInfo.params||{}).orgCode;
b.result=_.extend(b.result,{isCart:!0,hideStoreTitle:!0,skuDate:"store_home_sku",cartaddDate:"click_add",cartreduceDate:"click_reduce",hideLink:!0,activityId:b.data.activityId});if(a.config){b.pageSize=a.config.pageSize||1;b.data.pageSize=b.pageSize;var e=a.config.totalCount||0;b.pages=0<e%b.pageSize?parseInt(e/b.pageSize)+1:e/b.pageSize;a.config.gloabTitle&&b.setTitle(a.config.gloabTitle);b.weixinShareInfo=b.setWXShareText(a.config.shareInfo||{});fa(b.weixinShareInfo)}a.storeInfo&&a.storeInfo.isOverZone&&
1==b.currentPage&&N({className:"l",msg:"您的定位已超出该店配送区域",button:[{text:"<div>知道了</div>",callback:function(){}}]});a.data&&a.data.length?(1==b.currentPage?b.$(".content").html(h("k")({result:a})):b.$(".sk").append(h("c")({result:a})),(a.config.currentPage||0)>=b.pages?(b.hasNextPage=!1,b.$(".ct").removeClass("cu"),b.$(".rf").show()):(b.currentPage++,b.data.currentPage=b.currentPage,
b.$(".ct").addClass("cu"))):1==b.currentPage?b.setContentView(h("fw")({msg:a.msg||"这里没有活动，回首页逛逛吧[0001]",fromDepriceList:!0})):(b.hasNextPage=!1,b.$(".ct").removeClass("cu"),b.$(".rf").show());b.$(".a4q").length||b.insertGoShopFragment()}).fail(function(a){a||(a={});b.hasNextPage=!1;b.$(".ct").removeClass("cu");
b.$(".rf").show();Ma();1==b.currentPage?117==a.code?b.setContentView(h("fs")({msg:a.msg})):b.setContentView(h("fw")({msg:a.msg||"这里没有活动，回首页逛逛吧[0001]",fromDepriceList:!0})):n(a.msg||"网络异常，请稍后再试[0001]")}).always(function(){b.isLoading=!1})},more:function(){this.hasNextPage&&this.getActInfo(this.data)},returnData:function(){return!1},backin:function(){this.backInFun&&this.initialize(this.options)}});
View.extend({name:"storeDetail",events:{"click .a1v":"changeFocus"},
initialize:function(a){var b=this;b.options=a;a=a.queryParam;b.storeId=a.storeId;b.longitude=a.longitude;b.latitude=a.latitude;b.setContentView(h("dx")({loading:!0}));Ua(b,{storeId:b.storeId,skuId:"",activityId:"",promotionType:"",longitude:b.longitude,latitude:b.latitude},null).done(function(a){a||(a={});a.storeInfo||(a.storeInfo={});a.storeInfo.storeDesc=a.storeDesc;a.storeInfo.storeShareUrl=a.storeShareUrl;b.orgCode=a.storeInfo.orgCode;b.setWeixin(a.storeInfo);b.$(".content").html(h("cy")({result:a,
hasLogin:C.hasAuthCookie(),appVersion:appVersion}))}).fail(function(a){b.$(".content").html(h("fs")({msg:a&&a.msg}))})},setWeixin:function(a){a||(a={});var b=a.storeName,c=a.storeDesc,e=a.storeShareUrl;a=a.logoUrl;var f=A("channel")||"",f=window.location.protocol+"//"+window.location.host+"/activity/storeShare/index.html?storeId="+this.storeId+"&orgCode="+this.orgCode+"&channel="+f+"&appVersion="+appVersion;fa({title:b||"好友为你分享一个好店",desc:c||"京东到家，为你而来，足不出户，即刻到家！",link:e||f,imgUrl:a})},
changeFocus:function(a){var b=this,c=$(a.currentTarget),b=this;if(c.hasClass("isSending"))return!1;c.addClass("isSending");var e=b.$(".js-store-follow"),f=Number(e.html());0==c.attr("data-focus")?(a={isFollow:!0,storeId:b.storeId},Ia(b,a).done(function(a){c.attr("data-focus",1).addClass("a1y").attr("clstag","pageclick|keycount|store_focus_20160815_2");f+=1;e.html(f);n("关注成功！")}).fail(function(a){"network"==a.type?n("网络异常，请稍后再试[0001]"):201==a.code?X():n(a.msg)}).always(function(){c.removeClass("isSending")})):
(a={isFollow:!1,storeId:b.storeId},Ia(b,a).done(function(a){c.attr("data-focus",0).removeClass("a1y").attr("clstag","pageclick|keycount|store_focus_20160815_1");f-=1;e.html(f);n("已取消关注")}).fail(function(a){"network"==a.type?n("网络异常，请稍后再试[0001]"):201==a.code?X():n(a.msg)}).always(function(){c.removeClass("isSending")}))}});
View.extend({name:"storeList",title:"门店列表",events:{'click [node-type="index-gotoStore"]':"indexGoStoreHome","click [node-type=index-checkStoreActivity]":"checkIndexStoreActivity","click [node-type=index-checknearbyStore]":"checknearbyStore"},initialize:function(a){this.options=a;var b=ea((a||{}).query||""),c=b.lat,e=b.lng,
f=b.cityId,g=this.storetype=b.storetypeId,l=b.promotionInfoId||"";jumpType=b.jumpType||"";b=this.storeTypeArr=[];b=g.split(",");this.From=a.from;this.promotionInfoId=l;this.latitude=c;this.longitude=e;this.cityId=f;this.jumpType=jumpType;this.setContentView(h("dx")({title:"商家列表",loading:!0}));g&&"undefined"!=g||l?this.fech(this.From,b):(t.getCurrentUse().done(function(a){}).fail(function(a){}),this.$(".content").html(h("fy")({})))},fech:function(a,b){var c=this;c.latitude&&c.longitude&&
c.cityId?c.getStoreList(a,{openJPIndustryName:b,promotionInfoId:c.promotionInfoId,jumpType:c.jumpType,latitude:c.latitude,longitude:c.longitude,cityId:c.cityId}):t.getCurrentUse().done(function(e){e=_.extend({openJPIndustryName:b,promotionInfoId:c.promotionInfoId,jumpType:c.jumpType},e);c.getStoreList(a,e)}).fail(function(){c.$(".content").html(h("fy")({msg:"无法获取您的位置信息[0001]"}))})},getStoreList:function(a,b){var c=this;r(c,{functionId:"store/getStoreList",body:{longitude:b.longitude,latitude:b.latitude,
coordType:2,openJPIndustryName:b.openJPIndustryName,areaCode:b.cityId,limitId:b.promotionInfoId,jumpType:b.jumpType}}).done(function(a){a=(a||{}).data||[];c.result=a;0==a.length?c.$(".content").html(h("fy")({})):(c.$(".content").html(h("bm")({data:a})),c.goodsEnd())}).fail(function(a){"90002"==a.code?c.$(".content").html(h("fy")({msg:a&&a.msg})):c.$(".content").html(h("fs")({msg:a&&a.msg}))})},goodsEnd:function(){var a=window.innerHeight;this.$(".vo").height()>
a?this.$('[node-type="storeListGoodsEnd"]').show():this.$('[node-type="storeListGoodsEnd"]').hide()},backin:function(){1==this.result.length&&"index"==this.options.from&&w("#index")},indexGoStoreHome:function(a){var b=a.target;a=$(a.currentTarget).attr("_href");if(-1!=b.className.indexOf("a2q")||-1!=$(b).parents().indexOf("xa")||-1!=b.className.indexOf("xa"))return!1;$(b).parent().hasClass("adt")&&(a=$(b).parent().attr("_href"));
x({hash:a})},checkIndexStoreActivity:function(a){a=this.$(a.currentTarget);var b=a.prev().children('[node-type="index-storeActivityList"]').children("li");a.find(".a2q").toggleClass("adx");b.each(function(a){1<a&&$(this).toggle()})},checknearbyStore:function(a){a=this.$(a.currentTarget);a.find(".a2q").toggleClass("adx");var b=a.next();a.parent().toggleClass("aed");b.toggleClass("aeh");
a.parents(".dr").toggleClass("aea");b=a.attr("data-storeId");a.parent().hasClass("aed")?a.attr("onclick",'lg("user_action","1.0",{"clickid":"foldStore","storeId":"'+b+'","isFlold":"true"})'):a.attr("onclick",'lg("user_action","1.0",{"clickid":"foldStore","storeId":"'+b+'","isFlold":"false"})')}});
View.extend({name:"refundDetail",title:"退款详情",events:{},initialize:function(a){var b=this;$(document.body).addClass("whiteBg");r(this,{functionId:"order/refundInfo",
body:{orderId:a.queryParam.orderId}}).done(function(a){b.$el.html(h("dt")(a||{}))}).fail(function(a){})},leave:function(){$(document.body).removeClass("whiteBg")}});
View.extend({name:"integral",title:"我的积分",initialize:function(){var a=this;if(C.hasAuthCookie())Cc(a,1).done(function(b){a.setContentView(h("dx")({insert:"br",data:b}));r(void 0,{functionId:"pointTask/getPointTask",body:{}},"POST").done(function(b){b&&a.$(".ac9").before(h("bu")({data:b}))})}).fail(function(b){a.setContentView(h("dx")({insert:"fs",
msg:b&&b.msg,pagename:"integral"}))});else return a.setContentView(h("dx")({insert:"fr",msg:"登录后才能查看哦",includefooter:!0,pagename:"integralList"})),!1}});
View.extend({name:"integralList",title:"全部积分明细",initialize:function(){var a=C.hasAuthCookie();this.index=1;this.lockLoading=!1;if(a)this.setContentView(h("dx")({pagename:"integralList",loading:!0})),this.fetch(),R(this,this.more,"li.acd");else return this.setContentView(h("dx")({insert:"fr",msg:"登录后才能查看哦",
pagename:"integralList"})),!1},more:function(a){this.fetch()},fetch:function(){var a=this;!1===a.hasNextPage||a.lockLoading||(a.lockLoading=!0,Cc(a,a.index).done(function(b){1==a.index&&(a.pages=Math.ceil(K(b.config.totalCount)/K(b.config.pageSize)));"1"==a.index?a.setContentView(h("dx")({insert:"bs",data:b})):a.$(".acc").append(h("bt")({data:b}));a.index>a.pages-1&&(a.hasNextPage=!1,a.$(".acc").append("<li class='acn'>已经到底啦~</li>"));
a.index++}).always(function(){a.lockLoading=!1}))}});
View.extend({name:"user",title:"个人中心",events:{"click .logout":"logout","click .tv,.nickname,.login,.vr,.user-need-login":"userData","click .w3,.vu,.vv":"closePoupQR","click .u7":"addNews","click .user-need-login":"toLoginPage"},from:{couponsList:"afterCouponPage"},initialize:function(){this.setContentView(h("dx")({loading:!0,includefooter:!0,pagename:"mine"}));
this.cookieval=C.hasAuthCookie();this.fetch();this.QrCodeAjax=!0},checkNewMessage:function(a){var b=this;b.$(".vq").find("i").addClass("hideDot");rb(b,a).done(function(a){a&&a.length&&$.each(a,function(a,c){1==c.status&&b.$(".vq").find("i").removeClass("hideDot")})})},afterCouponPage:function(a){a&&this.fetch()},fetch:function(){var a=this;wb(a).done(function(b){(a.paydata=b)||(b={});b.userInfo||(b.userInfo={});b.userInfo.userBaseInfo||(b.userInfo.userBaseInfo={});b.accountInfo||
(b.accountInfo={});var c;c=_.isObject(b)&&b.userInfo.userBaseInfo.nickName?!0:!1;a.hasLogin=c;var e=z("o2o_m_h5_sid"),f=z("deviceid_pdj_jd"),f=_.extend({userName:C.getUserName(),sid:e,deviceId:f,returnUrl:encodeURIComponent(window.location.href)},b.userInfo.userBaseInfo);a.paydata=_.extend({sid:e,deviceId:z("deviceid_pdj_jd"),returnUrl:encodeURIComponent(window.location.href)},b.accountInfo);C.saveCurrentUserInfo(f);a.$(".content").html(h("g6")({data:f,paydata:a.paydata,hasLogin:c}));var g;
if(a.paydata&&a.paydata.infos&&0<a.paydata.infos.length)for(b=0;b<a.paydata.infos[0].length;b++)"6"==a.paydata.infos[0][b].acctype&&(g=!0);a.$(".user-wallet").html(h("ge")({paydata:a.paydata,sid:e,hasLogin:c,isIntegral:g}));pa();a.sliderside(c)}).fail(function(b){a.$(".content").html(h("g6")({data:""}));a.$(".user-wallet").html(h("ge")({paydata:""}));a.sliderside()})},getAndRenderWallet:function(){var a=this;r(a,{functionId:"account/qry/accountinfo",body:{type:2}},"GET").done(function(b){a.paydata=
b;var c=z("o2o_m_h5_sid");a.paydata=_.extend({sid:c,deviceId:z("deviceid_pdj_jd"),returnUrl:encodeURIComponent(window.location.href)},a.paydata);b&&b[0]&&(b[0].sid=c);b=h("ge")({paydata:b&&b[0]?b[0]:{}});a.$(".user-wallet").html(b);pa()}).fail(function(b){202==b.code&&a.logout()})},logout:function(a){C.logout();this.$(".content").html(h("g6")({data:{},paydata:{},hasLogin:!1,kefu:"off"}));$(".o .mine,.o .orderList").removeClass("news");this.sliderside()},poupQRStopClose:function(a){a.stopPropagation()},
closePoupQR:function(a){a=a.srcElement.className;if("vu"==a||"vv"==a||"w3"==a||"qrcode-closeBtn-wrap"==a)this.$(".user-qrcode-switchWrap").hide(),this.$(".user-qrcode-switchWrap").remove(),$("html,body").css({"overflow-y":"visible",height:"auto"})},userData:function(a){if(this.QrCodeAjax){$(a.currentTarget);var b=a.target.tagName.toLowerCase(),c=this;"a"!=b&&(c.QrCodeAjax=!1,C.getLoginStatus(function(a){a?"label"==b?wb(c).done(function(a){a||(a={});
a.userInfo||(a.userInfo={});a.userInfo.userCodeInfo||(a.userInfo.userCodeInfo={});a&&$("html,body").css({"overflow-y":"hidden",height:"100%"});c.$(".content").append(h("g9")({result:a.userInfo.userCodeInfo}));c.$(".user-qrcode-switchWrap").show()}).fail(function(a){}).always(function(){c.QrCodeAjax=!0}):(c.QrCodeAjax=!0,x({hash:"userData",keep:!1})):(c.QrCodeAjax=!0,X())}))}},give:{walletData:function(){return this.paydata}},sliderside:function(a){var b=this,c=z("o2o_m_h5_sid");
this.messageRedDot();t.getCurrentUse().done(function(e){b.address=e;Zd(b,e).done(function(f,g){f||(f={});var l,n,r,s=[];if(f.userModuleList)for(var t=0;t<f.userModuleList.length;t++)f.userModuleList[t].params&&(l=la.getItem(f.userModuleList[t].params.url),n=-1!==(f.userModuleList[t].params.url||"").indexOf("needPin")?!0:!1),r=_.extend(f.userModuleList[t],{newreddot:l||""},{needPin:n},{sid:c}),s.push(r);l=h("g7")({result:f.channelFloorList,address:e});b.$("div.u4").html(l);
setTimeout(function(){b.$("[swipe]").each(function(a,b){Ca(b,0==a?{auto:4E3}:{})})},0);b.$(".q").append(h("g8")({result:s,hasLogin:a}));setInterval(function(){"undefined"!=b.cookieval&&b.cookieval!=C.hasAuthCookie()&&location.reload()},300)}).fail(function(a){b.$(".q").append(h("fv")({msg:a.msg}))})}).fail(function(a){b.$(".q").append(h("fu")({msg:"无法获取地址，请选择收货地址～"}))})},backin:function(){this.messageRedDot();pa()},messageRedDot:function(){this.hasLogin&&
this.checkNewMessage({djPin:C.getPDJPin(),cityId:(t.getLocalCurrent()||{}).cityId})},addNews:function(a){var b=$(a.currentTarget).attr("clickneed");la.setItem(b,!0);$(a.currentTarget).removeClass("news")}});
View.extend({name:"service",title:"服务与反馈",initialize:function(){function a(a){b.setContentView(h("dx")({insert:"gd",kefu:a}));(I||O||tb||mc)&&b.$(".user-new-online-service").show()}var b=this;eb(b).done(function(b){b?a(!0):a(!1)}).fail(function(){a(!1)})}});
View.extend({name:"userData",
title:"我的账户",initialize:function(a){var b=this,c=z("o2o_m_h5_sid"),e=z("deviceid_pdj_jd");b._pin=A("pin");_.isString(b._pin)&&hc(b,b._pin);wb(b).done(function(a){a||(a={});a.userInfo||(a.userInfo={});a.userInfo.userBaseInfo||(a.userInfo.userBaseInfo={});b.setContentView(h("dx")({insert:"gc",hasLogin:!0,data:_.extend(a.userInfo.userBaseInfo,{sid:c,deviceId:e,returnUrl:encodeURIComponent(window.location.href)})}))})}});
View.extend({name:"walletData",title:"我的钱包",events:{"click .wallerWX":"weixinLg"},
initialize:function(a){a||(a={});if(!a.givedata)return L();(a.givedata||{}).hideWX=P;this.data=a.givedata.infos[1];this.setContentView(h("dx")({insert:"gf",hasLogin:!0,data:a.givedata}))},weixinLg:function(){var a;try{for(var b=0;b<this.data.length;b++)console.log(this.data[b]),7==this.data[b].acctype&&(a=this.data[b].value)}catch(c){}lg("user_action","1.0",{clickid:"switch ",page_name:"walletData|my_wallet",status:"未开通"==a?0:1});-1!=window.location.host.indexOf("jd.com")?w("index.html?h5hash=weixinmianmi"):
w("index.php?h5hash=weixinmianmi")}});
View.extend({name:"weixinmianmi",title:"微信免密支付",events:{"click .acl":"openPay"},initialize:function(){var a=this,b=C.hasAuthCookie();a.paySource=I?6:2;if(b)a.setContentView(h("dx")({insert:"gj",hasLogin:!0})),r(a,{functionId:"account/queryContractStatus",body:{paySource:a.paySource,payWay:10}},"POST").done(function(b){1==b?a.$(".acl").removeClass("close"):0==b?a.$(".acl").addClass("close"):(a.$(".acl").addClass("close"),
N({msg:"业务不支持",button:[{text:"关闭",callback:function(){return L()}}]}))}).fail(function(a){N({msg:a.msg,button:[{text:"关闭"}]})}),r(a,{functionId:"account/queryContractDesc",body:{paySource:a.paySource,payWay:10}},"GET").done(function(b){b=b||"提示：<br/>1.微信免密支付是微信退出的免密支付方式，安全便捷。<br/>2.开通后，选择微信支付方式，用户点击确认支付时自动扣款，无需手动输入密码。<br/>3.单笔限额500元，每天限5次支付。";a.$(".acm").html(b.replace(/\r?\n/g,"<br />"))});else return a.setContentView(h("dx")({insert:"fr",msg:"登录后才能查看哦",pagename:"weixinmianmi"})),
!1},openPay:function(a){var b=$(a.currentTarget);$(".aco").show();b.hasClass("close")?r(this,{functionId:"account/applyContract",body:{paySource:this.paySource,payWay:10}},"POST").done(function(a){$(".aco").hide();w(a)}).fail(function(a){$(".aco").hide();n(a&&a.msg)}):r(this,{functionId:"account/closeContract",body:{paySource:this.paySource,payWay:10}},"POST").done(function(b){$(".aco").hide();b?(n("取消免密支付"),$(a.currentTarget).addClass("close")):
n("解约失败，点击重试")}).fail(function(a){$(".aco").hide();n(a&&a.msg)});b=b.hasClass("close")?1:0;lg("user_action","1.0",{clickid:"switch ",page_name:"noPasswdWx",status:b})}});
View.extend({name:"vipAutoRenewDesc",title:"连续包月服务条款",events:{},initialize:function(a){document.title="VIP会员";var b=this;b.setContentView(h("dx")({loading:!0,includefooter:!1,pagename:"vipAutoRenewDesc"}));r({functionId:"vip/getAutoRenewHtml",body:{}},"POST").done(function(a){b.$(".content").html(h("gs")({html:a||
""}))}).fail(function(a){b.$(".content").html(h("gl")({msg:a.msg}))})}});
View.extend({name:"vipFreight",title:"VIP会员购买记录",events:{"click .aao":"show","click .go-index":"goIndex"},initialize:function(a){document.title="VIP会员";var b=this;b.setContentView(h("dx")({loading:!0,includefooter:!1,pagename:"vipFreight"}));fe().done(function(a){b.$(".content").html(h("go")(a||[]));b.$(".aao").eq(0).click()}).fail(function(a){b.$(".content").html(h("gl")({msg:a.msg}))})},
show:function(a){var b=this.$(a.currentTarget).parent("li.aaj");a=b.attr("cardNo");var c=b.find(".aam").eq(0);c.find(".aan").length?b.toggleClass("aaq"):ge({cardNo:a}).done(function(a){c.html(h("gp")(a||[]));b.toggleClass("aaq")}).fail(function(a){c.html('<p class="aaw">'+a.msg+"</p>");b.toggleClass("aaq")})},goIndex:function(){var a=window.location.protocol+"//"+window.location.host+
"/html/index.html";O&&(a='openApp.jddj://communication?body={"to":"home"}');w(a)}});
View.extend({name:"vipPurchaseHistory",title:"VIP会员购买记录",
events:{},initialize:function(a){document.title="VIP会员";var b=this;b.setContentView(h("dx")({loading:!0,includefooter:!1,pagename:"vipPurchaseHistory"}));he(null).done(function(a){b.$(".content").html(h("gn")(a||[]))}).fail(function(a){b.$(".content").html(h("gl")({msg:a.msg}))})}});
View.extend({name:"renewManage",title:"VIP管理续费",events:{"click .show-pop":"showPop","click .close-pop":"closePop","click .cancel-button":"cancelRenew","click .pay-vip-baoyue":"openRenew"},
initialize:function(a){document.title="VIP会员";var b=this;b.setContentView(h("dx")({title:"VIP会员",loading:!0,includefooter:!1,pagename:"renewManage"}));je().done(function(a){2==a.status?(b.$(".content").html(h("gr")({norenewUser:!0,data:a})),b.id=a.vpId):b.$(".content").html(h("gr")({norenewUser:!1,data:a}))}).fail(function(a){b.$(".content").html(h("gl")({msg:a.msg}))});window.djAppDidBecomeActive=function(){b.initialize()}},showPop:function(){$(".aax").length?
$(".aax").show():this.$(".content").append(h("gq")({cancelRenew:!0}))},closePop:function(){this.$(".aax").hide()},cancelRenew:function(){var a=this;ke().done(function(){a.$(".aax").remove();n("取消成功");setTimeout(function(){a.initialize()},1E3)}).fail(function(a){n(a&&a.msg)})},openRenew:function(){var a=this,b=P?29:I?69:O?28:31,c=window.location.protocol+"//"+window.location.host+"/html/index.html#vipPayResult";O&&(c="openapp.jddj://communication/payVipSuccess",
E&&(wa?window.webkit.messageHandlers.MobileNavi.postMessage({method:"isVipSettlement",params:JSON.stringify({isVip:!0}),callBackName:null,callBackId:null}):isVipSettlement(!0)));b={paySource:b,url:c,vpId:a.id,platform:E?"ios":"android"};this.$(".aax").remove();$(".abm").show();$(".pay-vip-baoyue").hasClass("disabled")||($(".pay-vip-baoyue").addClass("disabled"),Dc(b).done(function(b){0==b.status?setTimeout(function(){a.initialize()},4E3):1==b.status?($(".abm").hide(),$(".pay-vip-baoyue").removeClass("disabled"),
a.openXwFree(b.url)):($(".abm").hide(),$(".pay-vip-baoyue").removeClass("disabled"),n("开通失败，请稍后重试哦~"))}).fail(function(a){$(".abm").hide();$(".pay-vip-baoyue").removeClass("disabled");n(a&&a.msg)}))},openXwFree:function(a){if(O)E?wa?window.webkit.messageHandlers.MobileNavi.postMessage({method:"getWXFree",params:JSON.stringify({signUrl:a}),callBackName:null,callBackId:null}):getWXFree(a):window.djJava.getWXFree(a);else if(I)try{E&&Ha?window.webkit.messageHandlers.JDAppUnite.postMessage({method:"signWeixinPay",
params:a}):window.JDAppUnite&&window.JDAppUnite.signWeixinPay(a)}catch(b){}else w(a)},leave:function(){delete window.djAppDidBecomeActive}});
;Manager.trigger('doneload');